/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var ye=9e15,de=1e9,ot="0123456789abcdef",Te="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Re="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ft={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-ye,maxE:ye,crypto:!1},nr,ae,O=!0,De="[DecimalError] ",he=De+"Invalid argument: ",ir=De+"Precision limit exceeded",sr=De+"crypto unavailable",or="[object Decimal]",V=Math.floor,B=Math.pow,Nn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,bn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,An=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,fr=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,te=1e7,P=7,yn=9007199254740991,Cn=Te.length-1,at=Re.length-1,E={toStringTag:or};E.absoluteValue=E.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),L(t)};E.ceil=function(){return L(new this.constructor(this),this.e+1,2)};E.clampedTo=E.clamp=function(t,r){var e,n=this,i=n.constructor;if(t=new i(t),r=new i(r),!t.s||!r.s)return new i(NaN);if(t.gt(r))throw Error(he+r);return e=n.cmp(t),e<0?t:n.cmp(r)>0?r:new i(n)};E.comparedTo=E.cmp=function(t){var r,e,n,i,s=this,l=s.d,a=(t=new s.constructor(t)).d,h=s.s,p=t.s;if(!l||!a)return!h||!p?NaN:h!==p?h:l===a?0:!l^h<0?1:-1;if(!l[0]||!a[0])return l[0]?h:a[0]?-p:0;if(h!==p)return h;if(s.e!==t.e)return s.e>t.e^h<0?1:-1;for(n=l.length,i=a.length,r=0,e=n<i?n:i;r<e;++r)if(l[r]!==a[r])return l[r]>a[r]^h<0?1:-1;return n===i?0:n>i^h<0?1:-1};E.cosine=E.cos=function(){var t,r,e=this,n=e.constructor;return e.d?e.d[0]?(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+P,n.rounding=1,e=xn(n,pr(n,e)),n.precision=t,n.rounding=r,L(ae==2||ae==3?e.neg():e,t,r,!0)):new n(1):new n(NaN)};E.cubeRoot=E.cbrt=function(){var t,r,e,n,i,s,l,a,h,p,g=this,v=g.constructor;if(!g.isFinite()||g.isZero())return new v(g);for(O=!1,s=g.s*B(g.s*g,1/3),!s||Math.abs(s)==1/0?(e=H(g.d),t=g.e,(s=(t-e.length+1)%3)&&(e+=s==1||s==-2?"0":"00"),s=B(e,1/3),t=V((t+1)/3)-(t%3==(t<0?-1:2)),s==1/0?e="5e"+t:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new v(e),n.s=g.s):n=new v(s.toString()),l=(t=v.precision)+3;;)if(a=n,h=a.times(a).times(a),p=h.plus(g),n=R(p.plus(g).times(a),p.plus(h),l+2,1),H(a.d).slice(0,l)===(e=H(n.d)).slice(0,l))if(e=e.slice(l-3,l+1),e=="9999"||!i&&e=="4999"){if(!i&&(L(a,t+1,0),a.times(a).times(a).eq(g))){n=a;break}l+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(L(n,t+1,1),r=!n.times(n).times(n).eq(g));break}return O=!0,L(n,t,v.rounding,r)};E.decimalPlaces=E.dp=function(){var t,r=this.d,e=NaN;if(r){if(t=r.length-1,e=(t-V(this.e/P))*P,t=r[t],t)for(;t%10==0;t/=10)e--;e<0&&(e=0)}return e};E.dividedBy=E.div=function(t){return R(this,new this.constructor(t))};E.dividedToIntegerBy=E.divToInt=function(t){var r=this,e=r.constructor;return L(R(r,new e(t),0,1,1),e.precision,e.rounding)};E.equals=E.eq=function(t){return this.cmp(t)===0};E.floor=function(){return L(new this.constructor(this),this.e+1,3)};E.greaterThan=E.gt=function(t){return this.cmp(t)>0};E.greaterThanOrEqualTo=E.gte=function(t){var r=this.cmp(t);return r==1||r===0};E.hyperbolicCosine=E.cosh=function(){var t,r,e,n,i,s=this,l=s.constructor,a=new l(1);if(!s.isFinite())return new l(s.s?1/0:NaN);if(s.isZero())return a;e=l.precision,n=l.rounding,l.precision=e+Math.max(s.e,s.sd())+4,l.rounding=1,i=s.d.length,i<32?(t=Math.ceil(i/3),r=(1/Ue(4,t)).toString()):(t=16,r="2.3283064365386962890625e-10"),s=Ce(l,1,s.times(r),new l(1),!0);for(var h,p=t,g=new l(8);p--;)h=s.times(s),s=a.minus(h.times(g.minus(h.times(g))));return L(s,l.precision=e,l.rounding=n,!0)};E.hyperbolicSine=E.sinh=function(){var t,r,e,n,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(r=s.precision,e=s.rounding,s.precision=r+Math.max(i.e,i.sd())+4,s.rounding=1,n=i.d.length,n<3)i=Ce(s,2,i,i,!0);else{t=1.4*Math.sqrt(n),t=t>16?16:t|0,i=i.times(1/Ue(5,t)),i=Ce(s,2,i,i,!0);for(var l,a=new s(5),h=new s(16),p=new s(20);t--;)l=i.times(i),i=i.times(a.plus(l.times(h.times(l).plus(p))))}return s.precision=r,s.rounding=e,L(i,r,e,!0)};E.hyperbolicTangent=E.tanh=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+7,n.rounding=1,R(e.sinh(),e.cosh(),n.precision=t,n.rounding=r)):new n(e.s)};E.inverseCosine=E.acos=function(){var t=this,r=t.constructor,e=t.abs().cmp(1),n=r.precision,i=r.rounding;return e!==-1?e===0?t.isNeg()?ie(r,n,i):new r(0):new r(NaN):t.isZero()?ie(r,n+4,i).times(.5):(r.precision=n+6,r.rounding=1,t=new r(1).minus(t).div(t.plus(1)).sqrt().atan(),r.precision=n,r.rounding=i,t.times(2))};E.inverseHyperbolicCosine=E.acosh=function(){var t,r,e=this,n=e.constructor;return e.lte(1)?new n(e.eq(1)?0:NaN):e.isFinite()?(t=n.precision,r=n.rounding,n.precision=t+Math.max(Math.abs(e.e),e.sd())+4,n.rounding=1,O=!1,e=e.times(e).minus(1).sqrt().plus(e),O=!0,n.precision=t,n.rounding=r,e.ln()):new n(e)};E.inverseHyperbolicSine=E.asinh=function(){var t,r,e=this,n=e.constructor;return!e.isFinite()||e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+2*Math.max(Math.abs(e.e),e.sd())+6,n.rounding=1,O=!1,e=e.times(e).plus(1).sqrt().plus(e),O=!0,n.precision=t,n.rounding=r,e.ln())};E.inverseHyperbolicTangent=E.atanh=function(){var t,r,e,n,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=s.precision,r=s.rounding,n=i.sd(),Math.max(n,t)<2*-i.e-1?L(new s(i),t,r,!0):(s.precision=e=n-i.e,i=R(i.plus(1),new s(1).minus(i),e+t,1),s.precision=t+4,s.rounding=1,i=i.ln(),s.precision=t,s.rounding=r,i.times(.5))):new s(NaN)};E.inverseSine=E.asin=function(){var t,r,e,n,i=this,s=i.constructor;return i.isZero()?new s(i):(r=i.abs().cmp(1),e=s.precision,n=s.rounding,r!==-1?r===0?(t=ie(s,e+4,n).times(.5),t.s=i.s,t):new s(NaN):(s.precision=e+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=e,s.rounding=n,i.times(2)))};E.inverseTangent=E.atan=function(){var t,r,e,n,i,s,l,a,h,p=this,g=p.constructor,v=g.precision,w=g.rounding;if(p.isFinite()){if(p.isZero())return new g(p);if(p.abs().eq(1)&&v+4<=at)return l=ie(g,v+4,w).times(.25),l.s=p.s,l}else{if(!p.s)return new g(NaN);if(v+4<=at)return l=ie(g,v+4,w).times(.5),l.s=p.s,l}for(g.precision=a=v+10,g.rounding=1,e=Math.min(28,a/P+2|0),t=e;t;--t)p=p.div(p.times(p).plus(1).sqrt().plus(1));for(O=!1,r=Math.ceil(a/P),n=1,h=p.times(p),l=new g(p),i=p;t!==-1;)if(i=i.times(h),s=l.minus(i.div(n+=2)),i=i.times(h),l=s.plus(i.div(n+=2)),l.d[r]!==void 0)for(t=r;l.d[t]===s.d[t]&&t--;);return e&&(l=l.times(2<<e-1)),O=!0,L(l,g.precision=v,g.rounding=w,!0)};E.isFinite=function(){return!!this.d};E.isInteger=E.isInt=function(){return!!this.d&&V(this.e/P)>this.d.length-2};E.isNaN=function(){return!this.s};E.isNegative=E.isNeg=function(){return this.s<0};E.isPositive=E.isPos=function(){return this.s>0};E.isZero=function(){return!!this.d&&this.d[0]===0};E.lessThan=E.lt=function(t){return this.cmp(t)<0};E.lessThanOrEqualTo=E.lte=function(t){return this.cmp(t)<1};E.logarithm=E.log=function(t){var r,e,n,i,s,l,a,h,p=this,g=p.constructor,v=g.precision,w=g.rounding,b=5;if(t==null)t=new g(10),r=!0;else{if(t=new g(t),e=t.d,t.s<0||!e||!e[0]||t.eq(1))return new g(NaN);r=t.eq(10)}if(e=p.d,p.s<0||!e||!e[0]||p.eq(1))return new g(e&&!e[0]?-1/0:p.s!=1?NaN:e?0:1/0);if(r)if(e.length>1)s=!0;else{for(i=e[0];i%10===0;)i/=10;s=i!==1}if(O=!1,a=v+b,l=pe(p,a),n=r?_e(g,a+10):pe(t,a),h=R(l,n,a,1),Le(h.d,i=v,w))do if(a+=10,l=pe(p,a),n=r?_e(g,a+10):pe(t,a),h=R(l,n,a,1),!s){+H(h.d).slice(i+1,i+15)+1==1e14&&(h=L(h,v+1,0));break}while(Le(h.d,i+=10,w));return O=!0,L(h,v,w)};E.minus=E.sub=function(t){var r,e,n,i,s,l,a,h,p,g,v,w,b=this,M=b.constructor;if(t=new M(t),!b.d||!t.d)return!b.s||!t.s?t=new M(NaN):b.d?t.s=-t.s:t=new M(t.d||b.s!==t.s?b:NaN),t;if(b.s!=t.s)return t.s=-t.s,b.plus(t);if(p=b.d,w=t.d,a=M.precision,h=M.rounding,!p[0]||!w[0]){if(w[0])t.s=-t.s;else if(p[0])t=new M(b);else return new M(h===3?-0:0);return O?L(t,a,h):t}if(e=V(t.e/P),g=V(b.e/P),p=p.slice(),s=g-e,s){for(v=s<0,v?(r=p,s=-s,l=w.length):(r=w,e=g,l=p.length),n=Math.max(Math.ceil(a/P),l)+2,s>n&&(s=n,r.length=1),r.reverse(),n=s;n--;)r.push(0);r.reverse()}else{for(n=p.length,l=w.length,v=n<l,v&&(l=n),n=0;n<l;n++)if(p[n]!=w[n]){v=p[n]<w[n];break}s=0}for(v&&(r=p,p=w,w=r,t.s=-t.s),l=p.length,n=w.length-l;n>0;--n)p[l++]=0;for(n=w.length;n>s;){if(p[--n]<w[n]){for(i=n;i&&p[--i]===0;)p[i]=te-1;--p[i],p[n]+=te}p[n]-=w[n]}for(;p[--l]===0;)p.pop();for(;p[0]===0;p.shift())--e;return p[0]?(t.d=p,t.e=je(p,e),O?L(t,a,h):t):new M(h===3?-0:0)};E.modulo=E.mod=function(t){var r,e=this,n=e.constructor;return t=new n(t),!e.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||e.d&&!e.d[0]?L(new n(e),n.precision,n.rounding):(O=!1,n.modulo==9?(r=R(e,t.abs(),0,3,1),r.s*=t.s):r=R(e,t,0,n.modulo,1),r=r.times(t),O=!0,e.minus(r))};E.naturalExponential=E.exp=function(){return lt(this)};E.naturalLogarithm=E.ln=function(){return pe(this)};E.negated=E.neg=function(){var t=new this.constructor(this);return t.s=-t.s,L(t)};E.plus=E.add=function(t){var r,e,n,i,s,l,a,h,p,g,v=this,w=v.constructor;if(t=new w(t),!v.d||!t.d)return!v.s||!t.s?t=new w(NaN):v.d||(t=new w(t.d||v.s===t.s?v:NaN)),t;if(v.s!=t.s)return t.s=-t.s,v.minus(t);if(p=v.d,g=t.d,a=w.precision,h=w.rounding,!p[0]||!g[0])return g[0]||(t=new w(v)),O?L(t,a,h):t;if(s=V(v.e/P),n=V(t.e/P),p=p.slice(),i=s-n,i){for(i<0?(e=p,i=-i,l=g.length):(e=g,n=s,l=p.length),s=Math.ceil(a/P),l=s>l?s+1:l+1,i>l&&(i=l,e.length=1),e.reverse();i--;)e.push(0);e.reverse()}for(l=p.length,i=g.length,l-i<0&&(i=l,e=g,g=p,p=e),r=0;i;)r=(p[--i]=p[i]+g[i]+r)/te|0,p[i]%=te;for(r&&(p.unshift(r),++n),l=p.length;p[--l]==0;)p.pop();return t.d=p,t.e=je(p,n),O?L(t,a,h):t};E.precision=E.sd=function(t){var r,e=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(he+t);return e.d?(r=ar(e.d),t&&e.e+1>r&&(r=e.e+1)):r=NaN,r};E.round=function(){var t=this,r=t.constructor;return L(new r(t),t.e+1,r.rounding)};E.sine=E.sin=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+P,n.rounding=1,e=Sn(n,pr(n,e)),n.precision=t,n.rounding=r,L(ae>2?e.neg():e,t,r,!0)):new n(NaN)};E.squareRoot=E.sqrt=function(){var t,r,e,n,i,s,l=this,a=l.d,h=l.e,p=l.s,g=l.constructor;if(p!==1||!a||!a[0])return new g(!p||p<0&&(!a||a[0])?NaN:a?l:1/0);for(O=!1,p=Math.sqrt(+l),p==0||p==1/0?(r=H(a),(r.length+h)%2==0&&(r+="0"),p=Math.sqrt(r),h=V((h+1)/2)-(h<0||h%2),p==1/0?r="5e"+h:(r=p.toExponential(),r=r.slice(0,r.indexOf("e")+1)+h),n=new g(r)):n=new g(p.toString()),e=(h=g.precision)+3;;)if(s=n,n=s.plus(R(l,s,e+2,1)).times(.5),H(s.d).slice(0,e)===(r=H(n.d)).slice(0,e))if(r=r.slice(e-3,e+1),r=="9999"||!i&&r=="4999"){if(!i&&(L(s,h+1,0),s.times(s).eq(l))){n=s;break}e+=4,i=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(L(n,h+1,1),t=!n.times(n).eq(l));break}return O=!0,L(n,h,g.rounding,t)};E.tangent=E.tan=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+10,n.rounding=1,e=e.sin(),e.s=1,e=R(e,new n(1).minus(e.times(e)).sqrt(),t+10,0),n.precision=t,n.rounding=r,L(ae==2||ae==4?e.neg():e,t,r,!0)):new n(NaN)};E.times=E.mul=function(t){var r,e,n,i,s,l,a,h,p,g=this,v=g.constructor,w=g.d,b=(t=new v(t)).d;if(t.s*=g.s,!w||!w[0]||!b||!b[0])return new v(!t.s||w&&!w[0]&&!b||b&&!b[0]&&!w?NaN:!w||!b?t.s/0:t.s*0);for(e=V(g.e/P)+V(t.e/P),h=w.length,p=b.length,h<p&&(s=w,w=b,b=s,l=h,h=p,p=l),s=[],l=h+p,n=l;n--;)s.push(0);for(n=p;--n>=0;){for(r=0,i=h+n;i>n;)a=s[i]+b[n]*w[i-n-1]+r,s[i--]=a%te|0,r=a/te|0;s[i]=(s[i]+r)%te|0}for(;!s[--l];)s.pop();return r?++e:s.shift(),t.d=s,t.e=je(s,e),O?L(t,v.precision,v.rounding):t};E.toBinary=function(t,r){return ct(this,2,t,r)};E.toDecimalPlaces=E.toDP=function(t,r){var e=this,n=e.constructor;return e=new n(e),t===void 0?e:(X(t,0,de),r===void 0?r=n.rounding:X(r,0,8),L(e,t+e.e+1,r))};E.toExponential=function(t,r){var e,n=this,i=n.constructor;return t===void 0?e=se(n,!0):(X(t,0,de),r===void 0?r=i.rounding:X(r,0,8),n=L(new i(n),t+1,r),e=se(n,!0,t+1)),n.isNeg()&&!n.isZero()?"-"+e:e};E.toFixed=function(t,r){var e,n,i=this,s=i.constructor;return t===void 0?e=se(i):(X(t,0,de),r===void 0?r=s.rounding:X(r,0,8),n=L(new s(i),t+i.e+1,r),e=se(n,!1,t+n.e+1)),i.isNeg()&&!i.isZero()?"-"+e:e};E.toFraction=function(t){var r,e,n,i,s,l,a,h,p,g,v,w,b=this,M=b.d,S=b.constructor;if(!M)return new S(b);if(p=e=new S(1),n=h=new S(0),r=new S(n),s=r.e=ar(M)-b.e-1,l=s%P,r.d[0]=B(10,l<0?P+l:l),t==null)t=s>0?r:p;else{if(a=new S(t),!a.isInt()||a.lt(p))throw Error(he+a);t=a.gt(r)?s>0?r:p:a}for(O=!1,a=new S(H(M)),g=S.precision,S.precision=s=M.length*P*2;v=R(a,r,0,1,1),i=e.plus(v.times(n)),i.cmp(t)!=1;)e=n,n=i,i=p,p=h.plus(v.times(i)),h=i,i=r,r=a.minus(v.times(i)),a=i;return i=R(t.minus(e),n,0,1,1),h=h.plus(i.times(p)),e=e.plus(i.times(n)),h.s=p.s=b.s,w=R(p,n,s,1).minus(b).abs().cmp(R(h,e,s,1).minus(b).abs())<1?[p,n]:[h,e],S.precision=g,O=!0,w};E.toHexadecimal=E.toHex=function(t,r){return ct(this,16,t,r)};E.toNearest=function(t,r){var e=this,n=e.constructor;if(e=new n(e),t==null){if(!e.d)return e;t=new n(1),r=n.rounding}else{if(t=new n(t),r===void 0?r=n.rounding:X(r,0,8),!e.d)return t.s?e:t;if(!t.d)return t.s&&(t.s=e.s),t}return t.d[0]?(O=!1,e=R(e,t,0,r,1).times(t),O=!0,L(e)):(t.s=e.s,e=t),e};E.toNumber=function(){return+this};E.toOctal=function(t,r){return ct(this,8,t,r)};E.toPower=E.pow=function(t){var r,e,n,i,s,l,a=this,h=a.constructor,p=+(t=new h(t));if(!a.d||!t.d||!a.d[0]||!t.d[0])return new h(B(+a,p));if(a=new h(a),a.eq(1))return a;if(n=h.precision,s=h.rounding,t.eq(1))return L(a,n,s);if(r=V(t.e/P),r>=t.d.length-1&&(e=p<0?-p:p)<=yn)return i=lr(h,a,e,n),t.s<0?new h(1).div(i):L(i,n,s);if(l=a.s,l<0){if(r<t.d.length-1)return new h(NaN);if((t.d[r]&1)==0&&(l=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=l,a}return e=B(+a,p),r=e==0||!isFinite(e)?V(p*(Math.log("0."+H(a.d))/Math.LN10+a.e+1)):new h(e+"").e,r>h.maxE+1||r<h.minE-1?new h(r>0?l/0:0):(O=!1,h.rounding=a.s=1,e=Math.min(12,(r+"").length),i=lt(t.times(pe(a,n+e)),n),i.d&&(i=L(i,n+5,1),Le(i.d,n,s)&&(r=n+10,i=L(lt(t.times(pe(a,r+e)),r),r+5,1),+H(i.d).slice(n+1,n+15)+1==1e14&&(i=L(i,n+1,0)))),i.s=l,O=!0,h.rounding=s,L(i,n,s))};E.toPrecision=function(t,r){var e,n=this,i=n.constructor;return t===void 0?e=se(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(X(t,1,de),r===void 0?r=i.rounding:X(r,0,8),n=L(new i(n),t,r),e=se(n,t<=n.e||n.e<=i.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+e:e};E.toSignificantDigits=E.toSD=function(t,r){var e=this,n=e.constructor;return t===void 0?(t=n.precision,r=n.rounding):(X(t,1,de),r===void 0?r=n.rounding:X(r,0,8)),L(new n(e),t,r)};E.toString=function(){var t=this,r=t.constructor,e=se(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()&&!t.isZero()?"-"+e:e};E.truncated=E.trunc=function(){return L(new this.constructor(this),this.e+1,1)};E.valueOf=E.toJSON=function(){var t=this,r=t.constructor,e=se(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()?"-"+e:e};function H(t){var r,e,n,i=t.length-1,s="",l=t[0];if(i>0){for(s+=l,r=1;r<i;r++)n=t[r]+"",e=P-n.length,e&&(s+=ue(e)),s+=n;l=t[r],n=l+"",e=P-n.length,e&&(s+=ue(e))}else if(l===0)return"0";for(;l%10===0;)l/=10;return s+l}function X(t,r,e){if(t!==~~t||t<r||t>e)throw Error(he+t)}function Le(t,r,e,n){var i,s,l,a;for(s=t[0];s>=10;s/=10)--r;return--r<0?(r+=P,i=0):(i=Math.ceil((r+1)/P),r%=P),s=B(10,P-r),a=t[i]%s|0,n==null?r<3?(r==0?a=a/100|0:r==1&&(a=a/10|0),l=e<4&&a==99999||e>3&&a==49999||a==5e4||a==0):l=(e<4&&a+1==s||e>3&&a+1==s/2)&&(t[i+1]/s/100|0)==B(10,r-2)-1||(a==s/2||a==0)&&(t[i+1]/s/100|0)==0:r<4?(r==0?a=a/1e3|0:r==1?a=a/100|0:r==2&&(a=a/10|0),l=(n||e<4)&&a==9999||!n&&e>3&&a==4999):l=((n||e<4)&&a+1==s||!n&&e>3&&a+1==s/2)&&(t[i+1]/s/1e3|0)==B(10,r-3)-1,l}function qe(t,r,e){for(var n,i=[0],s,l=0,a=t.length;l<a;){for(s=i.length;s--;)i[s]*=r;for(i[0]+=ot.indexOf(t.charAt(l++)),n=0;n<i.length;n++)i[n]>e-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/e|0,i[n]%=e)}return i.reverse()}function xn(t,r){var e,n,i;if(r.isZero())return r;n=r.d.length,n<32?(e=Math.ceil(n/3),i=(1/Ue(4,e)).toString()):(e=16,i="2.3283064365386962890625e-10"),t.precision+=e,r=Ce(t,1,r.times(i),new t(1));for(var s=e;s--;){var l=r.times(r);r=l.times(l).minus(l).times(8).plus(1)}return t.precision-=e,r}var R=(function(){function t(n,i,s){var l,a=0,h=n.length;for(n=n.slice();h--;)l=n[h]*i+a,n[h]=l%s|0,a=l/s|0;return a&&n.unshift(a),n}function r(n,i,s,l){var a,h;if(s!=l)h=s>l?1:-1;else for(a=h=0;a<s;a++)if(n[a]!=i[a]){h=n[a]>i[a]?1:-1;break}return h}function e(n,i,s,l){for(var a=0;s--;)n[s]-=a,a=n[s]<i[s]?1:0,n[s]=a*l+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,l,a,h){var p,g,v,w,b,M,S,D,_,G,q,j,le,Q,re,oe,ne,ce,W,ge,me=n.constructor,xe=n.s==i.s?1:-1,Z=n.d,T=i.d;if(!Z||!Z[0]||!T||!T[0])return new me(!n.s||!i.s||(Z?T&&Z[0]==T[0]:!T)?NaN:Z&&Z[0]==0||!T?xe*0:xe/0);for(h?(b=1,g=n.e-i.e):(h=te,b=P,g=V(n.e/b)-V(i.e/b)),W=T.length,ne=Z.length,_=new me(xe),G=_.d=[],v=0;T[v]==(Z[v]||0);v++);if(T[v]>(Z[v]||0)&&g--,s==null?(Q=s=me.precision,l=me.rounding):a?Q=s+(n.e-i.e)+1:Q=s,Q<0)G.push(1),M=!0;else{if(Q=Q/b+2|0,v=0,W==1){for(w=0,T=T[0],Q++;(v<ne||w)&&Q--;v++)re=w*h+(Z[v]||0),G[v]=re/T|0,w=re%T|0;M=w||v<ne}else{for(w=h/(T[0]+1)|0,w>1&&(T=t(T,w,h),Z=t(Z,w,h),W=T.length,ne=Z.length),oe=W,q=Z.slice(0,W),j=q.length;j<W;)q[j++]=0;ge=T.slice(),ge.unshift(0),ce=T[0],T[1]>=h/2&&++ce;do w=0,p=r(T,q,W,j),p<0?(le=q[0],W!=j&&(le=le*h+(q[1]||0)),w=le/ce|0,w>1?(w>=h&&(w=h-1),S=t(T,w,h),D=S.length,j=q.length,p=r(S,q,D,j),p==1&&(w--,e(S,W<D?ge:T,D,h))):(w==0&&(p=w=1),S=T.slice()),D=S.length,D<j&&S.unshift(0),e(q,S,j,h),p==-1&&(j=q.length,p=r(T,q,W,j),p<1&&(w++,e(q,W<j?ge:T,j,h))),j=q.length):p===0&&(w++,q=[0]),G[v++]=w,p&&q[0]?q[j++]=Z[oe]||0:(q=[Z[oe]],j=1);while((oe++<ne||q[0]!==void 0)&&Q--);M=q[0]!==void 0}G[0]||G.shift()}if(b==1)_.e=g,nr=M;else{for(v=1,w=G[0];w>=10;w/=10)v++;_.e=v+g*b-1,L(_,a?s+_.e+1:s,l,M)}return _}})();function L(t,r,e,n){var i,s,l,a,h,p,g,v,w,b=t.constructor;e:if(r!=null){if(v=t.d,!v)return t;for(i=1,a=v[0];a>=10;a/=10)i++;if(s=r-i,s<0)s+=P,l=r,g=v[w=0],h=g/B(10,i-l-1)%10|0;else if(w=Math.ceil((s+1)/P),a=v.length,w>=a)if(n){for(;a++<=w;)v.push(0);g=h=0,i=1,s%=P,l=s-P+1}else break e;else{for(g=a=v[w],i=1;a>=10;a/=10)i++;s%=P,l=s-P+i,h=l<0?0:g/B(10,i-l-1)%10|0}if(n=n||r<0||v[w+1]!==void 0||(l<0?g:g%B(10,i-l-1)),p=e<4?(h||n)&&(e==0||e==(t.s<0?3:2)):h>5||h==5&&(e==4||n||e==6&&(s>0?l>0?g/B(10,i-l):0:v[w-1])%10&1||e==(t.s<0?8:7)),r<1||!v[0])return v.length=0,p?(r-=t.e+1,v[0]=B(10,(P-r%P)%P),t.e=-r||0):v[0]=t.e=0,t;if(s==0?(v.length=w,a=1,w--):(v.length=w+1,a=B(10,P-s),v[w]=l>0?(g/B(10,i-l)%B(10,l)|0)*a:0),p)for(;;)if(w==0){for(s=1,l=v[0];l>=10;l/=10)s++;for(l=v[0]+=a,a=1;l>=10;l/=10)a++;s!=a&&(t.e++,v[0]==te&&(v[0]=1));break}else{if(v[w]+=a,v[w]!=te)break;v[w--]=0,a=1}for(s=v.length;v[--s]===0;)v.pop()}return O&&(t.e>b.maxE?(t.d=null,t.e=NaN):t.e<b.minE&&(t.e=0,t.d=[0])),t}function se(t,r,e){if(!t.isFinite())return ur(t);var n,i=t.e,s=H(t.d),l=s.length;return r?(e&&(n=e-l)>0?s=s.charAt(0)+"."+s.slice(1)+ue(n):l>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(t.e<0?"e":"e+")+t.e):i<0?(s="0."+ue(-i-1)+s,e&&(n=e-l)>0&&(s+=ue(n))):i>=l?(s+=ue(i+1-l),e&&(n=e-i-1)>0&&(s=s+"."+ue(n))):((n=i+1)<l&&(s=s.slice(0,n)+"."+s.slice(n)),e&&(n=e-l)>0&&(i+1===l&&(s+="."),s+=ue(n))),s}function je(t,r){var e=t[0];for(r*=P;e>=10;e/=10)r++;return r}function _e(t,r,e){if(r>Cn)throw O=!0,e&&(t.precision=e),Error(ir);return L(new t(Te),r,1,!0)}function ie(t,r,e){if(r>at)throw Error(ir);return L(new t(Re),r,e,!0)}function ar(t){var r=t.length-1,e=r*P+1;if(r=t[r],r){for(;r%10==0;r/=10)e--;for(r=t[0];r>=10;r/=10)e++}return e}function ue(t){for(var r="";t--;)r+="0";return r}function lr(t,r,e,n){var i,s=new t(1),l=Math.ceil(n/P+4);for(O=!1;;){if(e%2&&(s=s.times(r),Kt(s.d,l)&&(i=!0)),e=V(e/2),e===0){e=s.d.length-1,i&&s.d[e]===0&&++s.d[e];break}r=r.times(r),Kt(r.d,l)}return O=!0,s}function Jt(t){return t.d[t.d.length-1]&1}function cr(t,r,e){for(var n,i,s=new t(r[0]),l=0;++l<r.length;){if(i=new t(r[l]),!i.s){s=i;break}n=s.cmp(i),(n===e||n===0&&s.s===e)&&(s=i)}return s}function lt(t,r){var e,n,i,s,l,a,h,p=0,g=0,v=0,w=t.constructor,b=w.rounding,M=w.precision;if(!t.d||!t.d[0]||t.e>17)return new w(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(r==null?(O=!1,h=M):h=r,a=new w(.03125);t.e>-2;)t=t.times(a),v+=5;for(n=Math.log(B(2,v))/Math.LN10*2+5|0,h+=n,e=s=l=new w(1),w.precision=h;;){if(s=L(s.times(t),h,1),e=e.times(++g),a=l.plus(R(s,e,h,1)),H(a.d).slice(0,h)===H(l.d).slice(0,h)){for(i=v;i--;)l=L(l.times(l),h,1);if(r==null)if(p<3&&Le(l.d,h-n,b,p))w.precision=h+=10,e=s=a=new w(1),g=0,p++;else return L(l,w.precision=M,b,O=!0);else return w.precision=M,l}l=a}}function pe(t,r){var e,n,i,s,l,a,h,p,g,v,w,b=1,M=10,S=t,D=S.d,_=S.constructor,G=_.rounding,q=_.precision;if(S.s<0||!D||!D[0]||!S.e&&D[0]==1&&D.length==1)return new _(D&&!D[0]?-1/0:S.s!=1?NaN:D?0:S);if(r==null?(O=!1,g=q):g=r,_.precision=g+=M,e=H(D),n=e.charAt(0),Math.abs(s=S.e)<15e14){for(;n<7&&n!=1||n==1&&e.charAt(1)>3;)S=S.times(t),e=H(S.d),n=e.charAt(0),b++;s=S.e,n>1?(S=new _("0."+e),s++):S=new _(n+"."+e.slice(1))}else return p=_e(_,g+2,q).times(s+""),S=pe(new _(n+"."+e.slice(1)),g-M).plus(p),_.precision=q,r==null?L(S,q,G,O=!0):S;for(v=S,h=l=S=R(S.minus(1),S.plus(1),g,1),w=L(S.times(S),g,1),i=3;;){if(l=L(l.times(w),g,1),p=h.plus(R(l,new _(i),g,1)),H(p.d).slice(0,g)===H(h.d).slice(0,g))if(h=h.times(2),s!==0&&(h=h.plus(_e(_,g+2,q).times(s+""))),h=R(h,new _(b),g,1),r==null)if(Le(h.d,g-M,G,a))_.precision=g+=M,p=l=S=R(v.minus(1),v.plus(1),g,1),w=L(S.times(S),g,1),i=a=1;else return L(h,_.precision=q,G,O=!0);else return _.precision=q,h;h=p,i+=2}}function ur(t){return String(t.s*t.s/0)}function Ie(t,r){var e,n,i;for((e=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(e<0&&(e=n),e+=+r.slice(n+1),r=r.substring(0,n)):e<0&&(e=r.length),n=0;r.charCodeAt(n)===48;n++);for(i=r.length;r.charCodeAt(i-1)===48;--i);if(r=r.slice(n,i),r){if(i-=n,t.e=e=e-n-1,t.d=[],n=(e+1)%P,e<0&&(n+=P),n<i){for(n&&t.d.push(+r.slice(0,n)),i-=P;n<i;)t.d.push(+r.slice(n,n+=P));r=r.slice(n),n=P-r.length}else n-=i;for(;n--;)r+="0";t.d.push(+r),O&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function Mn(t,r){var e,n,i,s,l,a,h,p,g;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),fr.test(r))return Ie(t,r)}else if(r==="Infinity"||r==="NaN")return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(bn.test(r))e=16,r=r.toLowerCase();else if(Nn.test(r))e=2;else if(An.test(r))e=8;else throw Error(he+r);for(s=r.search(/p/i),s>0?(h=+r.slice(s+1),r=r.substring(2,s)):r=r.slice(2),s=r.indexOf("."),l=s>=0,n=t.constructor,l&&(r=r.replace(".",""),a=r.length,s=a-s,i=lr(n,new n(e),s,s*2)),p=qe(r,e,te),g=p.length-1,s=g;p[s]===0;--s)p.pop();return s<0?new n(t.s*0):(t.e=je(p,g),t.d=p,O=!1,l&&(t=R(t,i,a*4)),h&&(t=t.times(Math.abs(h)<54?B(2,h):k.pow(2,h))),O=!0,t)}function Sn(t,r){var e,n=r.d.length;if(n<3)return r.isZero()?r:Ce(t,2,r,r);e=1.4*Math.sqrt(n),e=e>16?16:e|0,r=r.times(1/Ue(5,e)),r=Ce(t,2,r,r);for(var i,s=new t(5),l=new t(16),a=new t(20);e--;)i=r.times(r),r=r.times(s.plus(i.times(l.times(i).minus(a))));return r}function Ce(t,r,e,n,i){var s,l,a,h,p=t.precision,g=Math.ceil(p/P);for(O=!1,h=e.times(e),a=new t(n);;){if(l=R(a.times(h),new t(r++*r++),p,1),a=i?n.plus(l):n.minus(l),n=R(l.times(h),new t(r++*r++),p,1),l=a.plus(n),l.d[g]!==void 0){for(s=g;l.d[s]===a.d[s]&&s--;);if(s==-1)break}s=a,a=n,n=l,l=s}return O=!0,l.d.length=g+1,l}function Ue(t,r){for(var e=t;--r;)e*=t;return e}function pr(t,r){var e,n=r.s<0,i=ie(t,t.precision,1),s=i.times(.5);if(r=r.abs(),r.lte(s))return ae=n?4:1,r;if(e=r.divToInt(i),e.isZero())ae=n?3:2;else{if(r=r.minus(e.times(i)),r.lte(s))return ae=Jt(e)?n?2:3:n?4:1,r;ae=Jt(e)?n?1:4:n?3:2}return r.minus(i).abs()}function ct(t,r,e,n){var i,s,l,a,h,p,g,v,w,b=t.constructor,M=e!==void 0;if(M?(X(e,1,de),n===void 0?n=b.rounding:X(n,0,8)):(e=b.precision,n=b.rounding),!t.isFinite())g=ur(t);else{for(g=se(t),l=g.indexOf("."),M?(i=2,r==16?e=e*4-3:r==8&&(e=e*3-2)):i=r,l>=0&&(g=g.replace(".",""),w=new b(1),w.e=g.length-l,w.d=qe(se(w),10,i),w.e=w.d.length),v=qe(g,10,i),s=h=v.length;v[--h]==0;)v.pop();if(!v[0])g=M?"0p+0":"0";else{if(l<0?s--:(t=new b(t),t.d=v,t.e=s,t=R(t,w,e,n,0,i),v=t.d,s=t.e,p=nr),l=v[e],a=i/2,p=p||v[e+1]!==void 0,p=n<4?(l!==void 0||p)&&(n===0||n===(t.s<0?3:2)):l>a||l===a&&(n===4||p||n===6&&v[e-1]&1||n===(t.s<0?8:7)),v.length=e,p)for(;++v[--e]>i-1;)v[e]=0,e||(++s,v.unshift(1));for(h=v.length;!v[h-1];--h);for(l=0,g="";l<h;l++)g+=ot.charAt(v[l]);if(M){if(h>1)if(r==16||r==8){for(l=r==16?4:3,--h;h%l;h++)g+="0";for(v=qe(g,i,r),h=v.length;!v[h-1];--h);for(l=1,g="1.";l<h;l++)g+=ot.charAt(v[l])}else g=g.charAt(0)+"."+g.slice(1);g=g+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)g="0"+g;g="0."+g}else if(++s>h)for(s-=h;s--;)g+="0";else s<h&&(g=g.slice(0,s)+"."+g.slice(s))}g=(r==16?"0x":r==2?"0b":r==8?"0o":"")+g}return t.s<0?"-"+g:g}function Kt(t,r){if(t.length>r)return t.length=r,!0}function Ln(t){return new this(t).abs()}function Pn(t){return new this(t).acos()}function On(t){return new this(t).acosh()}function kn(t,r){return new this(t).plus(r)}function Fn(t){return new this(t).asin()}function qn(t){return new this(t).asinh()}function In(t){return new this(t).atan()}function Tn(t){return new this(t).atanh()}function Rn(t,r){t=new this(t),r=new this(r);var e,n=this.precision,i=this.rounding,s=n+4;return!t.s||!r.s?e=new this(NaN):!t.d&&!r.d?(e=ie(this,s,1).times(r.s>0?.25:.75),e.s=t.s):!r.d||t.isZero()?(e=r.s<0?ie(this,n,i):new this(0),e.s=t.s):!t.d||r.isZero()?(e=ie(this,s,1).times(.5),e.s=t.s):r.s<0?(this.precision=s,this.rounding=1,e=this.atan(R(t,r,s,1)),r=ie(this,s,1),this.precision=n,this.rounding=i,e=t.s<0?e.minus(r):e.plus(r)):e=this.atan(R(t,r,s,1)),e}function _n(t){return new this(t).cbrt()}function Dn(t){return L(t=new this(t),t.e+1,2)}function jn(t,r,e){return new this(t).clamp(r,e)}function Un(t){if(!t||typeof t!="object")throw Error(De+"Object expected");var r,e,n,i=t.defaults===!0,s=["precision",1,de,"rounding",0,8,"toExpNeg",-ye,0,"toExpPos",0,ye,"maxE",0,ye,"minE",-ye,0,"modulo",0,9];for(r=0;r<s.length;r+=3)if(e=s[r],i&&(this[e]=ft[e]),(n=t[e])!==void 0)if(V(n)===n&&n>=s[r+1]&&n<=s[r+2])this[e]=n;else throw Error(he+e+": "+n);if(e="crypto",i&&(this[e]=ft[e]),(n=t[e])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(sr);else this[e]=!1;else throw Error(he+e+": "+n);return this}function Bn(t){return new this(t).cos()}function Zn(t){return new this(t).cosh()}function hr(t){var r,e,n;function i(s){var l,a,h,p=this;if(!(p instanceof i))return new i(s);if(p.constructor=i,zt(s)){p.s=s.s,O?!s.d||s.e>i.maxE?(p.e=NaN,p.d=null):s.e<i.minE?(p.e=0,p.d=[0]):(p.e=s.e,p.d=s.d.slice()):(p.e=s.e,p.d=s.d?s.d.slice():s.d);return}if(h=typeof s,h==="number"){if(s===0){p.s=1/s<0?-1:1,p.e=0,p.d=[0];return}if(s<0?(s=-s,p.s=-1):p.s=1,s===~~s&&s<1e7){for(l=0,a=s;a>=10;a/=10)l++;O?l>i.maxE?(p.e=NaN,p.d=null):l<i.minE?(p.e=0,p.d=[0]):(p.e=l,p.d=[s]):(p.e=l,p.d=[s]);return}if(s*0!==0){s||(p.s=NaN),p.e=NaN,p.d=null;return}return Ie(p,s.toString())}if(h==="string")return(a=s.charCodeAt(0))===45?(s=s.slice(1),p.s=-1):(a===43&&(s=s.slice(1)),p.s=1),fr.test(s)?Ie(p,s):Mn(p,s);if(h==="bigint")return s<0?(s=-s,p.s=-1):p.s=1,Ie(p,s.toString());throw Error(he+s)}if(i.prototype=E,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Un,i.clone=hr,i.isDecimal=zt,i.abs=Ln,i.acos=Pn,i.acosh=On,i.add=kn,i.asin=Fn,i.asinh=qn,i.atan=In,i.atanh=Tn,i.atan2=Rn,i.cbrt=_n,i.ceil=Dn,i.clamp=jn,i.cos=Bn,i.cosh=Zn,i.div=Hn,i.exp=Vn,i.floor=Gn,i.hypot=Wn,i.ln=Xn,i.log=Qn,i.log10=Kn,i.log2=Jn,i.max=zn,i.min=Yn,i.mod=ei,i.mul=ti,i.pow=ri,i.random=ni,i.round=ii,i.sign=si,i.sin=oi,i.sinh=fi,i.sqrt=ai,i.sub=li,i.sum=ci,i.tan=ui,i.tanh=pi,i.trunc=hi,t===void 0&&(t={}),t&&t.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)t.hasOwnProperty(e=n[r++])||(t[e]=this[e]);return i.config(t),i}function Hn(t,r){return new this(t).div(r)}function Vn(t){return new this(t).exp()}function Gn(t){return L(t=new this(t),t.e+1,3)}function Wn(){var t,r,e=new this(0);for(O=!1,t=0;t<arguments.length;)if(r=new this(arguments[t++]),r.d)e.d&&(e=e.plus(r.times(r)));else{if(r.s)return O=!0,new this(1/0);e=r}return O=!0,e.sqrt()}function zt(t){return t instanceof k||t&&t.toStringTag===or||!1}function Xn(t){return new this(t).ln()}function Qn(t,r){return new this(t).log(r)}function Jn(t){return new this(t).log(2)}function Kn(t){return new this(t).log(10)}function zn(){return cr(this,arguments,-1)}function Yn(){return cr(this,arguments,1)}function ei(t,r){return new this(t).mod(r)}function ti(t,r){return new this(t).mul(r)}function ri(t,r){return new this(t).pow(r)}function ni(t){var r,e,n,i,s=0,l=new this(1),a=[];if(t===void 0?t=this.precision:X(t,1,de),n=Math.ceil(t/P),this.crypto)if(crypto.getRandomValues)for(r=crypto.getRandomValues(new Uint32Array(n));s<n;)i=r[s],i>=429e7?r[s]=crypto.getRandomValues(new Uint32Array(1))[0]:a[s++]=i%1e7;else if(crypto.randomBytes){for(r=crypto.randomBytes(n*=4);s<n;)i=r[s]+(r[s+1]<<8)+(r[s+2]<<16)+((r[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(r,s):(a.push(i%1e7),s+=4);s=n/4}else throw Error(sr);else for(;s<n;)a[s++]=Math.random()*1e7|0;for(n=a[--s],t%=P,n&&t&&(i=B(10,P-t),a[s]=(n/i|0)*i);a[s]===0;s--)a.pop();if(s<0)e=0,a=[0];else{for(e=-1;a[0]===0;e-=P)a.shift();for(n=1,i=a[0];i>=10;i/=10)n++;n<P&&(e-=P-n)}return l.e=e,l.d=a,l}function ii(t){return L(t=new this(t),t.e+1,this.rounding)}function si(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function oi(t){return new this(t).sin()}function fi(t){return new this(t).sinh()}function ai(t){return new this(t).sqrt()}function li(t,r){return new this(t).sub(r)}function ci(){var t=0,r=arguments,e=new this(r[t]);for(O=!1;e.s&&++t<r.length;)e=e.plus(r[t]);return O=!0,L(e,this.precision,this.rounding)}function ui(t){return new this(t).tan()}function pi(t){return new this(t).tanh()}function hi(t){return L(t=new this(t),t.e+1,1)}E[Symbol.for("nodejs.util.inspect.custom")]=E.toString;E[Symbol.toStringTag]="Decimal";var k=E.constructor=hr(ft);Te=new k(Te);Re=new k(Re);class Yt extends SyntaxError{constructor(r,e,n,i){super(r),this.expected=e,this.found=n,this.location=i,this.name="SyntaxError"}format(r){let e="Error: "+this.message;if(this.location){let n=null;const i=r.find(h=>h.source===this.location.source);i&&(n=i.text.split(/\r\n|\n|\r/g));const s=this.location.start,l=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(s):s,a=this.location.source+":"+l.line+":"+l.column;if(n){const h=this.location.end,p="".padEnd(l.line.toString().length," "),g=n[s.line-1],w=(s.line===h.line?h.column:g.length+1)-s.column||1;e+=`
 --> `+a+`
`+p+` |
`+l.line+" | "+g+`
`+p+" | "+"".padEnd(s.column-1," ")+"".padEnd(w,"^")}else e+=`
 at `+a}return e}static buildMessage(r,e){function n(w){return w.codePointAt(0).toString(16).toUpperCase()}const i=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function s(w){return i?w.replace(i,b=>"\\u{"+n(b)+"}"):w}function l(w){return s(w.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,b=>"\\x0"+n(b)).replace(/[\x10-\x1F\x7F-\x9F]/g,b=>"\\x"+n(b)))}function a(w){return s(w.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,b=>"\\x0"+n(b)).replace(/[\x10-\x1F\x7F-\x9F]/g,b=>"\\x"+n(b)))}const h={literal(w){return'"'+l(w.text)+'"'},class(w){const b=w.parts.map(M=>Array.isArray(M)?a(M[0])+"-"+a(M[1]):a(M));return"["+(w.inverted?"^":"")+b.join("")+"]"+(w.unicode?"u":"")},any(){return"any character"},end(){return"end of input"},other(w){return w.description}};function p(w){return h[w.type](w)}function g(w){const b=w.map(p);if(b.sort(),b.length>0){let M=1;for(let S=1;S<b.length;S++)b[S-1]!==b[S]&&(b[M]=b[S],M++);b.length=M}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}function v(w){return w?'"'+l(w)+'"':"end of input"}return"Expected "+g(r)+" but "+v(e)+" found."}}function di(t,r){r=r!==void 0?r:{};const e={},n=r.grammarSource,i={Expression:J};let s=J;const l="?",a=":",h="||",p="??",g="&&",v="===",w="!==",b="==",M="!=",S="<=",D=">=",_="**",G="(",q=")",j="[",le="]",Q=".",re=",",oe="true",ne="false",ce="null",W='"',ge="'",me="\\",xe="n",Z="r",T="t",dr="{",gr="}",ht=/^[<>]/,Ze=/^[+\-]/,dt=/^[%*\/]/,mr=/^[!+\-]/,Ee=/^[0-9]/,wr=/^[eE]/,$r=/^["\\]/,vr=/^['\\]/,Er=/^[a-zA-Z_$]/,He=/^[a-zA-Z0-9_$]/,gt=/^[ \t\n\r]/,Nr=I("?",!1),mt=I(":",!1),wt=I("||",!1),$t=I("??",!1),vt=I("&&",!1),Et=I("===",!1),Nt=I("!==",!1),bt=I("==",!1),At=I("!=",!1),yt=I("<=",!1),Ct=I(">=",!1),xt=Y(["<",">"],!1,!1,!1),Ve=Y(["+","-"],!1,!1,!1),Mt=Y(["%","*","/"],!1,!1,!1),br=I("**",!1),Ar=Y(["!","+","-"],!1,!1,!1),Ge=I("(",!1),We=I(")",!1),Xe=I("[",!1),Qe=I("]",!1),Je=I(".",!1),Ne=I(",",!1),be=Y([["0","9"]],!1,!1,!1),yr=Y(["e","E"],!1,!1,!1),St=I("true",!1),Lt=I("false",!1),Pt=I("null",!1),Ot=I('"',!1),kt=I("'",!1),Cr=Y(['"',"\\"],!1,!1,!1),Ke=fn(),Ft=I("\\",!1),xr=Y(["'","\\"],!1,!1,!1),Mr=I("n",!1),Sr=I("r",!1),Lr=I("t",!1),Pr=I("{",!1),Or=I("}",!1),kr=Y([["a","z"],["A","Z"],"_","$"],!1,!1,!1),ze=Y([["a","z"],["A","Z"],["0","9"],"_","$"],!1,!1,!1),qt=Y([" ","	",`
`,"\r"],!1,!1,!1);function xi(f){return f}function Fr(f,u,m){return{type:"ConditionalExpression",test:f,consequent:u,alternate:m}}function qr(f,u){return u.reduce((m,c)=>({type:"LogicalExpression",operator:c[1],left:m,right:c[3]}),f)}function Ir(f,u){return u.reduce((m,c)=>({type:"LogicalExpression",operator:c[1],left:m,right:c[3]}),f)}function Tr(f,u){return Fe(f,u)}function Rr(f,u){return Fe(f,u)}function _r(f,u){return Fe(f,u)}function Dr(f,u){return Fe(f,u)}function jr(f,u){return u?{type:"BinaryExpression",operator:"**",left:f,right:u[3]}:f}function Ur(f,u){return{type:"UnaryExpression",operator:f,argument:u,prefix:!0}}function It(f,u){return{type:"call",args:u||[]}}function Tt(f,u){return{type:"member",property:u,computed:!0}}function Rt(f,u){return{type:"member",property:u,computed:!1}}function Br(f,u){return u.reduce((m,c)=>c.type==="call"?{type:"CallExpression",callee:m,arguments:c.args}:{type:"MemberExpression",object:m,property:c.property,computed:c.computed},f)}function Zr(f,u){return[f].concat(u.map(m=>m[3]))}function Mi(f){return f}function Hr(f){return{type:"Literal",value:parseFloat(f),raw:f}}function Vr(){return{type:"Literal",value:!0,raw:"true"}}function Gr(){return{type:"Literal",value:!1,raw:"false"}}function Wr(){return{type:"Literal",value:null,raw:"null"}}function Xr(f){return{type:"Literal",value:f.join(""),raw:'"'+f.join("")+'"'}}function Qr(f){return{type:"Literal",value:f.join(""),raw:"'"+f.join("")+"'"}}function Si(f){return f}function Li(f){return f}function Pi(f){return f}function Oi(f){return f}function Jr(){return`
`}function Kr(){return"\r"}function zr(){return"	"}function ki(f){return f}function Yr(f){return{type:"ArrayExpression",elements:f||[]}}function en(f,u){return[f].concat(u.map(m=>m[3]))}function tn(f){return{type:"ObjectExpression",properties:f||[]}}function rn(f,u){return[f].concat(u.map(m=>m[3]))}function nn(f,u){return{type:"Property",key:f,value:u,kind:"init",method:!1,shorthand:!1,computed:!1}}function sn(f){return{type:"Identifier",name:f}}let o=r.peg$currPos|0;const Ae=[{line:1,column:1}];let z=o,Pe=r.peg$maxFailExpected||[],N=r.peg$silentFails|0,Me;if(r.startRule){if(!(r.startRule in i))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');s=i[r.startRule]}function on(f=o){const u=t.codePointAt(f);return u===void 0?"":String.fromCodePoint(u)}function I(f,u){return{type:"literal",text:f,ignoreCase:u}}function Y(f,u,m,c){return{type:"class",parts:f,inverted:u,ignoreCase:m,unicode:c}}function fn(){return{type:"any"}}function an(){return{type:"end"}}function _t(f){let u=Ae[f],m;if(u)return u;if(f>=Ae.length)m=Ae.length-1;else for(m=f;!Ae[--m];);for(u=Ae[m],u={line:u.line,column:u.column};m<f;)t.charCodeAt(m)===10?(u.line++,u.column=1):u.column++,m++;return Ae[f]=u,u}function Dt(f,u,m){const c=_t(f),$=_t(u);return{source:n,start:{offset:f,line:c.line,column:c.column},end:{offset:u,line:$.line,column:$.column}}}function A(f){o<z||(o>z&&(z=o,Pe=[]),Pe.push(f))}function ln(f,u,m){return new Yt(Yt.buildMessage(f,u),f,u,m)}function J(){let f,u;return f=o,x(),u=jt(),u!==e?(x(),f=u):(o=f,f=e),f}function jt(){let f,u,m,c,$,d;return f=o,u=Ut(),u!==e?(x(),t.charCodeAt(o)===63?(m=l,o++):(m=e,N===0&&A(Nr)),m!==e?(x(),c=J(),c!==e?(x(),t.charCodeAt(o)===58?($=a,o++):($=e,N===0&&A(mt)),$!==e?(x(),d=jt(),d!==e?f=Fr(u,c,d):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e),f===e&&(f=Ut()),f}function Ut(){let f,u,m,c,$,d,y,C;if(f=o,u=Ye(),u!==e){for(m=[],c=o,$=x(),t.substr(o,2)===h?(d=h,o+=2):(d=e,N===0&&A(wt)),d===e&&(t.substr(o,2)===p?(d=p,o+=2):(d=e,N===0&&A($t))),d!==e?(y=x(),C=Ye(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),t.substr(o,2)===h?(d=h,o+=2):(d=e,N===0&&A(wt)),d===e&&(t.substr(o,2)===p?(d=p,o+=2):(d=e,N===0&&A($t))),d!==e?(y=x(),C=Ye(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=qr(u,m)}else o=f,f=e;return f}function Ye(){let f,u,m,c,$,d,y,C;if(f=o,u=et(),u!==e){for(m=[],c=o,$=x(),t.substr(o,2)===g?(d=g,o+=2):(d=e,N===0&&A(vt)),d!==e?(y=x(),C=et(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),t.substr(o,2)===g?(d=g,o+=2):(d=e,N===0&&A(vt)),d!==e?(y=x(),C=et(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=Ir(u,m)}else o=f,f=e;return f}function et(){let f,u,m,c,$,d,y,C;if(f=o,u=tt(),u!==e){for(m=[],c=o,$=x(),t.substr(o,3)===v?(d=v,o+=3):(d=e,N===0&&A(Et)),d===e&&(t.substr(o,3)===w?(d=w,o+=3):(d=e,N===0&&A(Nt)),d===e&&(t.substr(o,2)===b?(d=b,o+=2):(d=e,N===0&&A(bt)),d===e&&(t.substr(o,2)===M?(d=M,o+=2):(d=e,N===0&&A(At))))),d!==e?(y=x(),C=tt(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),t.substr(o,3)===v?(d=v,o+=3):(d=e,N===0&&A(Et)),d===e&&(t.substr(o,3)===w?(d=w,o+=3):(d=e,N===0&&A(Nt)),d===e&&(t.substr(o,2)===b?(d=b,o+=2):(d=e,N===0&&A(bt)),d===e&&(t.substr(o,2)===M?(d=M,o+=2):(d=e,N===0&&A(At))))),d!==e?(y=x(),C=tt(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=Tr(u,m)}else o=f,f=e;return f}function tt(){let f,u,m,c,$,d,y,C;if(f=o,u=rt(),u!==e){for(m=[],c=o,$=x(),t.substr(o,2)===S?(d=S,o+=2):(d=e,N===0&&A(yt)),d===e&&(t.substr(o,2)===D?(d=D,o+=2):(d=e,N===0&&A(Ct)),d===e&&(d=t.charAt(o),ht.test(d)?o++:(d=e,N===0&&A(xt)))),d!==e?(y=x(),C=rt(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),t.substr(o,2)===S?(d=S,o+=2):(d=e,N===0&&A(yt)),d===e&&(t.substr(o,2)===D?(d=D,o+=2):(d=e,N===0&&A(Ct)),d===e&&(d=t.charAt(o),ht.test(d)?o++:(d=e,N===0&&A(xt)))),d!==e?(y=x(),C=rt(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=Rr(u,m)}else o=f,f=e;return f}function rt(){let f,u,m,c,$,d,y,C;if(f=o,u=nt(),u!==e){for(m=[],c=o,$=x(),d=t.charAt(o),Ze.test(d)?o++:(d=e,N===0&&A(Ve)),d!==e?(y=x(),C=nt(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),d=t.charAt(o),Ze.test(d)?o++:(d=e,N===0&&A(Ve)),d!==e?(y=x(),C=nt(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=_r(u,m)}else o=f,f=e;return f}function nt(){let f,u,m,c,$,d,y,C;if(f=o,u=Oe(),u!==e){for(m=[],c=o,$=x(),d=t.charAt(o),dt.test(d)?o++:(d=e,N===0&&A(Mt)),d!==e?(y=x(),C=Oe(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),d=t.charAt(o),dt.test(d)?o++:(d=e,N===0&&A(Mt)),d!==e?(y=x(),C=Oe(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=Dr(u,m)}else o=f,f=e;return f}function Oe(){let f,u,m,c,$,d,y;return f=o,u=Bt(),u!==e?(m=o,c=x(),t.substr(o,2)===_?($=_,o+=2):($=e,N===0&&A(br)),$!==e?(d=x(),y=Oe(),y!==e?(c=[c,$,d,y],m=c):(o=m,m=e)):(o=m,m=e),m===e&&(m=null),f=jr(u,m)):(o=f,f=e),f}function Bt(){let f,u,m;return f=o,u=t.charAt(o),mr.test(u)?o++:(u=e,N===0&&A(Ar)),u!==e?(x(),m=Bt(),m!==e?f=Ur(u,m):(o=f,f=e)):(o=f,f=e),f===e&&(f=cn()),f}function cn(){let f,u,m,c,$,d,y;if(f=o,u=un(),u!==e){for(m=[],c=o,x(),t.charCodeAt(o)===40?($=G,o++):($=e,N===0&&A(Ge)),$!==e?(x(),d=Zt(),d===e&&(d=null),x(),t.charCodeAt(o)===41?(y=q,o++):(y=e,N===0&&A(We)),y!==e?c=It(u,d):(o=c,c=e)):(o=c,c=e),c===e&&(c=o,x(),t.charCodeAt(o)===91?($=j,o++):($=e,N===0&&A(Xe)),$!==e?(x(),d=J(),d!==e?(x(),t.charCodeAt(o)===93?(y=le,o++):(y=e,N===0&&A(Qe)),y!==e?c=Tt(u,d):(o=c,c=e)):(o=c,c=e)):(o=c,c=e),c===e&&(c=o,x(),t.charCodeAt(o)===46?($=Q,o++):($=e,N===0&&A(Je)),$!==e?(x(),d=ke(),d!==e?c=Rt(u,d):(o=c,c=e)):(o=c,c=e)));c!==e;)m.push(c),c=o,x(),t.charCodeAt(o)===40?($=G,o++):($=e,N===0&&A(Ge)),$!==e?(x(),d=Zt(),d===e&&(d=null),x(),t.charCodeAt(o)===41?(y=q,o++):(y=e,N===0&&A(We)),y!==e?c=It(u,d):(o=c,c=e)):(o=c,c=e),c===e&&(c=o,x(),t.charCodeAt(o)===91?($=j,o++):($=e,N===0&&A(Xe)),$!==e?(x(),d=J(),d!==e?(x(),t.charCodeAt(o)===93?(y=le,o++):(y=e,N===0&&A(Qe)),y!==e?c=Tt(u,d):(o=c,c=e)):(o=c,c=e)):(o=c,c=e),c===e&&(c=o,x(),t.charCodeAt(o)===46?($=Q,o++):($=e,N===0&&A(Je)),$!==e?(x(),d=ke(),d!==e?c=Rt(u,d):(o=c,c=e)):(o=c,c=e)));f=Br(u,m)}else o=f,f=e;return f}function Zt(){let f,u,m,c,$,d,y,C;if(f=o,u=J(),u!==e){for(m=[],c=o,$=x(),t.charCodeAt(o)===44?(d=re,o++):(d=e,N===0&&A(Ne)),d!==e?(y=x(),C=J(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),t.charCodeAt(o)===44?(d=re,o++):(d=e,N===0&&A(Ne)),d!==e?(y=x(),C=J(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=Zr(u,m)}else o=f,f=e;return f}function un(){let f,u,m,c;return f=pn(),f===e&&(f=gn(),f===e&&(f=wn(),f===e&&(f=ke(),f===e&&(f=o,t.charCodeAt(o)===40?(u=G,o++):(u=e,N===0&&A(Ge)),u!==e?(x(),m=J(),m!==e?(x(),t.charCodeAt(o)===41?(c=q,o++):(c=e,N===0&&A(We)),c!==e?f=m:(o=f,f=e)):(o=f,f=e)):(o=f,f=e))))),f}function pn(){let f;return f=Ht(),f===e&&(f=hn(),f===e&&(f=dn(),f===e&&(f=Vt()))),f}function Ht(){let f,u,m,c,$,d,y,C,Se,fe;if(f=o,u=o,m=o,c=[],$=t.charAt(o),Ee.test($)?o++:($=e,N===0&&A(be)),$!==e)for(;$!==e;)c.push($),$=t.charAt(o),Ee.test($)?o++:($=e,N===0&&A(be));else c=e;if(c!==e){if($=o,t.charCodeAt(o)===46?(d=Q,o++):(d=e,N===0&&A(Je)),d!==e){if(y=[],C=t.charAt(o),Ee.test(C)?o++:(C=e,N===0&&A(be)),C!==e)for(;C!==e;)y.push(C),C=t.charAt(o),Ee.test(C)?o++:(C=e,N===0&&A(be));else y=e;y!==e?(d=[d,y],$=d):(o=$,$=e)}else o=$,$=e;if($===e&&($=null),d=o,y=t.charAt(o),wr.test(y)?o++:(y=e,N===0&&A(yr)),y!==e){if(C=t.charAt(o),Ze.test(C)?o++:(C=e,N===0&&A(Ve)),C===e&&(C=null),Se=[],fe=t.charAt(o),Ee.test(fe)?o++:(fe=e,N===0&&A(be)),fe!==e)for(;fe!==e;)Se.push(fe),fe=t.charAt(o),Ee.test(fe)?o++:(fe=e,N===0&&A(be));else Se=e;Se!==e?(y=[y,C,Se],d=y):(o=d,d=e)}else o=d,d=e;d===e&&(d=null),c=[c,$,d],m=c}else o=m,m=e;return m!==e?u=t.substring(u,o):u=m,u!==e&&(u=Hr(u)),f=u,f}function hn(){let f,u;return f=o,t.substr(o,4)===oe?(u=oe,o+=4):(u=e,N===0&&A(St)),u!==e&&(u=Vr()),f=u,f===e&&(f=o,t.substr(o,5)===ne?(u=ne,o+=5):(u=e,N===0&&A(Lt)),u!==e&&(u=Gr()),f=u),f}function dn(){let f,u;return f=o,t.substr(o,4)===ce?(u=ce,o+=4):(u=e,N===0&&A(Pt)),u!==e&&(u=Wr()),f=u,f}function Vt(){let f,u,m,c;if(f=o,t.charCodeAt(o)===34?(u=W,o++):(u=e,N===0&&A(Ot)),u!==e){for(m=[],c=Gt();c!==e;)m.push(c),c=Gt();t.charCodeAt(o)===34?(c=W,o++):(c=e,N===0&&A(Ot)),c!==e?f=Xr(m):(o=f,f=e)}else o=f,f=e;if(f===e)if(f=o,t.charCodeAt(o)===39?(u=ge,o++):(u=e,N===0&&A(kt)),u!==e){for(m=[],c=Wt();c!==e;)m.push(c),c=Wt();t.charCodeAt(o)===39?(c=ge,o++):(c=e,N===0&&A(kt)),c!==e?f=Qr(m):(o=f,f=e)}else o=f,f=e;return f}function Gt(){let f,u,m;return f=o,u=o,N++,m=t.charAt(o),$r.test(m)?o++:(m=e,N===0&&A(Cr)),N--,m===e?u=void 0:(o=u,u=e),u!==e?(t.length>o?(m=t.charAt(o),o++):(m=e,N===0&&A(Ke)),m!==e?f=m:(o=f,f=e)):(o=f,f=e),f===e&&(f=o,t.charCodeAt(o)===92?(u=me,o++):(u=e,N===0&&A(Ft)),u!==e?(m=Xt(),m!==e?f=m:(o=f,f=e)):(o=f,f=e)),f}function Wt(){let f,u,m;return f=o,u=o,N++,m=t.charAt(o),vr.test(m)?o++:(m=e,N===0&&A(xr)),N--,m===e?u=void 0:(o=u,u=e),u!==e?(t.length>o?(m=t.charAt(o),o++):(m=e,N===0&&A(Ke)),m!==e?f=m:(o=f,f=e)):(o=f,f=e),f===e&&(f=o,t.charCodeAt(o)===92?(u=me,o++):(u=e,N===0&&A(Ft)),u!==e?(m=Xt(),m!==e?f=m:(o=f,f=e)):(o=f,f=e)),f}function Xt(){let f,u;return f=o,t.charCodeAt(o)===110?(u=xe,o++):(u=e,N===0&&A(Mr)),u!==e&&(u=Jr()),f=u,f===e&&(f=o,t.charCodeAt(o)===114?(u=Z,o++):(u=e,N===0&&A(Sr)),u!==e&&(u=Kr()),f=u,f===e&&(f=o,t.charCodeAt(o)===116?(u=T,o++):(u=e,N===0&&A(Lr)),u!==e&&(u=zr()),f=u,f===e&&(f=o,t.length>o?(u=t.charAt(o),o++):(u=e,N===0&&A(Ke)),u!==e&&(u=u),f=u))),f}function gn(){let f,u,m,c;return f=o,t.charCodeAt(o)===91?(u=j,o++):(u=e,N===0&&A(Xe)),u!==e?(x(),m=mn(),m===e&&(m=null),x(),t.charCodeAt(o)===93?(c=le,o++):(c=e,N===0&&A(Qe)),c!==e?f=Yr(m):(o=f,f=e)):(o=f,f=e),f}function mn(){let f,u,m,c,$,d,y,C;if(f=o,u=J(),u!==e){for(m=[],c=o,$=x(),t.charCodeAt(o)===44?(d=re,o++):(d=e,N===0&&A(Ne)),d!==e?(y=x(),C=J(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),t.charCodeAt(o)===44?(d=re,o++):(d=e,N===0&&A(Ne)),d!==e?(y=x(),C=J(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=en(u,m)}else o=f,f=e;return f}function wn(){let f,u,m,c;return f=o,t.charCodeAt(o)===123?(u=dr,o++):(u=e,N===0&&A(Pr)),u!==e?(x(),m=$n(),m===e&&(m=null),x(),t.charCodeAt(o)===125?(c=gr,o++):(c=e,N===0&&A(Or)),c!==e?f=tn(m):(o=f,f=e)):(o=f,f=e),f}function $n(){let f,u,m,c,$,d,y,C;if(f=o,u=it(),u!==e){for(m=[],c=o,$=x(),t.charCodeAt(o)===44?(d=re,o++):(d=e,N===0&&A(Ne)),d!==e?(y=x(),C=it(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);c!==e;)m.push(c),c=o,$=x(),t.charCodeAt(o)===44?(d=re,o++):(d=e,N===0&&A(Ne)),d!==e?(y=x(),C=it(),C!==e?($=[$,d,y,C],c=$):(o=c,c=e)):(o=c,c=e);f=rn(u,m)}else o=f,f=e;return f}function it(){let f,u,m,c;return f=o,u=vn(),u!==e?(x(),t.charCodeAt(o)===58?(m=a,o++):(m=e,N===0&&A(mt)),m!==e?(x(),c=J(),c!==e?f=nn(u,c):(o=f,f=e)):(o=f,f=e)):(o=f,f=e),f}function vn(){let f;return f=ke(),f===e&&(f=Vt(),f===e&&(f=Ht())),f}function ke(){let f,u,m,c,$,d,y;if(f=o,u=o,N++,m=En(),N--,m===e?u=void 0:(o=u,u=e),u!==e){if(m=o,c=o,$=t.charAt(o),Er.test($)?o++:($=e,N===0&&A(kr)),$!==e){for(d=[],y=t.charAt(o),He.test(y)?o++:(y=e,N===0&&A(ze));y!==e;)d.push(y),y=t.charAt(o),He.test(y)?o++:(y=e,N===0&&A(ze));$=[$,d],c=$}else o=c,c=e;c!==e?m=t.substring(m,o):m=c,m!==e?f=sn(m):(o=f,f=e)}else o=f,f=e;return f}function En(){let f,u,m,c;return f=o,t.substr(o,4)===oe?(u=oe,o+=4):(u=e,N===0&&A(St)),u===e&&(t.substr(o,5)===ne?(u=ne,o+=5):(u=e,N===0&&A(Lt)),u===e&&(t.substr(o,4)===ce?(u=ce,o+=4):(u=e,N===0&&A(Pt)))),u!==e?(m=o,N++,c=t.charAt(o),He.test(c)?o++:(c=e,N===0&&A(ze)),N--,c===e?m=void 0:(o=m,m=e),m!==e?(u=[u,m],f=u):(o=f,f=e)):(o=f,f=e),f}function x(){let f,u;for(N++,f=[],u=t.charAt(o),gt.test(u)?o++:(u=e,N===0&&A(qt));u!==e;)f.push(u),u=t.charAt(o),gt.test(u)?o++:(u=e,N===0&&A(qt));return N--,f}function Fe(f,u){return u.reduce((m,c)=>({type:"BinaryExpression",operator:c[1],left:m,right:c[3]}),f)}Me=s();const st=Me!==e&&o===t.length;function Qt(){throw Me!==e&&o<t.length&&A(an()),ln(Pe,z<t.length?on(z):null,z<t.length?Dt(z,z+1):Dt(z,z))}if(r.peg$library)return{peg$result:Me,peg$currPos:o,peg$FAILED:e,peg$maxFailExpected:Pe,peg$maxFailPos:z,peg$success:st,peg$throw:st?void 0:Qt};if(st)return Me;Qt()}const gi=t=>{const r=new Set,e=n=>{if(!(!n||typeof n!="object"))switch(n.type){case"Identifier":r.add(n.name);break;case"MemberExpression":e(n.object),n.computed&&e(n.property);break;case"BinaryExpression":case"LogicalExpression":e(n.left),e(n.right);break;case"UnaryExpression":e(n.argument);break;case"CallExpression":if(e(n.callee),n.arguments)for(const i of n.arguments)e(i);break;case"ConditionalExpression":e(n.test),e(n.consequent),e(n.alternate);break;case"ArrayExpression":if(n.elements)for(const i of n.elements)e(i);break;case"ObjectExpression":if(n.properties)for(const i of n.properties)i.type==="Property"?(i.computed&&e(i.key),e(i.value)):i.type==="SpreadElement"&&e(i.argument);break}};return e(t),Array.from(r).filter(n=>!n.startsWith("$"))};class ve extends Error{constructor(r){super(r),this.name="EvallaError",Object.setPrototypeOf(this,ve.prototype)}}class ut extends ve{constructor(r,e){super(r),this.name="SecurityError",this.property=e,Object.setPrototypeOf(this,ut.prototype)}}class pt extends ve{constructor(r,e){super(r),this.name="CircularDependencyError",this.cycle=e,Object.setPrototypeOf(this,pt.prototype)}}class K extends ve{constructor(r,e){super(r),this.name="ValidationError",this.variableName=e,Object.setPrototypeOf(this,K.prototype)}}class ee extends ve{constructor(r,e){super(r),this.name="EvaluationError",this.variableName=e,Object.setPrototypeOf(this,ee.prototype)}}class we extends ee{constructor(r,e){super(r,e?.variableName),this.name="ParseError",this.expression=e?.expression,this.line=e?.line,this.column=e?.column,Object.setPrototypeOf(this,we.prototype)}}const mi=t=>{try{return di(t.trim())}catch(r){if(r.location){const{line:e,column:n}=r.location.start;throw new we(`Parse error at line ${e}, column ${n}: ${r.message}`,{line:e,column:n,expression:t})}throw new we(`Parse error: ${r.message}`,{expression:t})}},wi=t=>gi(t),$i=t=>{const r=new Map,e=new Set,n=new Map;for(const h of t)if(e.add(h.name),h.expr)try{const p=mi(h.expr);n.set(h.name,p)}catch(p){throw p instanceof we?new we(`Failed to parse expression for "${h.name}": ${p.message}`,{variableName:h.name,expression:h.expr,line:p.line,column:p.column}):new we(`Failed to parse expression for "${h.name}": ${p instanceof Error?p.message:String(p)}`,{variableName:h.name,expression:h.expr})}for(const h of t){if(!h.expr){r.set(h.name,[]);continue}const p=n.get(h.name);if(!p)throw new ee(`No AST found for: ${h.name}`);const v=wi(p).filter(w=>e.has(w));r.set(h.name,v)}const i=new Set,s=new Set,l=[],a=(h,p=[])=>{if(i.has(h))return;if(s.has(h)){const v=[...p,h];throw new pt(`Circular dependency detected: ${v.join(" -> ")}`,v)}s.add(h);const g=r.get(h)||[];for(const v of g)e.has(v)&&a(v,[...p,h]);s.delete(h),i.add(h),l.push(h)};for(const h of e)a(h);return{order:l,asts:n}},F=t=>t instanceof k?t:new k(t),vi=()=>{const t=Object.create(null);return t.$math=Object.create(null),t.$math.PI=new k(Math.PI),t.$math.E=new k(Math.E),t.$math.SQRT2=new k(Math.SQRT2),t.$math.SQRT1_2=new k(Math.SQRT1_2),t.$math.LN2=new k(Math.LN2),t.$math.LN10=new k(Math.LN10),t.$math.LOG2E=new k(Math.LOG2E),t.$math.LOG10E=new k(Math.LOG10E),t.$math.abs=r=>F(r).abs(),t.$math.sqrt=r=>F(r).sqrt(),t.$math.cbrt=r=>F(r).cbrt(),t.$math.floor=r=>F(r).floor(),t.$math.ceil=r=>F(r).ceil(),t.$math.round=r=>F(r).round(),t.$math.trunc=r=>F(r).trunc(),t.$math.sin=r=>new k(Math.sin(F(r).toNumber())),t.$math.cos=r=>new k(Math.cos(F(r).toNumber())),t.$math.tan=r=>new k(Math.tan(F(r).toNumber())),t.$math.asin=r=>new k(Math.asin(F(r).toNumber())),t.$math.acos=r=>new k(Math.acos(F(r).toNumber())),t.$math.atan=r=>new k(Math.atan(F(r).toNumber())),t.$math.atan2=(r,e)=>new k(Math.atan2(F(r).toNumber(),F(e).toNumber())),t.$math.exp=r=>F(r).exp(),t.$math.ln=r=>F(r).ln(),t.$math.log=r=>F(r).log(),t.$math.log10=r=>F(r).log(10),t.$math.log2=r=>F(r).log(2),t.$math.pow=(r,e)=>F(r).pow(F(e)),t.$math.min=(...r)=>k.min(...r.map(F)),t.$math.max=(...r)=>k.max(...r.map(F)),t.$unit=Object.create(null),t.$unit.mmToInch=r=>F(r).div(25.4),t.$unit.inchToMm=r=>F(r).mul(25.4),t.$unit.cmToInch=r=>F(r).div(2.54),t.$unit.inchToCm=r=>F(r).mul(2.54),t.$unit.mToFt=r=>F(r).mul(3.28084),t.$unit.ftToM=r=>F(r).div(3.28084),t.$angle=Object.create(null),t.$angle.toRad=r=>F(r).mul(Math.PI).div(180),t.$angle.toDeg=r=>F(r).mul(180).div(Math.PI),t},Ei=new Set(["prototype","__proto__","constructor"]),Ni=t=>!(Ei.has(t)||t.startsWith("__")),U=async(t,r)=>{switch(t.type){case"Literal":return typeof t.value=="number"?new k(t.raw||t.value):t.value;case"Identifier":if(!(t.name in r))throw new ee(`Undefined variable: ${t.name}`);return r[t.name];case"MemberExpression":const e=await U(t.object,r);if(e==null)throw new ee(`Cannot access property of ${e}`);let n;if(t.computed){const M=await U(t.property,r);n=String(M)}else n=t.property.name;if(!Ni(n))throw new ut(`Access to property "${n}" is not allowed for security reasons`,n);return e[n];case"ObjectExpression":const i={};for(const M of t.properties)if(M.type==="Property"){const S=M.key.type==="Identifier"?M.key.name:await U(M.key,r),D=await U(M.value,r);i[S]=D}else if(M.type==="SpreadElement"){const S=await U(M.argument,r);Object.assign(i,S)}return i;case"BinaryExpression":const s=await U(t.left,r),l=await U(t.right,r);return bi(t.operator,s,l);case"UnaryExpression":const a=await U(t.argument,r);return Ai(t.operator,a);case"CallExpression":const h=await U(t.callee,r),p=[];for(const M of t.arguments)p.push(await U(M,r));if(typeof h!="function")throw new ee("Callee is not a function");let g=null;return t.callee.type==="MemberExpression"&&(g=await U(t.callee.object,r)),h.apply(g,p);case"ConditionalExpression":return await U(t.test,r)?await U(t.consequent,r):await U(t.alternate,r);case"LogicalExpression":const w=await U(t.left,r);if(t.operator==="&&")return w&&await U(t.right,r);if(t.operator==="||")return w||await U(t.right,r);if(t.operator==="??")return w??await U(t.right,r);throw new ee(`Unsupported logical operator: ${t.operator}`);case"ArrayExpression":const b=[];for(const M of t.elements)b.push(await U(M,r));return b;default:throw new ee(`Unsupported node type: ${t.type}`)}},bi=(t,r,e)=>{const n=i=>i instanceof k?i:new k(i);switch(t){case"+":return n(r).plus(n(e));case"-":return n(r).minus(n(e));case"*":return n(r).times(n(e));case"/":return n(r).div(n(e));case"%":return n(r).mod(n(e));case"**":return n(r).pow(n(e));case"<":return n(r).lt(n(e));case">":return n(r).gt(n(e));case"<=":return n(r).lte(n(e));case">=":return n(r).gte(n(e));case"==":case"===":return r instanceof k&&e instanceof k?r.eq(e):t==="==="?r===e:r==e;case"!=":case"!==":return r instanceof k&&e instanceof k?!r.eq(e):t==="!=="?r!==e:r!=e;default:throw new ee(`Unsupported binary operator: ${t}`)}},Ai=(t,r)=>{switch(t){case"-":return r instanceof k?r.neg():-r;case"+":return r instanceof k?r:+r;case"!":return!r;default:throw new ee(`Unsupported unary operator: ${t}`)}},yi=async(t,r)=>{try{const e=vi(),n=Object.create(null);for(const[s,l]of Object.entries(r))n[s]=l;for(const[s,l]of Object.entries(e))n[s]=l;const i=await U(t,n);return i instanceof k?i:typeof i=="number"?new k(i):typeof i=="string"&&!isNaN(Number(i))?new k(i):i}catch(e){throw e instanceof ve?e:new Error(`Failed to evaluate expression: ${e instanceof Error?e.message:String(e)}`)}},Ci=async t=>{if(!Array.isArray(t))throw new K("Input must be an array");for(const a of t){if(!a||typeof a!="object")throw new K("Each input must be an object");if(typeof a.name!="string"||!a.name)throw new K('Each input must have a non-empty string "name"');if(a.name.startsWith("$"))throw new K(`Variable names cannot start with $: ${a.name} ($ is reserved for system namespaces)`,a.name);if(a.name.startsWith("__"))throw new K(`Variable names cannot start with __: ${a.name} (__ prefix is reserved for security reasons)`,a.name);if(/^\d/.test(a.name))throw new K(`Variable names cannot start with a number: ${a.name}`,a.name);if(a.name.includes("."))throw new K(`Variable names cannot contain dots: ${a.name} (dots are only for property access in expressions)`,a.name);if(!a.expr&&a.value===void 0)throw new K(`Each input must have either "expr" or "value": ${a.name}`,a.name);if(a.expr!==void 0&&typeof a.expr!="string")throw new K(`"expr" must be a string if provided: ${a.name}`,a.name)}const r=new Set;for(const a of t){if(r.has(a.name))throw new K(`Duplicate name: ${a.name}`,a.name);r.add(a.name)}const{order:e,asts:n}=$i(t),i=new Map;for(const a of t)a.value!==void 0&&i.set(a.name,a.value);const s=Object.create(null),l=Object.create(null);for(const a of e){let h;if(i.has(a))h=i.get(a);else{const p=n.get(a);if(!p)throw new Error(`No expression or value found for: ${a}`);h=await yi(p,l)}h instanceof k?(s[a]=h,l[a]=h):(l[a]=h,typeof h=="number"&&(s[a]=new k(h)))}return{values:s,order:e}};let $e=[{name:"a",expr:"10"},{name:"b",expr:"a * 2"},{name:"c",expr:"a + b"}];function Be(){const t=document.getElementById("expressions");t&&(t.innerHTML="",$e.forEach((r,e)=>{const n=document.createElement("div");n.className="expression-item",n.innerHTML=`
          <input type="text" placeholder="Variable name" value="${r.name}" data-index="${e}" data-field="name">
          <input type="text" placeholder="Expression (e.g., a + b)" value="${r.expr}" data-index="${e}" data-field="expr">
          <button class="remove-btn" data-index="${e}"> Remove</button>
        `,t.appendChild(n)}),t.querySelectorAll("input").forEach(r=>{r.addEventListener("input",e=>{const n=e.target;if(!n)return;const i=parseInt(n.dataset.index||"0"),s=n.dataset.field;s&&($e[i][s]=n.value)})}),t.querySelectorAll(".remove-btn").forEach(r=>{r.addEventListener("click",e=>{const n=e.target;if(!n)return;const i=parseInt(n.dataset.index||"0");$e.splice(i,1),Be()})}))}const er=document.getElementById("add-expression");er&&er.addEventListener("click",()=>{$e.push({name:"",expr:""}),Be()});const tr=document.getElementById("load-example");tr&&tr.addEventListener("click",()=>{$e=[{name:"radius",expr:"5"},{name:"pi",expr:"$math.PI"},{name:"circumference",expr:"2 * pi * radius"},{name:"area",expr:"pi * radius * radius"},{name:"point",expr:"{x: 10, y: 20}"},{name:"scaledX",expr:"point.x * 2"}],Be()});const rr=document.getElementById("evaluate");rr&&rr.addEventListener("click",async()=>{const t=document.getElementById("result-container");if(t)try{const r=$e.filter(i=>i.name.trim()&&i.expr.trim());if(r.length===0){t.innerHTML='<div class="error-message"> Please add at least one expression</div>';return}const e=await Ci(r);let n='<div class="result-section"><h3> Results</h3><div class="result-values">';for(const[i,s]of Object.entries(e.values))n+=`
              <div class="result-item">
                <div class="result-name">${i}</div>
                <div class="result-value">${s.toString()}</div>
              </div>
            `;n+="</div>",n+=`<div class="evaluation-order"> Evaluation order: ${e.order.join("  ")}</div>`,n+="</div>",t.innerHTML=n,document.querySelectorAll(".expression-item").forEach(i=>{i.classList.remove("error")})}catch(r){const e=r;let n=`<div class="error-message"> ${e.message}</div>`;if(e.variableName){const i=$e.findIndex(s=>s.name===e.variableName);if(i!==-1){const s=document.querySelectorAll(".expression-item");s[i]&&s[i].classList.add("error")}}t.innerHTML=n}});Be();
