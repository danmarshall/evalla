/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var Ne=9e15,pe=1e9,tt="0123456789abcdef",Ie="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",_e="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",rt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ne,maxE:Ne,crypto:!1},qt,oe,k=!0,Re="[DecimalError] ",ue=Re+"Invalid argument: ",It=Re+"Precision limit exceeded",_t=Re+"crypto unavailable",Dt="[object Decimal]",W=Math.floor,U=Math.pow,kr=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Lr=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Fr=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Rt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Y=1e7,x=7,qr=9007199254740991,Ir=Ie.length-1,nt=_e.length-1,v={toStringTag:Dt};v.absoluteValue=v.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),M(t)};v.ceil=function(){return M(new this.constructor(this),this.e+1,2)};v.clampedTo=v.clamp=function(t,r){var e,n=this,s=n.constructor;if(t=new s(t),r=new s(r),!t.s||!r.s)return new s(NaN);if(t.gt(r))throw Error(ue+r);return e=n.cmp(t),e<0?t:n.cmp(r)>0?r:new s(n)};v.comparedTo=v.cmp=function(t){var r,e,n,s,i=this,f=i.d,a=(t=new i.constructor(t)).d,l=i.s,c=t.s;if(!f||!a)return!l||!c?NaN:l!==c?l:f===a?0:!f^l<0?1:-1;if(!f[0]||!a[0])return f[0]?l:a[0]?-c:0;if(l!==c)return l;if(i.e!==t.e)return i.e>t.e^l<0?1:-1;for(n=f.length,s=a.length,r=0,e=n<s?n:s;r<e;++r)if(f[r]!==a[r])return f[r]>a[r]^l<0?1:-1;return n===s?0:n>s^l<0?1:-1};v.cosine=v.cos=function(){var t,r,e=this,n=e.constructor;return e.d?e.d[0]?(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+x,n.rounding=1,e=_r(n,Bt(n,e)),n.precision=t,n.rounding=r,M(oe==2||oe==3?e.neg():e,t,r,!0)):new n(1):new n(NaN)};v.cubeRoot=v.cbrt=function(){var t,r,e,n,s,i,f,a,l,c,g=this,w=g.constructor;if(!g.isFinite()||g.isZero())return new w(g);for(k=!1,i=g.s*U(g.s*g,1/3),!i||Math.abs(i)==1/0?(e=H(g.d),t=g.e,(i=(t-e.length+1)%3)&&(e+=i==1||i==-2?"0":"00"),i=U(e,1/3),t=W((t+1)/3)-(t%3==(t<0?-1:2)),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new w(e),n.s=g.s):n=new w(i.toString()),f=(t=w.precision)+3;;)if(a=n,l=a.times(a).times(a),c=l.plus(g),n=D(c.plus(g).times(a),c.plus(l),f+2,1),H(a.d).slice(0,f)===(e=H(n.d)).slice(0,f))if(e=e.slice(f-3,f+1),e=="9999"||!s&&e=="4999"){if(!s&&(M(a,t+1,0),a.times(a).times(a).eq(g))){n=a;break}f+=4,s=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(M(n,t+1,1),r=!n.times(n).times(n).eq(g));break}return k=!0,M(n,t,w.rounding,r)};v.decimalPlaces=v.dp=function(){var t,r=this.d,e=NaN;if(r){if(t=r.length-1,e=(t-W(this.e/x))*x,t=r[t],t)for(;t%10==0;t/=10)e--;e<0&&(e=0)}return e};v.dividedBy=v.div=function(t){return D(this,new this.constructor(t))};v.dividedToIntegerBy=v.divToInt=function(t){var r=this,e=r.constructor;return M(D(r,new e(t),0,1,1),e.precision,e.rounding)};v.equals=v.eq=function(t){return this.cmp(t)===0};v.floor=function(){return M(new this.constructor(this),this.e+1,3)};v.greaterThan=v.gt=function(t){return this.cmp(t)>0};v.greaterThanOrEqualTo=v.gte=function(t){var r=this.cmp(t);return r==1||r===0};v.hyperbolicCosine=v.cosh=function(){var t,r,e,n,s,i=this,f=i.constructor,a=new f(1);if(!i.isFinite())return new f(i.s?1/0:NaN);if(i.isZero())return a;e=f.precision,n=f.rounding,f.precision=e+Math.max(i.e,i.sd())+4,f.rounding=1,s=i.d.length,s<32?(t=Math.ceil(s/3),r=(1/je(4,t)).toString()):(t=16,r="2.3283064365386962890625e-10"),i=Ae(f,1,i.times(r),new f(1),!0);for(var l,c=t,g=new f(8);c--;)l=i.times(i),i=a.minus(l.times(g.minus(l.times(g))));return M(i,f.precision=e,f.rounding=n,!0)};v.hyperbolicSine=v.sinh=function(){var t,r,e,n,s=this,i=s.constructor;if(!s.isFinite()||s.isZero())return new i(s);if(r=i.precision,e=i.rounding,i.precision=r+Math.max(s.e,s.sd())+4,i.rounding=1,n=s.d.length,n<3)s=Ae(i,2,s,s,!0);else{t=1.4*Math.sqrt(n),t=t>16?16:t|0,s=s.times(1/je(5,t)),s=Ae(i,2,s,s,!0);for(var f,a=new i(5),l=new i(16),c=new i(20);t--;)f=s.times(s),s=s.times(a.plus(f.times(l.times(f).plus(c))))}return i.precision=r,i.rounding=e,M(s,r,e,!0)};v.hyperbolicTangent=v.tanh=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+7,n.rounding=1,D(e.sinh(),e.cosh(),n.precision=t,n.rounding=r)):new n(e.s)};v.inverseCosine=v.acos=function(){var t=this,r=t.constructor,e=t.abs().cmp(1),n=r.precision,s=r.rounding;return e!==-1?e===0?t.isNeg()?te(r,n,s):new r(0):new r(NaN):t.isZero()?te(r,n+4,s).times(.5):(r.precision=n+6,r.rounding=1,t=new r(1).minus(t).div(t.plus(1)).sqrt().atan(),r.precision=n,r.rounding=s,t.times(2))};v.inverseHyperbolicCosine=v.acosh=function(){var t,r,e=this,n=e.constructor;return e.lte(1)?new n(e.eq(1)?0:NaN):e.isFinite()?(t=n.precision,r=n.rounding,n.precision=t+Math.max(Math.abs(e.e),e.sd())+4,n.rounding=1,k=!1,e=e.times(e).minus(1).sqrt().plus(e),k=!0,n.precision=t,n.rounding=r,e.ln()):new n(e)};v.inverseHyperbolicSine=v.asinh=function(){var t,r,e=this,n=e.constructor;return!e.isFinite()||e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+2*Math.max(Math.abs(e.e),e.sd())+6,n.rounding=1,k=!1,e=e.times(e).plus(1).sqrt().plus(e),k=!0,n.precision=t,n.rounding=r,e.ln())};v.inverseHyperbolicTangent=v.atanh=function(){var t,r,e,n,s=this,i=s.constructor;return s.isFinite()?s.e>=0?new i(s.abs().eq(1)?s.s/0:s.isZero()?s:NaN):(t=i.precision,r=i.rounding,n=s.sd(),Math.max(n,t)<2*-s.e-1?M(new i(s),t,r,!0):(i.precision=e=n-s.e,s=D(s.plus(1),new i(1).minus(s),e+t,1),i.precision=t+4,i.rounding=1,s=s.ln(),i.precision=t,i.rounding=r,s.times(.5))):new i(NaN)};v.inverseSine=v.asin=function(){var t,r,e,n,s=this,i=s.constructor;return s.isZero()?new i(s):(r=s.abs().cmp(1),e=i.precision,n=i.rounding,r!==-1?r===0?(t=te(i,e+4,n).times(.5),t.s=s.s,t):new i(NaN):(i.precision=e+6,i.rounding=1,s=s.div(new i(1).minus(s.times(s)).sqrt().plus(1)).atan(),i.precision=e,i.rounding=n,s.times(2)))};v.inverseTangent=v.atan=function(){var t,r,e,n,s,i,f,a,l,c=this,g=c.constructor,w=g.precision,m=g.rounding;if(c.isFinite()){if(c.isZero())return new g(c);if(c.abs().eq(1)&&w+4<=nt)return f=te(g,w+4,m).times(.25),f.s=c.s,f}else{if(!c.s)return new g(NaN);if(w+4<=nt)return f=te(g,w+4,m).times(.5),f.s=c.s,f}for(g.precision=a=w+10,g.rounding=1,e=Math.min(28,a/x+2|0),t=e;t;--t)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(k=!1,r=Math.ceil(a/x),n=1,l=c.times(c),f=new g(c),s=c;t!==-1;)if(s=s.times(l),i=f.minus(s.div(n+=2)),s=s.times(l),f=i.plus(s.div(n+=2)),f.d[r]!==void 0)for(t=r;f.d[t]===i.d[t]&&t--;);return e&&(f=f.times(2<<e-1)),k=!0,M(f,g.precision=w,g.rounding=m,!0)};v.isFinite=function(){return!!this.d};v.isInteger=v.isInt=function(){return!!this.d&&W(this.e/x)>this.d.length-2};v.isNaN=function(){return!this.s};v.isNegative=v.isNeg=function(){return this.s<0};v.isPositive=v.isPos=function(){return this.s>0};v.isZero=function(){return!!this.d&&this.d[0]===0};v.lessThan=v.lt=function(t){return this.cmp(t)<0};v.lessThanOrEqualTo=v.lte=function(t){return this.cmp(t)<1};v.logarithm=v.log=function(t){var r,e,n,s,i,f,a,l,c=this,g=c.constructor,w=g.precision,m=g.rounding,b=5;if(t==null)t=new g(10),r=!0;else{if(t=new g(t),e=t.d,t.s<0||!e||!e[0]||t.eq(1))return new g(NaN);r=t.eq(10)}if(e=c.d,c.s<0||!e||!e[0]||c.eq(1))return new g(e&&!e[0]?-1/0:c.s!=1?NaN:e?0:1/0);if(r)if(e.length>1)i=!0;else{for(s=e[0];s%10===0;)s/=10;i=s!==1}if(k=!1,a=w+b,f=ce(c,a),n=r?De(g,a+10):ce(t,a),l=D(f,n,a,1),Me(l.d,s=w,m))do if(a+=10,f=ce(c,a),n=r?De(g,a+10):ce(t,a),l=D(f,n,a,1),!i){+H(l.d).slice(s+1,s+15)+1==1e14&&(l=M(l,w+1,0));break}while(Me(l.d,s+=10,m));return k=!0,M(l,w,m)};v.minus=v.sub=function(t){var r,e,n,s,i,f,a,l,c,g,w,m,b=this,O=b.constructor;if(t=new O(t),!b.d||!t.d)return!b.s||!t.s?t=new O(NaN):b.d?t.s=-t.s:t=new O(t.d||b.s!==t.s?b:NaN),t;if(b.s!=t.s)return t.s=-t.s,b.plus(t);if(c=b.d,m=t.d,a=O.precision,l=O.rounding,!c[0]||!m[0]){if(m[0])t.s=-t.s;else if(c[0])t=new O(b);else return new O(l===3?-0:0);return k?M(t,a,l):t}if(e=W(t.e/x),g=W(b.e/x),c=c.slice(),i=g-e,i){for(w=i<0,w?(r=c,i=-i,f=m.length):(r=m,e=g,f=c.length),n=Math.max(Math.ceil(a/x),f)+2,i>n&&(i=n,r.length=1),r.reverse(),n=i;n--;)r.push(0);r.reverse()}else{for(n=c.length,f=m.length,w=n<f,w&&(f=n),n=0;n<f;n++)if(c[n]!=m[n]){w=c[n]<m[n];break}i=0}for(w&&(r=c,c=m,m=r,t.s=-t.s),f=c.length,n=m.length-f;n>0;--n)c[f++]=0;for(n=m.length;n>i;){if(c[--n]<m[n]){for(s=n;s&&c[--s]===0;)c[s]=Y-1;--c[s],c[n]+=Y}c[n]-=m[n]}for(;c[--f]===0;)c.pop();for(;c[0]===0;c.shift())--e;return c[0]?(t.d=c,t.e=Te(c,e),k?M(t,a,l):t):new O(l===3?-0:0)};v.modulo=v.mod=function(t){var r,e=this,n=e.constructor;return t=new n(t),!e.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||e.d&&!e.d[0]?M(new n(e),n.precision,n.rounding):(k=!1,n.modulo==9?(r=D(e,t.abs(),0,3,1),r.s*=t.s):r=D(e,t,0,n.modulo,1),r=r.times(t),k=!0,e.minus(r))};v.naturalExponential=v.exp=function(){return it(this)};v.naturalLogarithm=v.ln=function(){return ce(this)};v.negated=v.neg=function(){var t=new this.constructor(this);return t.s=-t.s,M(t)};v.plus=v.add=function(t){var r,e,n,s,i,f,a,l,c,g,w=this,m=w.constructor;if(t=new m(t),!w.d||!t.d)return!w.s||!t.s?t=new m(NaN):w.d||(t=new m(t.d||w.s===t.s?w:NaN)),t;if(w.s!=t.s)return t.s=-t.s,w.minus(t);if(c=w.d,g=t.d,a=m.precision,l=m.rounding,!c[0]||!g[0])return g[0]||(t=new m(w)),k?M(t,a,l):t;if(i=W(w.e/x),n=W(t.e/x),c=c.slice(),s=i-n,s){for(s<0?(e=c,s=-s,f=g.length):(e=g,n=i,f=c.length),i=Math.ceil(a/x),f=i>f?i+1:f+1,s>f&&(s=f,e.length=1),e.reverse();s--;)e.push(0);e.reverse()}for(f=c.length,s=g.length,f-s<0&&(s=f,e=g,g=c,c=e),r=0;s;)r=(c[--s]=c[s]+g[s]+r)/Y|0,c[s]%=Y;for(r&&(c.unshift(r),++n),f=c.length;c[--f]==0;)c.pop();return t.d=c,t.e=Te(c,n),k?M(t,a,l):t};v.precision=v.sd=function(t){var r,e=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ue+t);return e.d?(r=Tt(e.d),t&&e.e+1>r&&(r=e.e+1)):r=NaN,r};v.round=function(){var t=this,r=t.constructor;return M(new r(t),t.e+1,r.rounding)};v.sine=v.sin=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+x,n.rounding=1,e=Rr(n,Bt(n,e)),n.precision=t,n.rounding=r,M(oe>2?e.neg():e,t,r,!0)):new n(NaN)};v.squareRoot=v.sqrt=function(){var t,r,e,n,s,i,f=this,a=f.d,l=f.e,c=f.s,g=f.constructor;if(c!==1||!a||!a[0])return new g(!c||c<0&&(!a||a[0])?NaN:a?f:1/0);for(k=!1,c=Math.sqrt(+f),c==0||c==1/0?(r=H(a),(r.length+l)%2==0&&(r+="0"),c=Math.sqrt(r),l=W((l+1)/2)-(l<0||l%2),c==1/0?r="5e"+l:(r=c.toExponential(),r=r.slice(0,r.indexOf("e")+1)+l),n=new g(r)):n=new g(c.toString()),e=(l=g.precision)+3;;)if(i=n,n=i.plus(D(f,i,e+2,1)).times(.5),H(i.d).slice(0,e)===(r=H(n.d)).slice(0,e))if(r=r.slice(e-3,e+1),r=="9999"||!s&&r=="4999"){if(!s&&(M(i,l+1,0),i.times(i).eq(f))){n=i;break}e+=4,s=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(M(n,l+1,1),t=!n.times(n).eq(f));break}return k=!0,M(n,l,g.rounding,t)};v.tangent=v.tan=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+10,n.rounding=1,e=e.sin(),e.s=1,e=D(e,new n(1).minus(e.times(e)).sqrt(),t+10,0),n.precision=t,n.rounding=r,M(oe==2||oe==4?e.neg():e,t,r,!0)):new n(NaN)};v.times=v.mul=function(t){var r,e,n,s,i,f,a,l,c,g=this,w=g.constructor,m=g.d,b=(t=new w(t)).d;if(t.s*=g.s,!m||!m[0]||!b||!b[0])return new w(!t.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?t.s/0:t.s*0);for(e=W(g.e/x)+W(t.e/x),l=m.length,c=b.length,l<c&&(i=m,m=b,b=i,f=l,l=c,c=f),i=[],f=l+c,n=f;n--;)i.push(0);for(n=c;--n>=0;){for(r=0,s=l+n;s>n;)a=i[s]+b[n]*m[s-n-1]+r,i[s--]=a%Y|0,r=a/Y|0;i[s]=(i[s]+r)%Y|0}for(;!i[--f];)i.pop();return r?++e:i.shift(),t.d=i,t.e=Te(i,e),k?M(t,w.precision,w.rounding):t};v.toBinary=function(t,r){return ot(this,2,t,r)};v.toDecimalPlaces=v.toDP=function(t,r){var e=this,n=e.constructor;return e=new n(e),t===void 0?e:(Q(t,0,pe),r===void 0?r=n.rounding:Q(r,0,8),M(e,t+e.e+1,r))};v.toExponential=function(t,r){var e,n=this,s=n.constructor;return t===void 0?e=re(n,!0):(Q(t,0,pe),r===void 0?r=s.rounding:Q(r,0,8),n=M(new s(n),t+1,r),e=re(n,!0,t+1)),n.isNeg()&&!n.isZero()?"-"+e:e};v.toFixed=function(t,r){var e,n,s=this,i=s.constructor;return t===void 0?e=re(s):(Q(t,0,pe),r===void 0?r=i.rounding:Q(r,0,8),n=M(new i(s),t+s.e+1,r),e=re(n,!1,t+n.e+1)),s.isNeg()&&!s.isZero()?"-"+e:e};v.toFraction=function(t){var r,e,n,s,i,f,a,l,c,g,w,m,b=this,O=b.d,P=b.constructor;if(!O)return new P(b);if(c=e=new P(1),n=l=new P(0),r=new P(n),i=r.e=Tt(O)-b.e-1,f=i%x,r.d[0]=U(10,f<0?x+f:f),t==null)t=i>0?r:c;else{if(a=new P(t),!a.isInt()||a.lt(c))throw Error(ue+a);t=a.gt(r)?i>0?r:c:a}for(k=!1,a=new P(H(O)),g=P.precision,P.precision=i=O.length*x*2;w=D(a,r,0,1,1),s=e.plus(w.times(n)),s.cmp(t)!=1;)e=n,n=s,s=c,c=l.plus(w.times(s)),l=s,s=r,r=a.minus(w.times(s)),a=s;return s=D(t.minus(e),n,0,1,1),l=l.plus(s.times(c)),e=e.plus(s.times(n)),l.s=c.s=b.s,m=D(c,n,i,1).minus(b).abs().cmp(D(l,e,i,1).minus(b).abs())<1?[c,n]:[l,e],P.precision=g,k=!0,m};v.toHexadecimal=v.toHex=function(t,r){return ot(this,16,t,r)};v.toNearest=function(t,r){var e=this,n=e.constructor;if(e=new n(e),t==null){if(!e.d)return e;t=new n(1),r=n.rounding}else{if(t=new n(t),r===void 0?r=n.rounding:Q(r,0,8),!e.d)return t.s?e:t;if(!t.d)return t.s&&(t.s=e.s),t}return t.d[0]?(k=!1,e=D(e,t,0,r,1).times(t),k=!0,M(e)):(t.s=e.s,e=t),e};v.toNumber=function(){return+this};v.toOctal=function(t,r){return ot(this,8,t,r)};v.toPower=v.pow=function(t){var r,e,n,s,i,f,a=this,l=a.constructor,c=+(t=new l(t));if(!a.d||!t.d||!a.d[0]||!t.d[0])return new l(U(+a,c));if(a=new l(a),a.eq(1))return a;if(n=l.precision,i=l.rounding,t.eq(1))return M(a,n,i);if(r=W(t.e/x),r>=t.d.length-1&&(e=c<0?-c:c)<=qr)return s=jt(l,a,e,n),t.s<0?new l(1).div(s):M(s,n,i);if(f=a.s,f<0){if(r<t.d.length-1)return new l(NaN);if((t.d[r]&1)==0&&(f=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=f,a}return e=U(+a,c),r=e==0||!isFinite(e)?W(c*(Math.log("0."+H(a.d))/Math.LN10+a.e+1)):new l(e+"").e,r>l.maxE+1||r<l.minE-1?new l(r>0?f/0:0):(k=!1,l.rounding=a.s=1,e=Math.min(12,(r+"").length),s=it(t.times(ce(a,n+e)),n),s.d&&(s=M(s,n+5,1),Me(s.d,n,i)&&(r=n+10,s=M(it(t.times(ce(a,r+e)),r),r+5,1),+H(s.d).slice(n+1,n+15)+1==1e14&&(s=M(s,n+1,0)))),s.s=f,k=!0,l.rounding=i,M(s,n,i))};v.toPrecision=function(t,r){var e,n=this,s=n.constructor;return t===void 0?e=re(n,n.e<=s.toExpNeg||n.e>=s.toExpPos):(Q(t,1,pe),r===void 0?r=s.rounding:Q(r,0,8),n=M(new s(n),t,r),e=re(n,t<=n.e||n.e<=s.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+e:e};v.toSignificantDigits=v.toSD=function(t,r){var e=this,n=e.constructor;return t===void 0?(t=n.precision,r=n.rounding):(Q(t,1,pe),r===void 0?r=n.rounding:Q(r,0,8)),M(new n(e),t,r)};v.toString=function(){var t=this,r=t.constructor,e=re(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()&&!t.isZero()?"-"+e:e};v.truncated=v.trunc=function(){return M(new this.constructor(this),this.e+1,1)};v.valueOf=v.toJSON=function(){var t=this,r=t.constructor,e=re(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()?"-"+e:e};function H(t){var r,e,n,s=t.length-1,i="",f=t[0];if(s>0){for(i+=f,r=1;r<s;r++)n=t[r]+"",e=x-n.length,e&&(i+=le(e)),i+=n;f=t[r],n=f+"",e=x-n.length,e&&(i+=le(e))}else if(f===0)return"0";for(;f%10===0;)f/=10;return i+f}function Q(t,r,e){if(t!==~~t||t<r||t>e)throw Error(ue+t)}function Me(t,r,e,n){var s,i,f,a;for(i=t[0];i>=10;i/=10)--r;return--r<0?(r+=x,s=0):(s=Math.ceil((r+1)/x),r%=x),i=U(10,x-r),a=t[s]%i|0,n==null?r<3?(r==0?a=a/100|0:r==1&&(a=a/10|0),f=e<4&&a==99999||e>3&&a==49999||a==5e4||a==0):f=(e<4&&a+1==i||e>3&&a+1==i/2)&&(t[s+1]/i/100|0)==U(10,r-2)-1||(a==i/2||a==0)&&(t[s+1]/i/100|0)==0:r<4?(r==0?a=a/1e3|0:r==1?a=a/100|0:r==2&&(a=a/10|0),f=(n||e<4)&&a==9999||!n&&e>3&&a==4999):f=((n||e<4)&&a+1==i||!n&&e>3&&a+1==i/2)&&(t[s+1]/i/1e3|0)==U(10,r-3)-1,f}function Le(t,r,e){for(var n,s=[0],i,f=0,a=t.length;f<a;){for(i=s.length;i--;)s[i]*=r;for(s[0]+=tt.indexOf(t.charAt(f++)),n=0;n<s.length;n++)s[n]>e-1&&(s[n+1]===void 0&&(s[n+1]=0),s[n+1]+=s[n]/e|0,s[n]%=e)}return s.reverse()}function _r(t,r){var e,n,s;if(r.isZero())return r;n=r.d.length,n<32?(e=Math.ceil(n/3),s=(1/je(4,e)).toString()):(e=16,s="2.3283064365386962890625e-10"),t.precision+=e,r=Ae(t,1,r.times(s),new t(1));for(var i=e;i--;){var f=r.times(r);r=f.times(f).minus(f).times(8).plus(1)}return t.precision-=e,r}var D=(function(){function t(n,s,i){var f,a=0,l=n.length;for(n=n.slice();l--;)f=n[l]*s+a,n[l]=f%i|0,a=f/i|0;return a&&n.unshift(a),n}function r(n,s,i,f){var a,l;if(i!=f)l=i>f?1:-1;else for(a=l=0;a<i;a++)if(n[a]!=s[a]){l=n[a]>s[a]?1:-1;break}return l}function e(n,s,i,f){for(var a=0;i--;)n[i]-=a,a=n[i]<s[i]?1:0,n[i]=a*f+n[i]-s[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,i,f,a,l){var c,g,w,m,b,O,P,Z,_,G,I,T,fe,z,we,he,ae,$e,X,de,Ee=n.constructor,ee=n.s==s.s?1:-1,B=n.d,F=s.d;if(!B||!B[0]||!F||!F[0])return new Ee(!n.s||!s.s||(B?F&&B[0]==F[0]:!F)?NaN:B&&B[0]==0||!F?ee*0:ee/0);for(l?(b=1,g=n.e-s.e):(l=Y,b=x,g=W(n.e/b)-W(s.e/b)),X=F.length,ae=B.length,_=new Ee(ee),G=_.d=[],w=0;F[w]==(B[w]||0);w++);if(F[w]>(B[w]||0)&&g--,i==null?(z=i=Ee.precision,f=Ee.rounding):a?z=i+(n.e-s.e)+1:z=i,z<0)G.push(1),O=!0;else{if(z=z/b+2|0,w=0,X==1){for(m=0,F=F[0],z++;(w<ae||m)&&z--;w++)we=m*l+(B[w]||0),G[w]=we/F|0,m=we%F|0;O=m||w<ae}else{for(m=l/(F[0]+1)|0,m>1&&(F=t(F,m,l),B=t(B,m,l),X=F.length,ae=B.length),he=X,I=B.slice(0,X),T=I.length;T<X;)I[T++]=0;de=F.slice(),de.unshift(0),$e=F[0],F[1]>=l/2&&++$e;do m=0,c=r(F,I,X,T),c<0?(fe=I[0],X!=T&&(fe=fe*l+(I[1]||0)),m=fe/$e|0,m>1?(m>=l&&(m=l-1),P=t(F,m,l),Z=P.length,T=I.length,c=r(P,I,Z,T),c==1&&(m--,e(P,X<Z?de:F,Z,l))):(m==0&&(c=m=1),P=F.slice()),Z=P.length,Z<T&&P.unshift(0),e(I,P,T,l),c==-1&&(T=I.length,c=r(F,I,X,T),c<1&&(m++,e(I,X<T?de:F,T,l))),T=I.length):c===0&&(m++,I=[0]),G[w++]=m,c&&I[0]?I[T++]=B[he]||0:(I=[B[he]],T=1);while((he++<ae||I[0]!==void 0)&&z--);O=I[0]!==void 0}G[0]||G.shift()}if(b==1)_.e=g,qt=O;else{for(w=1,m=G[0];m>=10;m/=10)w++;_.e=w+g*b-1,M(_,a?i+_.e+1:i,f,O)}return _}})();function M(t,r,e,n){var s,i,f,a,l,c,g,w,m,b=t.constructor;e:if(r!=null){if(w=t.d,!w)return t;for(s=1,a=w[0];a>=10;a/=10)s++;if(i=r-s,i<0)i+=x,f=r,g=w[m=0],l=g/U(10,s-f-1)%10|0;else if(m=Math.ceil((i+1)/x),a=w.length,m>=a)if(n){for(;a++<=m;)w.push(0);g=l=0,s=1,i%=x,f=i-x+1}else break e;else{for(g=a=w[m],s=1;a>=10;a/=10)s++;i%=x,f=i-x+s,l=f<0?0:g/U(10,s-f-1)%10|0}if(n=n||r<0||w[m+1]!==void 0||(f<0?g:g%U(10,s-f-1)),c=e<4?(l||n)&&(e==0||e==(t.s<0?3:2)):l>5||l==5&&(e==4||n||e==6&&(i>0?f>0?g/U(10,s-f):0:w[m-1])%10&1||e==(t.s<0?8:7)),r<1||!w[0])return w.length=0,c?(r-=t.e+1,w[0]=U(10,(x-r%x)%x),t.e=-r||0):w[0]=t.e=0,t;if(i==0?(w.length=m,a=1,m--):(w.length=m+1,a=U(10,x-i),w[m]=f>0?(g/U(10,s-f)%U(10,f)|0)*a:0),c)for(;;)if(m==0){for(i=1,f=w[0];f>=10;f/=10)i++;for(f=w[0]+=a,a=1;f>=10;f/=10)a++;i!=a&&(t.e++,w[0]==Y&&(w[0]=1));break}else{if(w[m]+=a,w[m]!=Y)break;w[m--]=0,a=1}for(i=w.length;w[--i]===0;)w.pop()}return k&&(t.e>b.maxE?(t.d=null,t.e=NaN):t.e<b.minE&&(t.e=0,t.d=[0])),t}function re(t,r,e){if(!t.isFinite())return Zt(t);var n,s=t.e,i=H(t.d),f=i.length;return r?(e&&(n=e-f)>0?i=i.charAt(0)+"."+i.slice(1)+le(n):f>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(t.e<0?"e":"e+")+t.e):s<0?(i="0."+le(-s-1)+i,e&&(n=e-f)>0&&(i+=le(n))):s>=f?(i+=le(s+1-f),e&&(n=e-s-1)>0&&(i=i+"."+le(n))):((n=s+1)<f&&(i=i.slice(0,n)+"."+i.slice(n)),e&&(n=e-f)>0&&(s+1===f&&(i+="."),i+=le(n))),i}function Te(t,r){var e=t[0];for(r*=x;e>=10;e/=10)r++;return r}function De(t,r,e){if(r>Ir)throw k=!0,e&&(t.precision=e),Error(It);return M(new t(Ie),r,1,!0)}function te(t,r,e){if(r>nt)throw Error(It);return M(new t(_e),r,e,!0)}function Tt(t){var r=t.length-1,e=r*x+1;if(r=t[r],r){for(;r%10==0;r/=10)e--;for(r=t[0];r>=10;r/=10)e++}return e}function le(t){for(var r="";t--;)r+="0";return r}function jt(t,r,e,n){var s,i=new t(1),f=Math.ceil(n/x+4);for(k=!1;;){if(e%2&&(i=i.times(r),kt(i.d,f)&&(s=!0)),e=W(e/2),e===0){e=i.d.length-1,s&&i.d[e]===0&&++i.d[e];break}r=r.times(r),kt(r.d,f)}return k=!0,i}function Ot(t){return t.d[t.d.length-1]&1}function Ut(t,r,e){for(var n,s,i=new t(r[0]),f=0;++f<r.length;){if(s=new t(r[f]),!s.s){i=s;break}n=i.cmp(s),(n===e||n===0&&i.s===e)&&(i=s)}return i}function it(t,r){var e,n,s,i,f,a,l,c=0,g=0,w=0,m=t.constructor,b=m.rounding,O=m.precision;if(!t.d||!t.d[0]||t.e>17)return new m(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(r==null?(k=!1,l=O):l=r,a=new m(.03125);t.e>-2;)t=t.times(a),w+=5;for(n=Math.log(U(2,w))/Math.LN10*2+5|0,l+=n,e=i=f=new m(1),m.precision=l;;){if(i=M(i.times(t),l,1),e=e.times(++g),a=f.plus(D(i,e,l,1)),H(a.d).slice(0,l)===H(f.d).slice(0,l)){for(s=w;s--;)f=M(f.times(f),l,1);if(r==null)if(c<3&&Me(f.d,l-n,b,c))m.precision=l+=10,e=i=a=new m(1),g=0,c++;else return M(f,m.precision=O,b,k=!0);else return m.precision=O,f}f=a}}function ce(t,r){var e,n,s,i,f,a,l,c,g,w,m,b=1,O=10,P=t,Z=P.d,_=P.constructor,G=_.rounding,I=_.precision;if(P.s<0||!Z||!Z[0]||!P.e&&Z[0]==1&&Z.length==1)return new _(Z&&!Z[0]?-1/0:P.s!=1?NaN:Z?0:P);if(r==null?(k=!1,g=I):g=r,_.precision=g+=O,e=H(Z),n=e.charAt(0),Math.abs(i=P.e)<15e14){for(;n<7&&n!=1||n==1&&e.charAt(1)>3;)P=P.times(t),e=H(P.d),n=e.charAt(0),b++;i=P.e,n>1?(P=new _("0."+e),i++):P=new _(n+"."+e.slice(1))}else return c=De(_,g+2,I).times(i+""),P=ce(new _(n+"."+e.slice(1)),g-O).plus(c),_.precision=I,r==null?M(P,I,G,k=!0):P;for(w=P,l=f=P=D(P.minus(1),P.plus(1),g,1),m=M(P.times(P),g,1),s=3;;){if(f=M(f.times(m),g,1),c=l.plus(D(f,new _(s),g,1)),H(c.d).slice(0,g)===H(l.d).slice(0,g))if(l=l.times(2),i!==0&&(l=l.plus(De(_,g+2,I).times(i+""))),l=D(l,new _(b),g,1),r==null)if(Me(l.d,g-O,G,a))_.precision=g+=O,c=f=P=D(w.minus(1),w.plus(1),g,1),m=M(P.times(P),g,1),s=a=1;else return M(l,_.precision=I,G,k=!0);else return _.precision=I,l;l=c,s+=2}}function Zt(t){return String(t.s*t.s/0)}function Fe(t,r){var e,n,s;for((e=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(e<0&&(e=n),e+=+r.slice(n+1),r=r.substring(0,n)):e<0&&(e=r.length),n=0;r.charCodeAt(n)===48;n++);for(s=r.length;r.charCodeAt(s-1)===48;--s);if(r=r.slice(n,s),r){if(s-=n,t.e=e=e-n-1,t.d=[],n=(e+1)%x,e<0&&(n+=x),n<s){for(n&&t.d.push(+r.slice(0,n)),s-=x;n<s;)t.d.push(+r.slice(n,n+=x));r=r.slice(n),n=x-r.length}else n-=s;for(;n--;)r+="0";t.d.push(+r),k&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function Dr(t,r){var e,n,s,i,f,a,l,c,g;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),Rt.test(r))return Fe(t,r)}else if(r==="Infinity"||r==="NaN")return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(Lr.test(r))e=16,r=r.toLowerCase();else if(kr.test(r))e=2;else if(Fr.test(r))e=8;else throw Error(ue+r);for(i=r.search(/p/i),i>0?(l=+r.slice(i+1),r=r.substring(2,i)):r=r.slice(2),i=r.indexOf("."),f=i>=0,n=t.constructor,f&&(r=r.replace(".",""),a=r.length,i=a-i,s=jt(n,new n(e),i,i*2)),c=Le(r,e,Y),g=c.length-1,i=g;c[i]===0;--i)c.pop();return i<0?new n(t.s*0):(t.e=Te(c,g),t.d=c,k=!1,f&&(t=D(t,s,a*4)),l&&(t=t.times(Math.abs(l)<54?U(2,l):L.pow(2,l))),k=!0,t)}function Rr(t,r){var e,n=r.d.length;if(n<3)return r.isZero()?r:Ae(t,2,r,r);e=1.4*Math.sqrt(n),e=e>16?16:e|0,r=r.times(1/je(5,e)),r=Ae(t,2,r,r);for(var s,i=new t(5),f=new t(16),a=new t(20);e--;)s=r.times(r),r=r.times(i.plus(s.times(f.times(s).minus(a))));return r}function Ae(t,r,e,n,s){var i,f,a,l,c=t.precision,g=Math.ceil(c/x);for(k=!1,l=e.times(e),a=new t(n);;){if(f=D(a.times(l),new t(r++*r++),c,1),a=s?n.plus(f):n.minus(f),n=D(f.times(l),new t(r++*r++),c,1),f=a.plus(n),f.d[g]!==void 0){for(i=g;f.d[i]===a.d[i]&&i--;);if(i==-1)break}i=a,a=n,n=f,f=i}return k=!0,f.d.length=g+1,f}function je(t,r){for(var e=t;--r;)e*=t;return e}function Bt(t,r){var e,n=r.s<0,s=te(t,t.precision,1),i=s.times(.5);if(r=r.abs(),r.lte(i))return oe=n?4:1,r;if(e=r.divToInt(s),e.isZero())oe=n?3:2;else{if(r=r.minus(e.times(s)),r.lte(i))return oe=Ot(e)?n?2:3:n?4:1,r;oe=Ot(e)?n?1:4:n?3:2}return r.minus(s).abs()}function ot(t,r,e,n){var s,i,f,a,l,c,g,w,m,b=t.constructor,O=e!==void 0;if(O?(Q(e,1,pe),n===void 0?n=b.rounding:Q(n,0,8)):(e=b.precision,n=b.rounding),!t.isFinite())g=Zt(t);else{for(g=re(t),f=g.indexOf("."),O?(s=2,r==16?e=e*4-3:r==8&&(e=e*3-2)):s=r,f>=0&&(g=g.replace(".",""),m=new b(1),m.e=g.length-f,m.d=Le(re(m),10,s),m.e=m.d.length),w=Le(g,10,s),i=l=w.length;w[--l]==0;)w.pop();if(!w[0])g=O?"0p+0":"0";else{if(f<0?i--:(t=new b(t),t.d=w,t.e=i,t=D(t,m,e,n,0,s),w=t.d,i=t.e,c=qt),f=w[e],a=s/2,c=c||w[e+1]!==void 0,c=n<4?(f!==void 0||c)&&(n===0||n===(t.s<0?3:2)):f>a||f===a&&(n===4||c||n===6&&w[e-1]&1||n===(t.s<0?8:7)),w.length=e,c)for(;++w[--e]>s-1;)w[e]=0,e||(++i,w.unshift(1));for(l=w.length;!w[l-1];--l);for(f=0,g="";f<l;f++)g+=tt.charAt(w[f]);if(O){if(l>1)if(r==16||r==8){for(f=r==16?4:3,--l;l%f;l++)g+="0";for(w=Le(g,s,r),l=w.length;!w[l-1];--l);for(f=1,g="1.";f<l;f++)g+=tt.charAt(w[f])}else g=g.charAt(0)+"."+g.slice(1);g=g+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)g="0"+g;g="0."+g}else if(++i>l)for(i-=l;i--;)g+="0";else i<l&&(g=g.slice(0,i)+"."+g.slice(i))}g=(r==16?"0x":r==2?"0b":r==8?"0o":"")+g}return t.s<0?"-"+g:g}function kt(t,r){if(t.length>r)return t.length=r,!0}function Tr(t){return new this(t).abs()}function jr(t){return new this(t).acos()}function Ur(t){return new this(t).acosh()}function Zr(t,r){return new this(t).plus(r)}function Br(t){return new this(t).asin()}function Vr(t){return new this(t).asinh()}function Hr(t){return new this(t).atan()}function Wr(t){return new this(t).atanh()}function Gr(t,r){t=new this(t),r=new this(r);var e,n=this.precision,s=this.rounding,i=n+4;return!t.s||!r.s?e=new this(NaN):!t.d&&!r.d?(e=te(this,i,1).times(r.s>0?.25:.75),e.s=t.s):!r.d||t.isZero()?(e=r.s<0?te(this,n,s):new this(0),e.s=t.s):!t.d||r.isZero()?(e=te(this,i,1).times(.5),e.s=t.s):r.s<0?(this.precision=i,this.rounding=1,e=this.atan(D(t,r,i,1)),r=te(this,i,1),this.precision=n,this.rounding=s,e=t.s<0?e.minus(r):e.plus(r)):e=this.atan(D(t,r,i,1)),e}function Xr(t){return new this(t).cbrt()}function zr(t){return M(t=new this(t),t.e+1,2)}function Qr(t,r,e){return new this(t).clamp(r,e)}function Jr(t){if(!t||typeof t!="object")throw Error(Re+"Object expected");var r,e,n,s=t.defaults===!0,i=["precision",1,pe,"rounding",0,8,"toExpNeg",-Ne,0,"toExpPos",0,Ne,"maxE",0,Ne,"minE",-Ne,0,"modulo",0,9];for(r=0;r<i.length;r+=3)if(e=i[r],s&&(this[e]=rt[e]),(n=t[e])!==void 0)if(W(n)===n&&n>=i[r+1]&&n<=i[r+2])this[e]=n;else throw Error(ue+e+": "+n);if(e="crypto",s&&(this[e]=rt[e]),(n=t[e])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(_t);else this[e]=!1;else throw Error(ue+e+": "+n);return this}function Kr(t){return new this(t).cos()}function Yr(t){return new this(t).cosh()}function Vt(t){var r,e,n;function s(i){var f,a,l,c=this;if(!(c instanceof s))return new s(i);if(c.constructor=s,Lt(i)){c.s=i.s,k?!i.d||i.e>s.maxE?(c.e=NaN,c.d=null):i.e<s.minE?(c.e=0,c.d=[0]):(c.e=i.e,c.d=i.d.slice()):(c.e=i.e,c.d=i.d?i.d.slice():i.d);return}if(l=typeof i,l==="number"){if(i===0){c.s=1/i<0?-1:1,c.e=0,c.d=[0];return}if(i<0?(i=-i,c.s=-1):c.s=1,i===~~i&&i<1e7){for(f=0,a=i;a>=10;a/=10)f++;k?f>s.maxE?(c.e=NaN,c.d=null):f<s.minE?(c.e=0,c.d=[0]):(c.e=f,c.d=[i]):(c.e=f,c.d=[i]);return}if(i*0!==0){i||(c.s=NaN),c.e=NaN,c.d=null;return}return Fe(c,i.toString())}if(l==="string")return(a=i.charCodeAt(0))===45?(i=i.slice(1),c.s=-1):(a===43&&(i=i.slice(1)),c.s=1),Rt.test(i)?Fe(c,i):Dr(c,i);if(l==="bigint")return i<0?(i=-i,c.s=-1):c.s=1,Fe(c,i.toString());throw Error(ue+i)}if(s.prototype=v,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=Jr,s.clone=Vt,s.isDecimal=Lt,s.abs=Tr,s.acos=jr,s.acosh=Ur,s.add=Zr,s.asin=Br,s.asinh=Vr,s.atan=Hr,s.atanh=Wr,s.atan2=Gr,s.cbrt=Xr,s.ceil=zr,s.clamp=Qr,s.cos=Kr,s.cosh=Yr,s.div=en,s.exp=tn,s.floor=rn,s.hypot=nn,s.ln=sn,s.log=on,s.log10=an,s.log2=fn,s.max=ln,s.min=cn,s.mod=un,s.mul=pn,s.pow=hn,s.random=dn,s.round=gn,s.sign=mn,s.sin=wn,s.sinh=$n,s.sqrt=En,s.sub=vn,s.sum=bn,s.tan=Nn,s.tanh=An,s.trunc=yn,t===void 0&&(t={}),t&&t.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)t.hasOwnProperty(e=n[r++])||(t[e]=this[e]);return s.config(t),s}function en(t,r){return new this(t).div(r)}function tn(t){return new this(t).exp()}function rn(t){return M(t=new this(t),t.e+1,3)}function nn(){var t,r,e=new this(0);for(k=!1,t=0;t<arguments.length;)if(r=new this(arguments[t++]),r.d)e.d&&(e=e.plus(r.times(r)));else{if(r.s)return k=!0,new this(1/0);e=r}return k=!0,e.sqrt()}function Lt(t){return t instanceof L||t&&t.toStringTag===Dt||!1}function sn(t){return new this(t).ln()}function on(t,r){return new this(t).log(r)}function fn(t){return new this(t).log(2)}function an(t){return new this(t).log(10)}function ln(){return Ut(this,arguments,-1)}function cn(){return Ut(this,arguments,1)}function un(t,r){return new this(t).mod(r)}function pn(t,r){return new this(t).mul(r)}function hn(t,r){return new this(t).pow(r)}function dn(t){var r,e,n,s,i=0,f=new this(1),a=[];if(t===void 0?t=this.precision:Q(t,1,pe),n=Math.ceil(t/x),this.crypto)if(crypto.getRandomValues)for(r=crypto.getRandomValues(new Uint32Array(n));i<n;)s=r[i],s>=429e7?r[i]=crypto.getRandomValues(new Uint32Array(1))[0]:a[i++]=s%1e7;else if(crypto.randomBytes){for(r=crypto.randomBytes(n*=4);i<n;)s=r[i]+(r[i+1]<<8)+(r[i+2]<<16)+((r[i+3]&127)<<24),s>=214e7?crypto.randomBytes(4).copy(r,i):(a.push(s%1e7),i+=4);i=n/4}else throw Error(_t);else for(;i<n;)a[i++]=Math.random()*1e7|0;for(n=a[--i],t%=x,n&&t&&(s=U(10,x-t),a[i]=(n/s|0)*s);a[i]===0;i--)a.pop();if(i<0)e=0,a=[0];else{for(e=-1;a[0]===0;e-=x)a.shift();for(n=1,s=a[0];s>=10;s/=10)n++;n<x&&(e-=x-n)}return f.e=e,f.d=a,f}function gn(t){return M(t=new this(t),t.e+1,this.rounding)}function mn(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function wn(t){return new this(t).sin()}function $n(t){return new this(t).sinh()}function En(t){return new this(t).sqrt()}function vn(t,r){return new this(t).sub(r)}function bn(){var t=0,r=arguments,e=new this(r[t]);for(k=!1;e.s&&++t<r.length;)e=e.plus(r[t]);return k=!0,M(e,this.precision,this.rounding)}function Nn(t){return new this(t).tan()}function An(t){return new this(t).tanh()}function yn(t){return M(t=new this(t),t.e+1,1)}v[Symbol.for("nodejs.util.inspect.custom")]=v.toString;v[Symbol.toStringTag]="Decimal";var L=v.constructor=Vt(rt);Ie=new L(Ie);_e=new L(_e);class Ft extends SyntaxError{constructor(r,e,n,s){super(r),this.expected=e,this.found=n,this.location=s,this.name="SyntaxError"}format(r){let e="Error: "+this.message;if(this.location){let n=null;const s=r.find(l=>l.source===this.location.source);s&&(n=s.text.split(/\r\n|\n|\r/g));const i=this.location.start,f=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(i):i,a=this.location.source+":"+f.line+":"+f.column;if(n){const l=this.location.end,c="".padEnd(f.line.toString().length," "),g=n[i.line-1],m=(i.line===l.line?l.column:g.length+1)-i.column||1;e+=`
 --> `+a+`
`+c+` |
`+f.line+" | "+g+`
`+c+" | "+"".padEnd(i.column-1," ")+"".padEnd(m,"^")}else e+=`
 at `+a}return e}static buildMessage(r,e){function n(m){return m.codePointAt(0).toString(16).toUpperCase()}const s=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function i(m){return s?m.replace(s,b=>"\\u{"+n(b)+"}"):m}function f(m){return i(m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,b=>"\\x0"+n(b)).replace(/[\x10-\x1F\x7F-\x9F]/g,b=>"\\x"+n(b)))}function a(m){return i(m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,b=>"\\x0"+n(b)).replace(/[\x10-\x1F\x7F-\x9F]/g,b=>"\\x"+n(b)))}const l={literal(m){return'"'+f(m.text)+'"'},class(m){const b=m.parts.map(O=>Array.isArray(O)?a(O[0])+"-"+a(O[1]):a(O));return"["+(m.inverted?"^":"")+b.join("")+"]"+(m.unicode?"u":"")},any(){return"any character"},end(){return"end of input"},other(m){return m.description}};function c(m){return l[m.type](m)}function g(m){const b=m.map(c);if(b.sort(),b.length>0){let O=1;for(let P=1;P<b.length;P++)b[P-1]!==b[P]&&(b[O]=b[P],O++);b.length=O}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}function w(m){return m?'"'+f(m)+'"':"end of input"}return"Expected "+g(r)+" but "+w(e)+" found."}}function Ht(t,r){r=r!==void 0?r:{};const e={},n=r.grammarSource,s={Expression:J};let i=J;const f="?",a=":",l="||",c="??",g="&&",w="!=",m="==",b="=",O="<=",P=">=",Z="**",_="(",G=")",I="[",T="]",fe=".",z=",",we="true",he="false",ae="null",$e=/^[<>]/,X=/^[+\-]/,de=/^[%*\/]/,Ee=/^[!+\-]/,ee=/^[0-9]/,B=/^[eE]/,F=/^[a-zA-Z0-9_$]/,Wt=/^[a-zA-Z_$]/,at=/^[ \t\n\r]/,Gt=j("?",!1),Xt=j(":",!1),lt=j("||",!1),ct=j("??",!1),ut=j("&&",!1),pt=j("!=",!1),ht=j("==",!1),dt=j("=",!1),gt=j("<=",!1),mt=j(">=",!1),wt=ne(["<",">"],!1,!1,!1),Ze=ne(["+","-"],!1,!1,!1),$t=ne(["%","*","/"],!1,!1,!1),zt=j("**",!1),Qt=ne(["!","+","-"],!1,!1,!1),Be=j("(",!1),Ve=j(")",!1),He=j("[",!1),We=j("]",!1),Ge=j(".",!1),Pe=j(",",!1),ve=ne([["0","9"]],!1,!1,!1),Jt=ne(["e","E"],!1,!1,!1),Kt=j("true",!1),ye=ne([["a","z"],["A","Z"],["0","9"],"_","$"],!1,!1,!1),Yt=j("false",!1),er=j("null",!1),tr=ne([["a","z"],["A","Z"],"_","$"],!1,!1,!1),Et=ne([" ","	",`
`,"\r"],!1,!1,!1);function _n(p){return p}function rr(p,h,E){return{type:"ConditionalExpression",test:p,consequent:h,alternate:E}}function nr(p,h){return h.reduce((E,u)=>({type:"LogicalExpression",operator:u[1],left:E,right:u[3]}),p)}function ir(p,h){return h.reduce((E,u)=>({type:"LogicalExpression",operator:u[1],left:E,right:u[3]}),p)}function sr(p,h){return ke(p,h)}function or(p,h){return ke(p,h)}function fr(p,h){return ke(p,h)}function ar(p,h){return ke(p,h)}function lr(p,h){return h?{type:"BinaryExpression",operator:"**",left:p,right:h[3]}:p}function cr(p,h){return{type:"UnaryExpression",operator:p,argument:h,prefix:!0}}function vt(p,h){return{type:"call",args:h||[]}}function bt(p,h){return{type:"member",property:h,computed:!0}}function Nt(p,h){return{type:"member",property:h,computed:!1}}function ur(p,h){return h.reduce((E,u)=>u.type==="call"?{type:"CallExpression",callee:E,arguments:u.args}:{type:"MemberExpression",object:E,property:u.property,computed:u.computed},p)}function pr(p,h){return[p].concat(h.map(E=>E[3]))}function Dn(p){return p}function hr(p){return{type:"Literal",value:parseFloat(p),raw:p}}function dr(){return{type:"Literal",value:!0,raw:"true"}}function gr(){return{type:"Literal",value:!1,raw:"false"}}function mr(){return{type:"Literal",value:null,raw:"null"}}function wr(p){return{type:"ArrayExpression",elements:p||[]}}function $r(p,h){return[p].concat(h.map(E=>E[3]))}function Er(p){return{type:"Identifier",name:p}}let o=r.peg$currPos|0;const be=[{line:1,column:1}];let K=o,xe=r.peg$maxFailExpected||[],N=r.peg$silentFails|0,Ce;if(r.startRule){if(!(r.startRule in s))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');i=s[r.startRule]}function vr(p=o){const h=t.codePointAt(p);return h===void 0?"":String.fromCodePoint(h)}function j(p,h){return{type:"literal",text:p,ignoreCase:h}}function ne(p,h,E,u){return{type:"class",parts:p,inverted:h,ignoreCase:E,unicode:u}}function br(){return{type:"end"}}function At(p){let h=be[p],E;if(h)return h;if(p>=be.length)E=be.length-1;else for(E=p;!be[--E];);for(h=be[E],h={line:h.line,column:h.column};E<p;)t.charCodeAt(E)===10?(h.line++,h.column=1):h.column++,E++;return be[p]=h,h}function yt(p,h,E){const u=At(p),$=At(h);return{source:n,start:{offset:p,line:u.line,column:u.column},end:{offset:h,line:$.line,column:$.column}}}function C(p){o<K||(o>K&&(K=o,xe=[]),xe.push(p))}function Nr(p,h,E){return new Ft(Ft.buildMessage(p,h),p,h,E)}function J(){let p,h;return p=o,S(),h=Ct(),h!==e?(S(),p=h):(o=p,p=e),p}function Ct(){let p,h,E,u,$,d;return p=o,h=St(),h!==e?(S(),t.charCodeAt(o)===63?(E=f,o++):(E=e,N===0&&C(Gt)),E!==e?(S(),u=J(),u!==e?(S(),t.charCodeAt(o)===58?($=a,o++):($=e,N===0&&C(Xt)),$!==e?(S(),d=Ct(),d!==e?p=rr(h,u,d):(o=p,p=e)):(o=p,p=e)):(o=p,p=e)):(o=p,p=e)):(o=p,p=e),p===e&&(p=St()),p}function St(){let p,h,E,u,$,d,y,A;if(p=o,h=Xe(),h!==e){for(E=[],u=o,$=S(),t.substr(o,2)===l?(d=l,o+=2):(d=e,N===0&&C(lt)),d===e&&(t.substr(o,2)===c?(d=c,o+=2):(d=e,N===0&&C(ct))),d!==e?(y=S(),A=Xe(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),t.substr(o,2)===l?(d=l,o+=2):(d=e,N===0&&C(lt)),d===e&&(t.substr(o,2)===c?(d=c,o+=2):(d=e,N===0&&C(ct))),d!==e?(y=S(),A=Xe(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=nr(h,E)}else o=p,p=e;return p}function Xe(){let p,h,E,u,$,d,y,A;if(p=o,h=ze(),h!==e){for(E=[],u=o,$=S(),t.substr(o,2)===g?(d=g,o+=2):(d=e,N===0&&C(ut)),d!==e?(y=S(),A=ze(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),t.substr(o,2)===g?(d=g,o+=2):(d=e,N===0&&C(ut)),d!==e?(y=S(),A=ze(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=ir(h,E)}else o=p,p=e;return p}function ze(){let p,h,E,u,$,d,y,A;if(p=o,h=Qe(),h!==e){for(E=[],u=o,$=S(),t.substr(o,2)===w?(d=w,o+=2):(d=e,N===0&&C(pt)),d===e&&(t.substr(o,2)===m?(d=m,o+=2):(d=e,N===0&&C(ht)),d===e&&(t.charCodeAt(o)===61?(d=b,o++):(d=e,N===0&&C(dt)))),d!==e?(y=S(),A=Qe(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),t.substr(o,2)===w?(d=w,o+=2):(d=e,N===0&&C(pt)),d===e&&(t.substr(o,2)===m?(d=m,o+=2):(d=e,N===0&&C(ht)),d===e&&(t.charCodeAt(o)===61?(d=b,o++):(d=e,N===0&&C(dt)))),d!==e?(y=S(),A=Qe(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=sr(h,E)}else o=p,p=e;return p}function Qe(){let p,h,E,u,$,d,y,A;if(p=o,h=Je(),h!==e){for(E=[],u=o,$=S(),t.substr(o,2)===O?(d=O,o+=2):(d=e,N===0&&C(gt)),d===e&&(t.substr(o,2)===P?(d=P,o+=2):(d=e,N===0&&C(mt)),d===e&&(d=t.charAt(o),$e.test(d)?o++:(d=e,N===0&&C(wt)))),d!==e?(y=S(),A=Je(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),t.substr(o,2)===O?(d=O,o+=2):(d=e,N===0&&C(gt)),d===e&&(t.substr(o,2)===P?(d=P,o+=2):(d=e,N===0&&C(mt)),d===e&&(d=t.charAt(o),$e.test(d)?o++:(d=e,N===0&&C(wt)))),d!==e?(y=S(),A=Je(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=or(h,E)}else o=p,p=e;return p}function Je(){let p,h,E,u,$,d,y,A;if(p=o,h=Ke(),h!==e){for(E=[],u=o,$=S(),d=t.charAt(o),X.test(d)?o++:(d=e,N===0&&C(Ze)),d!==e?(y=S(),A=Ke(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),d=t.charAt(o),X.test(d)?o++:(d=e,N===0&&C(Ze)),d!==e?(y=S(),A=Ke(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=fr(h,E)}else o=p,p=e;return p}function Ke(){let p,h,E,u,$,d,y,A;if(p=o,h=Oe(),h!==e){for(E=[],u=o,$=S(),d=t.charAt(o),de.test(d)?o++:(d=e,N===0&&C($t)),d!==e?(y=S(),A=Oe(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),d=t.charAt(o),de.test(d)?o++:(d=e,N===0&&C($t)),d!==e?(y=S(),A=Oe(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=ar(h,E)}else o=p,p=e;return p}function Oe(){let p,h,E,u,$,d,y;return p=o,h=Mt(),h!==e?(E=o,u=S(),t.substr(o,2)===Z?($=Z,o+=2):($=e,N===0&&C(zt)),$!==e?(d=S(),y=Oe(),y!==e?(u=[u,$,d,y],E=u):(o=E,E=e)):(o=E,E=e),E===e&&(E=null),p=lr(h,E)):(o=p,p=e),p}function Mt(){let p,h,E;return p=o,h=t.charAt(o),Ee.test(h)?o++:(h=e,N===0&&C(Qt)),h!==e?(S(),E=Mt(),E!==e?p=cr(h,E):(o=p,p=e)):(o=p,p=e),p===e&&(p=Ar()),p}function Ar(){let p,h,E,u,$,d,y;if(p=o,h=yr(),h!==e){for(E=[],u=o,S(),t.charCodeAt(o)===40?($=_,o++):($=e,N===0&&C(Be)),$!==e?(S(),d=Pt(),d===e&&(d=null),S(),t.charCodeAt(o)===41?(y=G,o++):(y=e,N===0&&C(Ve)),y!==e?u=vt(h,d):(o=u,u=e)):(o=u,u=e),u===e&&(u=o,S(),t.charCodeAt(o)===91?($=I,o++):($=e,N===0&&C(He)),$!==e?(S(),d=J(),d!==e?(S(),t.charCodeAt(o)===93?(y=T,o++):(y=e,N===0&&C(We)),y!==e?u=bt(h,d):(o=u,u=e)):(o=u,u=e)):(o=u,u=e),u===e&&(u=o,S(),t.charCodeAt(o)===46?($=fe,o++):($=e,N===0&&C(Ge)),$!==e?(S(),d=Ye(),d!==e?u=Nt(h,d):(o=u,u=e)):(o=u,u=e)));u!==e;)E.push(u),u=o,S(),t.charCodeAt(o)===40?($=_,o++):($=e,N===0&&C(Be)),$!==e?(S(),d=Pt(),d===e&&(d=null),S(),t.charCodeAt(o)===41?(y=G,o++):(y=e,N===0&&C(Ve)),y!==e?u=vt(h,d):(o=u,u=e)):(o=u,u=e),u===e&&(u=o,S(),t.charCodeAt(o)===91?($=I,o++):($=e,N===0&&C(He)),$!==e?(S(),d=J(),d!==e?(S(),t.charCodeAt(o)===93?(y=T,o++):(y=e,N===0&&C(We)),y!==e?u=bt(h,d):(o=u,u=e)):(o=u,u=e)):(o=u,u=e),u===e&&(u=o,S(),t.charCodeAt(o)===46?($=fe,o++):($=e,N===0&&C(Ge)),$!==e?(S(),d=Ye(),d!==e?u=Nt(h,d):(o=u,u=e)):(o=u,u=e)));p=ur(h,E)}else o=p,p=e;return p}function Pt(){let p,h,E,u,$,d,y,A;if(p=o,h=J(),h!==e){for(E=[],u=o,$=S(),t.charCodeAt(o)===44?(d=z,o++):(d=e,N===0&&C(Pe)),d!==e?(y=S(),A=J(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),t.charCodeAt(o)===44?(d=z,o++):(d=e,N===0&&C(Pe)),d!==e?(y=S(),A=J(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=pr(h,E)}else o=p,p=e;return p}function yr(){let p,h,E,u;return p=Cr(),p===e&&(p=xr(),p===e&&(p=Ye(),p===e&&(p=o,t.charCodeAt(o)===40?(h=_,o++):(h=e,N===0&&C(Be)),h!==e?(S(),E=J(),E!==e?(S(),t.charCodeAt(o)===41?(u=G,o++):(u=e,N===0&&C(Ve)),u!==e?p=E:(o=p,p=e)):(o=p,p=e)):(o=p,p=e)))),p}function Cr(){let p;return p=Sr(),p===e&&(p=Mr(),p===e&&(p=Pr())),p}function Sr(){let p,h,E,u,$,d,y,A,Se,ie;if(p=o,h=o,E=o,u=[],$=t.charAt(o),ee.test($)?o++:($=e,N===0&&C(ve)),$!==e)for(;$!==e;)u.push($),$=t.charAt(o),ee.test($)?o++:($=e,N===0&&C(ve));else u=e;if(u!==e){if($=o,t.charCodeAt(o)===46?(d=fe,o++):(d=e,N===0&&C(Ge)),d!==e){if(y=[],A=t.charAt(o),ee.test(A)?o++:(A=e,N===0&&C(ve)),A!==e)for(;A!==e;)y.push(A),A=t.charAt(o),ee.test(A)?o++:(A=e,N===0&&C(ve));else y=e;y!==e?(d=[d,y],$=d):(o=$,$=e)}else o=$,$=e;if($===e&&($=null),d=o,y=t.charAt(o),B.test(y)?o++:(y=e,N===0&&C(Jt)),y!==e){if(A=t.charAt(o),X.test(A)?o++:(A=e,N===0&&C(Ze)),A===e&&(A=null),Se=[],ie=t.charAt(o),ee.test(ie)?o++:(ie=e,N===0&&C(ve)),ie!==e)for(;ie!==e;)Se.push(ie),ie=t.charAt(o),ee.test(ie)?o++:(ie=e,N===0&&C(ve));else Se=e;Se!==e?(y=[y,A,Se],d=y):(o=d,d=e)}else o=d,d=e;d===e&&(d=null),u=[u,$,d],E=u}else o=E,E=e;return E!==e?h=t.substring(h,o):h=E,h!==e&&(h=hr(h)),p=h,p}function Mr(){let p,h,E,u;return p=o,t.substr(o,4)===we?(h=we,o+=4):(h=e,N===0&&C(Kt)),h!==e?(E=o,N++,u=t.charAt(o),F.test(u)?o++:(u=e,N===0&&C(ye)),N--,u===e?E=void 0:(o=E,E=e),E!==e?p=dr():(o=p,p=e)):(o=p,p=e),p===e&&(p=o,t.substr(o,5)===he?(h=he,o+=5):(h=e,N===0&&C(Yt)),h!==e?(E=o,N++,u=t.charAt(o),F.test(u)?o++:(u=e,N===0&&C(ye)),N--,u===e?E=void 0:(o=E,E=e),E!==e?p=gr():(o=p,p=e)):(o=p,p=e)),p}function Pr(){let p,h,E,u;return p=o,t.substr(o,4)===ae?(h=ae,o+=4):(h=e,N===0&&C(er)),h!==e?(E=o,N++,u=t.charAt(o),F.test(u)?o++:(u=e,N===0&&C(ye)),N--,u===e?E=void 0:(o=E,E=e),E!==e?p=mr():(o=p,p=e)):(o=p,p=e),p}function xr(){let p,h,E,u;return p=o,t.charCodeAt(o)===91?(h=I,o++):(h=e,N===0&&C(He)),h!==e?(S(),E=Or(),E===e&&(E=null),S(),t.charCodeAt(o)===93?(u=T,o++):(u=e,N===0&&C(We)),u!==e?p=wr(E):(o=p,p=e)):(o=p,p=e),p}function Or(){let p,h,E,u,$,d,y,A;if(p=o,h=J(),h!==e){for(E=[],u=o,$=S(),t.charCodeAt(o)===44?(d=z,o++):(d=e,N===0&&C(Pe)),d!==e?(y=S(),A=J(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);u!==e;)E.push(u),u=o,$=S(),t.charCodeAt(o)===44?(d=z,o++):(d=e,N===0&&C(Pe)),d!==e?(y=S(),A=J(),A!==e?($=[$,d,y,A],u=$):(o=u,u=e)):(o=u,u=e);p=$r(h,E)}else o=p,p=e;return p}function Ye(){let p,h,E,u,$,d;if(p=o,h=o,E=o,u=t.charAt(o),Wt.test(u)?o++:(u=e,N===0&&C(tr)),u!==e){for($=[],d=t.charAt(o),F.test(d)?o++:(d=e,N===0&&C(ye));d!==e;)$.push(d),d=t.charAt(o),F.test(d)?o++:(d=e,N===0&&C(ye));u=[u,$],E=u}else o=E,E=e;return E!==e?h=t.substring(h,o):h=E,h!==e&&(h=Er(h)),p=h,p}function S(){let p,h;for(N++,p=[],h=t.charAt(o),at.test(h)?o++:(h=e,N===0&&C(Et));h!==e;)p.push(h),h=t.charAt(o),at.test(h)?o++:(h=e,N===0&&C(Et));return N--,p}function ke(p,h){return h.reduce((E,u)=>({type:"BinaryExpression",operator:u[1],left:E,right:u[3]}),p)}Ce=i();const et=Ce!==e&&o===t.length;function xt(){throw Ce!==e&&o<t.length&&C(br()),Nr(xe,K<t.length?vr(K):null,K<t.length?yt(K,K+1):yt(K,K))}if(r.peg$library)return{peg$result:Ce,peg$currPos:o,peg$FAILED:e,peg$maxFailExpected:xe,peg$maxFailPos:K,peg$success:et,peg$throw:et?void 0:xt};if(et)return Ce;xt()}const Cn=t=>{const r=new Set,e=n=>{if(!(!n||typeof n!="object"))switch(n.type){case"Identifier":r.add(n.name);break;case"MemberExpression":e(n.object),n.computed&&e(n.property);break;case"BinaryExpression":case"LogicalExpression":e(n.left),e(n.right);break;case"UnaryExpression":e(n.argument);break;case"CallExpression":if(e(n.callee),n.arguments)for(const s of n.arguments)e(s);break;case"ConditionalExpression":e(n.test),e(n.consequent),e(n.alternate);break;case"ArrayExpression":if(n.elements)for(const s of n.elements)e(s);break;case"ObjectExpression":if(n.properties)for(const s of n.properties)s.type==="Property"?(s.computed&&e(s.key),e(s.value)):s.type==="SpreadElement"&&e(s.argument);break}};return e(t),Array.from(r).filter(n=>!n.startsWith("$"))};class me extends Error{constructor(r){super(r),this.name="EvallaError",Object.setPrototypeOf(this,me.prototype)}}class Ue extends me{constructor(r,e){super(r),this.name="SecurityError",this.property=e,Object.setPrototypeOf(this,Ue.prototype)}}class ft extends me{constructor(r,e){super(r),this.name="CircularDependencyError",this.cycle=e,Object.setPrototypeOf(this,ft.prototype)}}class se extends me{constructor(r,e){super(r),this.name="ValidationError",this.variableName=e,Object.setPrototypeOf(this,se.prototype)}}class R extends me{constructor(r,e){super(r),this.name="EvaluationError",this.variableName=e,Object.setPrototypeOf(this,R.prototype)}}class ge extends R{constructor(r,e){super(r,e?.variableName),this.name="ParseError",this.expression=e?.expression,this.line=e?.line,this.column=e?.column,Object.setPrototypeOf(this,ge.prototype)}}const Sn=t=>{try{return Ht(t.trim())}catch(r){if(r.location){const{line:e,column:n}=r.location.start;throw new ge(`Parse error at line ${e}, column ${n}: ${r.message}`,{line:e,column:n,expression:t})}throw new ge(`Parse error: ${r.message}`,{expression:t})}},Mn=t=>Cn(t),Pn=t=>{const r=new Map,e=new Set,n=new Map;for(const l of t)if(e.add(l.name),l.expr)try{const c=Sn(l.expr);n.set(l.name,c)}catch(c){throw c instanceof ge?new ge(`Failed to parse expression for "${l.name}": ${c.message}`,{variableName:l.name,expression:l.expr,line:c.line,column:c.column}):new ge(`Failed to parse expression for "${l.name}": ${c instanceof Error?c.message:String(c)}`,{variableName:l.name,expression:l.expr})}for(const l of t){if(!l.expr){r.set(l.name,[]);continue}const c=n.get(l.name);if(!c)throw new R(`No AST found for: ${l.name}`);const w=Mn(c).filter(m=>e.has(m));r.set(l.name,w)}const s=new Set,i=new Set,f=[],a=(l,c=[])=>{if(s.has(l))return;if(i.has(l)){const w=[...c,l];throw new ft(`Circular dependency detected: ${w.join(" -> ")}`,w)}i.add(l);const g=r.get(l)||[];for(const w of g)e.has(w)&&a(w,[...c,l]);i.delete(l),s.add(l),f.push(l)};for(const l of e)a(l);return{order:f,asts:n}},q=t=>t instanceof L?t:new L(t),qe=Symbol("NAMESPACE_HEAD"),st=t=>t!=null&&typeof t=="object"&&t[qe]===!0,xn=()=>{const t=Object.create(null);return t.$math=Object.create(null),t.$math[qe]=!0,t.$math.PI=new L(-1).acos(),t.$math.E=new L(1).exp(),t.$math.SQRT2=new L(2).sqrt(),t.$math.SQRT1_2=new L(.5).sqrt(),t.$math.LN2=new L(2).ln(),t.$math.LN10=new L(10).ln(),t.$math.LOG2E=t.$math.E.log(2),t.$math.LOG10E=t.$math.E.log(10),t.$math.abs=r=>q(r).abs(),t.$math.sqrt=r=>q(r).sqrt(),t.$math.cbrt=r=>q(r).cbrt(),t.$math.floor=r=>q(r).floor(),t.$math.ceil=r=>q(r).ceil(),t.$math.round=r=>q(r).round(),t.$math.trunc=r=>q(r).trunc(),t.$math.sin=r=>new L(Math.sin(q(r).toNumber())),t.$math.cos=r=>new L(Math.cos(q(r).toNumber())),t.$math.tan=r=>new L(Math.tan(q(r).toNumber())),t.$math.asin=r=>new L(Math.asin(q(r).toNumber())),t.$math.acos=r=>new L(Math.acos(q(r).toNumber())),t.$math.atan=r=>new L(Math.atan(q(r).toNumber())),t.$math.atan2=(r,e)=>new L(Math.atan2(q(r).toNumber(),q(e).toNumber())),t.$math.exp=r=>q(r).exp(),t.$math.ln=r=>q(r).ln(),t.$math.log=r=>q(r).log(),t.$math.log10=r=>q(r).log(10),t.$math.log2=r=>q(r).log(2),t.$math.pow=(r,e)=>q(r).pow(q(e)),t.$math.min=(...r)=>L.min(...r.map(q)),t.$math.max=(...r)=>L.max(...r.map(q)),t.$unit=Object.create(null),t.$unit[qe]=!0,t.$unit.mmToInch=r=>q(r).div(25.4),t.$unit.inchToMm=r=>q(r).mul(25.4),t.$unit.cmToInch=r=>q(r).div(2.54),t.$unit.inchToCm=r=>q(r).mul(2.54),t.$unit.mToFt=r=>q(r).mul(3.28084),t.$unit.ftToM=r=>q(r).div(3.28084),t.$angle=Object.create(null),t.$angle[qe]=!0,t.$angle.toRad=r=>q(r).mul(t.$math.PI).div(180),t.$angle.toDeg=r=>q(r).mul(180).div(t.$math.PI),t},On=new Set(["prototype","__proto__","constructor"]),kn=t=>!(On.has(t)||t.startsWith("__")),V=async(t,r)=>{switch(t.type){case"Literal":return typeof t.value=="number"?new L(t.raw||t.value):t.value;case"Identifier":if(!(t.name in r))throw new R(`Undefined variable: ${t.name}`);return r[t.name];case"MemberExpression":const e=await V(t.object,r);if(e==null)throw new R(`Cannot access property of ${e}`);let n;if(t.computed){const b=await V(t.property,r);n=String(b)}else n=t.property.name;if(!kn(n))throw new Ue(`Access to property "${n}" is not allowed for security reasons`,n);return e[n];case"BinaryExpression":const s=await V(t.left,r),i=await V(t.right,r);return Ln(t.operator,s,i);case"UnaryExpression":const f=await V(t.argument,r);return Fn(t.operator,f);case"CallExpression":const a=await V(t.callee,r),l=[];for(const b of t.arguments)l.push(await V(b,r));if(typeof a!="function")throw new R("Callee is not a function");let c=null;return t.callee.type==="MemberExpression"&&(c=await V(t.callee.object,r)),a.apply(c,l);case"ConditionalExpression":return await V(t.test,r)?await V(t.consequent,r):await V(t.alternate,r);case"LogicalExpression":const w=await V(t.left,r);if(t.operator==="&&")return w&&await V(t.right,r);if(t.operator==="||")return w||await V(t.right,r);if(t.operator==="??")return w??await V(t.right,r);throw new R(`Unsupported logical operator: ${t.operator}`);case"ArrayExpression":const m=[];for(const b of t.elements)m.push(await V(b,r));return m;default:throw new R(`Unsupported node type: ${t.type}`)}},Ln=(t,r,e)=>{if(st(r)||st(e))throw new R("Cannot use namespace head in operations - namespace heads must be used with property access (e.g., $math.PI) or method calls (e.g., $math.abs(x))");const n=["+","-","*","/","%","**"],s=["<",">","<=",">="];if(n.includes(t)||s.includes(t)){if(typeof r=="string")throw new R(`Cannot use string in ${t} operation - strings are not supported in mathematical expressions`);if(typeof r=="object"&&r!==null&&!(r instanceof L)&&!Array.isArray(r))throw new R(`Cannot use object in ${t} operation - only numeric values are allowed`);if(Array.isArray(r))throw new R(`Cannot use array in ${t} operation - only numeric values are allowed`);if(typeof e=="string")throw new R(`Cannot use string in ${t} operation - strings are not supported in mathematical expressions`);if(typeof e=="object"&&e!==null&&!(e instanceof L)&&!Array.isArray(e))throw new R(`Cannot use object in ${t} operation - only numeric values are allowed`);if(Array.isArray(e))throw new R(`Cannot use array in ${t} operation - only numeric values are allowed`)}if(t==="=="||t==="="||t==="!="){if(r instanceof L&&e instanceof L){const a=r.eq(e);return t==="!="?!a:a}if(typeof r=="boolean"||r===null||typeof e=="boolean"||e===null){const a=r===e;return t==="!="?!a:a}const f=r==e;return t==="!="?!f:f}const i=f=>f instanceof L?f:new L(f);switch(t){case"+":return i(r).plus(i(e));case"-":return i(r).minus(i(e));case"*":return i(r).times(i(e));case"/":return i(r).div(i(e));case"%":return i(r).mod(i(e));case"**":return i(r).pow(i(e));case"<":return i(r).lt(i(e));case">":return i(r).gt(i(e));case"<=":return i(r).lte(i(e));case">=":return i(r).gte(i(e));default:throw new R(`Unsupported binary operator: ${t}`)}},Fn=(t,r)=>{switch(t){case"-":case"+":if(typeof r=="string")throw new R(`Cannot use string with unary ${t} - strings are not supported in mathematical expressions`);if(typeof r=="object"&&r!==null&&!(r instanceof L)&&!Array.isArray(r))throw new R(`Cannot use object with unary ${t} - only numeric values are allowed`);if(Array.isArray(r))throw new R(`Cannot use array with unary ${t} - only numeric values are allowed`);return t==="-"?r instanceof L?r.neg():-r:r instanceof L?r:+r;case"!":return!r;default:throw new R(`Unsupported unary operator: ${t}`)}},qn=async(t,r)=>{try{const e=xn(),n=Object.create(null);for(const[i,f]of Object.entries(r))n[i]=f;for(const[i,f]of Object.entries(e))n[i]=f;const s=await V(t,n);if(st(s))throw new R("Cannot use namespace head as a value - namespace heads must be used with property access (e.g., $math.PI) or method calls (e.g., $math.abs(x))");if(typeof s=="function")throw new Ue("Cannot alias functions - functions must be called with parentheses");return s instanceof L?s:typeof s=="number"?new L(s):typeof s=="string"&&!isNaN(Number(s))?new L(s):s}catch(e){throw e instanceof me?e:new Error(`Failed to evaluate expression: ${e instanceof Error?e.message:String(e)}`)}},In=t=>typeof t!="string"?{valid:!1,error:"Variable name must be a string"}:t===""?{valid:!1,error:"Variable name cannot be empty"}:t.startsWith("$")?{valid:!1,error:"Variable names cannot start with $ (reserved for system namespaces)"}:t.startsWith("__")?{valid:!1,error:"Variable names cannot start with __ (reserved for security reasons)"}:["true","false","null","Infinity"].includes(t)?{valid:!1,error:`Variable name cannot be a reserved value: ${t}`}:/^\d/.test(t)?{valid:!1,error:"Variable names cannot start with a number"}:t.includes(".")?{valid:!1,error:"Variable names cannot contain dots (dots are only for property access in expressions)"}:/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(t)?{valid:!0}:{valid:!1,error:"Variable name contains invalid characters (only letters, digits, underscore, or $ allowed)"},Rn=t=>{if(typeof t!="string")return{valid:!1,error:"Expression must be a string"};const r=t.trim();if(r==="")return{valid:!1,error:"Expression cannot be empty"};try{return Ht(r),{valid:!0}}catch(e){if(e.location){const{line:n,column:s}=e.location.start;return{valid:!1,error:`Parse error at line ${n}, column ${s}: ${e.message}`,line:n,column:s}}return{valid:!1,error:`Parse error: ${e.message||String(e)}`}}},Tn=async t=>{if(!Array.isArray(t))throw new se("Input must be an array");for(const a of t){if(!a||typeof a!="object")throw new se("Each input must be an object");if(typeof a.name!="string"||!a.name)throw new se('Each input must have a non-empty string "name"');const l=In(a.name);if(!l.valid)throw new se(`${l.error}: ${a.name}`,a.name);if(!a.expr&&a.value===void 0)throw new se(`Each input must have either "expr" or "value": ${a.name}`,a.name);if(a.expr!==void 0&&typeof a.expr!="string")throw new se(`"expr" must be a string if provided: ${a.name}`,a.name)}const r=new Set;for(const a of t){if(r.has(a.name))throw new se(`Duplicate name: ${a.name}`,a.name);r.add(a.name)}const{order:e,asts:n}=Pn(t),s=new Map;for(const a of t)a.value!==void 0&&s.set(a.name,a.value);const i=Object.create(null),f=Object.create(null);for(const a of e){let l;if(s.has(a))l=s.get(a);else{const c=n.get(a);if(!c)throw new Error(`No expression or value found for: ${a}`);l=await qn(c,f)}l instanceof L||typeof l=="boolean"||l===null?(i[a]=l,f[a]=l):(f[a]=l,typeof l=="number"&&(i[a]=new L(l)))}return{values:i,order:e}};export{ft as CircularDependencyError,L as Decimal,me as EvallaError,R as EvaluationError,ge as ParseError,Ue as SecurityError,se as ValidationError,Rn as checkSyntax,In as checkVariableName,Tn as evalla};
