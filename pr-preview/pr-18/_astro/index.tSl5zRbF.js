/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var Ne=9e15,pe=1e9,tt="0123456789abcdef",Ie="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",_e="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",rt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ne,maxE:Ne,crypto:!1},Ut,ie,k=!0,De="[DecimalError] ",ue=De+"Invalid argument: ",Zt=De+"Precision limit exceeded",Bt=De+"crypto unavailable",Vt="[object Decimal]",W=Math.floor,U=Math.pow,Rr=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Tr=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Ur=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ht=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,K=1e7,P=7,Zr=9007199254740991,Br=Ie.length-1,nt=_e.length-1,E={toStringTag:Vt};E.absoluteValue=E.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),S(t)};E.ceil=function(){return S(new this.constructor(this),this.e+1,2)};E.clampedTo=E.clamp=function(t,r){var e,n=this,i=n.constructor;if(t=new i(t),r=new i(r),!t.s||!r.s)return new i(NaN);if(t.gt(r))throw Error(ue+r);return e=n.cmp(t),e<0?t:n.cmp(r)>0?r:new i(n)};E.comparedTo=E.cmp=function(t){var r,e,n,i,s=this,f=s.d,a=(t=new s.constructor(t)).d,c=s.s,u=t.s;if(!f||!a)return!c||!u?NaN:c!==u?c:f===a?0:!f^c<0?1:-1;if(!f[0]||!a[0])return f[0]?c:a[0]?-u:0;if(c!==u)return c;if(s.e!==t.e)return s.e>t.e^c<0?1:-1;for(n=f.length,i=a.length,r=0,e=n<i?n:i;r<e;++r)if(f[r]!==a[r])return f[r]>a[r]^c<0?1:-1;return n===i?0:n>i^c<0?1:-1};E.cosine=E.cos=function(){var t,r,e=this,n=e.constructor;return e.d?e.d[0]?(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+P,n.rounding=1,e=Vr(n,Qt(n,e)),n.precision=t,n.rounding=r,S(ie==2||ie==3?e.neg():e,t,r,!0)):new n(1):new n(NaN)};E.cubeRoot=E.cbrt=function(){var t,r,e,n,i,s,f,a,c,u,d=this,w=d.constructor;if(!d.isFinite()||d.isZero())return new w(d);for(k=!1,s=d.s*U(d.s*d,1/3),!s||Math.abs(s)==1/0?(e=V(d.d),t=d.e,(s=(t-e.length+1)%3)&&(e+=s==1||s==-2?"0":"00"),s=U(e,1/3),t=W((t+1)/3)-(t%3==(t<0?-1:2)),s==1/0?e="5e"+t:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new w(e),n.s=d.s):n=new w(s.toString()),f=(t=w.precision)+3;;)if(a=n,c=a.times(a).times(a),u=c.plus(d),n=j(u.plus(d).times(a),u.plus(c),f+2,1),V(a.d).slice(0,f)===(e=V(n.d)).slice(0,f))if(e=e.slice(f-3,f+1),e=="9999"||!i&&e=="4999"){if(!i&&(S(a,t+1,0),a.times(a).times(a).eq(d))){n=a;break}f+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(S(n,t+1,1),r=!n.times(n).times(n).eq(d));break}return k=!0,S(n,t,w.rounding,r)};E.decimalPlaces=E.dp=function(){var t,r=this.d,e=NaN;if(r){if(t=r.length-1,e=(t-W(this.e/P))*P,t=r[t],t)for(;t%10==0;t/=10)e--;e<0&&(e=0)}return e};E.dividedBy=E.div=function(t){return j(this,new this.constructor(t))};E.dividedToIntegerBy=E.divToInt=function(t){var r=this,e=r.constructor;return S(j(r,new e(t),0,1,1),e.precision,e.rounding)};E.equals=E.eq=function(t){return this.cmp(t)===0};E.floor=function(){return S(new this.constructor(this),this.e+1,3)};E.greaterThan=E.gt=function(t){return this.cmp(t)>0};E.greaterThanOrEqualTo=E.gte=function(t){var r=this.cmp(t);return r==1||r===0};E.hyperbolicCosine=E.cosh=function(){var t,r,e,n,i,s=this,f=s.constructor,a=new f(1);if(!s.isFinite())return new f(s.s?1/0:NaN);if(s.isZero())return a;e=f.precision,n=f.rounding,f.precision=e+Math.max(s.e,s.sd())+4,f.rounding=1,i=s.d.length,i<32?(t=Math.ceil(i/3),r=(1/Te(4,t)).toString()):(t=16,r="2.3283064365386962890625e-10"),s=ye(f,1,s.times(r),new f(1),!0);for(var c,u=t,d=new f(8);u--;)c=s.times(s),s=a.minus(c.times(d.minus(c.times(d))));return S(s,f.precision=e,f.rounding=n,!0)};E.hyperbolicSine=E.sinh=function(){var t,r,e,n,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(r=s.precision,e=s.rounding,s.precision=r+Math.max(i.e,i.sd())+4,s.rounding=1,n=i.d.length,n<3)i=ye(s,2,i,i,!0);else{t=1.4*Math.sqrt(n),t=t>16?16:t|0,i=i.times(1/Te(5,t)),i=ye(s,2,i,i,!0);for(var f,a=new s(5),c=new s(16),u=new s(20);t--;)f=i.times(i),i=i.times(a.plus(f.times(c.times(f).plus(u))))}return s.precision=r,s.rounding=e,S(i,r,e,!0)};E.hyperbolicTangent=E.tanh=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+7,n.rounding=1,j(e.sinh(),e.cosh(),n.precision=t,n.rounding=r)):new n(e.s)};E.inverseCosine=E.acos=function(){var t=this,r=t.constructor,e=t.abs().cmp(1),n=r.precision,i=r.rounding;return e!==-1?e===0?t.isNeg()?Y(r,n,i):new r(0):new r(NaN):t.isZero()?Y(r,n+4,i).times(.5):(r.precision=n+6,r.rounding=1,t=new r(1).minus(t).div(t.plus(1)).sqrt().atan(),r.precision=n,r.rounding=i,t.times(2))};E.inverseHyperbolicCosine=E.acosh=function(){var t,r,e=this,n=e.constructor;return e.lte(1)?new n(e.eq(1)?0:NaN):e.isFinite()?(t=n.precision,r=n.rounding,n.precision=t+Math.max(Math.abs(e.e),e.sd())+4,n.rounding=1,k=!1,e=e.times(e).minus(1).sqrt().plus(e),k=!0,n.precision=t,n.rounding=r,e.ln()):new n(e)};E.inverseHyperbolicSine=E.asinh=function(){var t,r,e=this,n=e.constructor;return!e.isFinite()||e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+2*Math.max(Math.abs(e.e),e.sd())+6,n.rounding=1,k=!1,e=e.times(e).plus(1).sqrt().plus(e),k=!0,n.precision=t,n.rounding=r,e.ln())};E.inverseHyperbolicTangent=E.atanh=function(){var t,r,e,n,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=s.precision,r=s.rounding,n=i.sd(),Math.max(n,t)<2*-i.e-1?S(new s(i),t,r,!0):(s.precision=e=n-i.e,i=j(i.plus(1),new s(1).minus(i),e+t,1),s.precision=t+4,s.rounding=1,i=i.ln(),s.precision=t,s.rounding=r,i.times(.5))):new s(NaN)};E.inverseSine=E.asin=function(){var t,r,e,n,i=this,s=i.constructor;return i.isZero()?new s(i):(r=i.abs().cmp(1),e=s.precision,n=s.rounding,r!==-1?r===0?(t=Y(s,e+4,n).times(.5),t.s=i.s,t):new s(NaN):(s.precision=e+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=e,s.rounding=n,i.times(2)))};E.inverseTangent=E.atan=function(){var t,r,e,n,i,s,f,a,c,u=this,d=u.constructor,w=d.precision,m=d.rounding;if(u.isFinite()){if(u.isZero())return new d(u);if(u.abs().eq(1)&&w+4<=nt)return f=Y(d,w+4,m).times(.25),f.s=u.s,f}else{if(!u.s)return new d(NaN);if(w+4<=nt)return f=Y(d,w+4,m).times(.5),f.s=u.s,f}for(d.precision=a=w+10,d.rounding=1,e=Math.min(28,a/P+2|0),t=e;t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(k=!1,r=Math.ceil(a/P),n=1,c=u.times(u),f=new d(u),i=u;t!==-1;)if(i=i.times(c),s=f.minus(i.div(n+=2)),i=i.times(c),f=s.plus(i.div(n+=2)),f.d[r]!==void 0)for(t=r;f.d[t]===s.d[t]&&t--;);return e&&(f=f.times(2<<e-1)),k=!0,S(f,d.precision=w,d.rounding=m,!0)};E.isFinite=function(){return!!this.d};E.isInteger=E.isInt=function(){return!!this.d&&W(this.e/P)>this.d.length-2};E.isNaN=function(){return!this.s};E.isNegative=E.isNeg=function(){return this.s<0};E.isPositive=E.isPos=function(){return this.s>0};E.isZero=function(){return!!this.d&&this.d[0]===0};E.lessThan=E.lt=function(t){return this.cmp(t)<0};E.lessThanOrEqualTo=E.lte=function(t){return this.cmp(t)<1};E.logarithm=E.log=function(t){var r,e,n,i,s,f,a,c,u=this,d=u.constructor,w=d.precision,m=d.rounding,b=5;if(t==null)t=new d(10),r=!0;else{if(t=new d(t),e=t.d,t.s<0||!e||!e[0]||t.eq(1))return new d(NaN);r=t.eq(10)}if(e=u.d,u.s<0||!e||!e[0]||u.eq(1))return new d(e&&!e[0]?-1/0:u.s!=1?NaN:e?0:1/0);if(r)if(e.length>1)s=!0;else{for(i=e[0];i%10===0;)i/=10;s=i!==1}if(k=!1,a=w+b,f=ce(u,a),n=r?je(d,a+10):ce(t,a),c=j(f,n,a,1),xe(c.d,i=w,m))do if(a+=10,f=ce(u,a),n=r?je(d,a+10):ce(t,a),c=j(f,n,a,1),!s){+V(c.d).slice(i+1,i+15)+1==1e14&&(c=S(c,w+1,0));break}while(xe(c.d,i+=10,m));return k=!0,S(c,w,m)};E.minus=E.sub=function(t){var r,e,n,i,s,f,a,c,u,d,w,m,b=this,O=b.constructor;if(t=new O(t),!b.d||!t.d)return!b.s||!t.s?t=new O(NaN):b.d?t.s=-t.s:t=new O(t.d||b.s!==t.s?b:NaN),t;if(b.s!=t.s)return t.s=-t.s,b.plus(t);if(u=b.d,m=t.d,a=O.precision,c=O.rounding,!u[0]||!m[0]){if(m[0])t.s=-t.s;else if(u[0])t=new O(b);else return new O(c===3?-0:0);return k?S(t,a,c):t}if(e=W(t.e/P),d=W(b.e/P),u=u.slice(),s=d-e,s){for(w=s<0,w?(r=u,s=-s,f=m.length):(r=m,e=d,f=u.length),n=Math.max(Math.ceil(a/P),f)+2,s>n&&(s=n,r.length=1),r.reverse(),n=s;n--;)r.push(0);r.reverse()}else{for(n=u.length,f=m.length,w=n<f,w&&(f=n),n=0;n<f;n++)if(u[n]!=m[n]){w=u[n]<m[n];break}s=0}for(w&&(r=u,u=m,m=r,t.s=-t.s),f=u.length,n=m.length-f;n>0;--n)u[f++]=0;for(n=m.length;n>s;){if(u[--n]<m[n]){for(i=n;i&&u[--i]===0;)u[i]=K-1;--u[i],u[n]+=K}u[n]-=m[n]}for(;u[--f]===0;)u.pop();for(;u[0]===0;u.shift())--e;return u[0]?(t.d=u,t.e=Re(u,e),k?S(t,a,c):t):new O(c===3?-0:0)};E.modulo=E.mod=function(t){var r,e=this,n=e.constructor;return t=new n(t),!e.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||e.d&&!e.d[0]?S(new n(e),n.precision,n.rounding):(k=!1,n.modulo==9?(r=j(e,t.abs(),0,3,1),r.s*=t.s):r=j(e,t,0,n.modulo,1),r=r.times(t),k=!0,e.minus(r))};E.naturalExponential=E.exp=function(){return it(this)};E.naturalLogarithm=E.ln=function(){return ce(this)};E.negated=E.neg=function(){var t=new this.constructor(this);return t.s=-t.s,S(t)};E.plus=E.add=function(t){var r,e,n,i,s,f,a,c,u,d,w=this,m=w.constructor;if(t=new m(t),!w.d||!t.d)return!w.s||!t.s?t=new m(NaN):w.d||(t=new m(t.d||w.s===t.s?w:NaN)),t;if(w.s!=t.s)return t.s=-t.s,w.minus(t);if(u=w.d,d=t.d,a=m.precision,c=m.rounding,!u[0]||!d[0])return d[0]||(t=new m(w)),k?S(t,a,c):t;if(s=W(w.e/P),n=W(t.e/P),u=u.slice(),i=s-n,i){for(i<0?(e=u,i=-i,f=d.length):(e=d,n=s,f=u.length),s=Math.ceil(a/P),f=s>f?s+1:f+1,i>f&&(i=f,e.length=1),e.reverse();i--;)e.push(0);e.reverse()}for(f=u.length,i=d.length,f-i<0&&(i=f,e=d,d=u,u=e),r=0;i;)r=(u[--i]=u[i]+d[i]+r)/K|0,u[i]%=K;for(r&&(u.unshift(r),++n),f=u.length;u[--f]==0;)u.pop();return t.d=u,t.e=Re(u,n),k?S(t,a,c):t};E.precision=E.sd=function(t){var r,e=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ue+t);return e.d?(r=Wt(e.d),t&&e.e+1>r&&(r=e.e+1)):r=NaN,r};E.round=function(){var t=this,r=t.constructor;return S(new r(t),t.e+1,r.rounding)};E.sine=E.sin=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+P,n.rounding=1,e=Wr(n,Qt(n,e)),n.precision=t,n.rounding=r,S(ie>2?e.neg():e,t,r,!0)):new n(NaN)};E.squareRoot=E.sqrt=function(){var t,r,e,n,i,s,f=this,a=f.d,c=f.e,u=f.s,d=f.constructor;if(u!==1||!a||!a[0])return new d(!u||u<0&&(!a||a[0])?NaN:a?f:1/0);for(k=!1,u=Math.sqrt(+f),u==0||u==1/0?(r=V(a),(r.length+c)%2==0&&(r+="0"),u=Math.sqrt(r),c=W((c+1)/2)-(c<0||c%2),u==1/0?r="5e"+c:(r=u.toExponential(),r=r.slice(0,r.indexOf("e")+1)+c),n=new d(r)):n=new d(u.toString()),e=(c=d.precision)+3;;)if(s=n,n=s.plus(j(f,s,e+2,1)).times(.5),V(s.d).slice(0,e)===(r=V(n.d)).slice(0,e))if(r=r.slice(e-3,e+1),r=="9999"||!i&&r=="4999"){if(!i&&(S(s,c+1,0),s.times(s).eq(f))){n=s;break}e+=4,i=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(S(n,c+1,1),t=!n.times(n).eq(f));break}return k=!0,S(n,c,d.rounding,t)};E.tangent=E.tan=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+10,n.rounding=1,e=e.sin(),e.s=1,e=j(e,new n(1).minus(e.times(e)).sqrt(),t+10,0),n.precision=t,n.rounding=r,S(ie==2||ie==4?e.neg():e,t,r,!0)):new n(NaN)};E.times=E.mul=function(t){var r,e,n,i,s,f,a,c,u,d=this,w=d.constructor,m=d.d,b=(t=new w(t)).d;if(t.s*=d.s,!m||!m[0]||!b||!b[0])return new w(!t.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?t.s/0:t.s*0);for(e=W(d.e/P)+W(t.e/P),c=m.length,u=b.length,c<u&&(s=m,m=b,b=s,f=c,c=u,u=f),s=[],f=c+u,n=f;n--;)s.push(0);for(n=u;--n>=0;){for(r=0,i=c+n;i>n;)a=s[i]+b[n]*m[i-n-1]+r,s[i--]=a%K|0,r=a/K|0;s[i]=(s[i]+r)%K|0}for(;!s[--f];)s.pop();return r?++e:s.shift(),t.d=s,t.e=Re(s,e),k?S(t,w.precision,w.rounding):t};E.toBinary=function(t,r){return ot(this,2,t,r)};E.toDecimalPlaces=E.toDP=function(t,r){var e=this,n=e.constructor;return e=new n(e),t===void 0?e:(z(t,0,pe),r===void 0?r=n.rounding:z(r,0,8),S(e,t+e.e+1,r))};E.toExponential=function(t,r){var e,n=this,i=n.constructor;return t===void 0?e=ee(n,!0):(z(t,0,pe),r===void 0?r=i.rounding:z(r,0,8),n=S(new i(n),t+1,r),e=ee(n,!0,t+1)),n.isNeg()&&!n.isZero()?"-"+e:e};E.toFixed=function(t,r){var e,n,i=this,s=i.constructor;return t===void 0?e=ee(i):(z(t,0,pe),r===void 0?r=s.rounding:z(r,0,8),n=S(new s(i),t+i.e+1,r),e=ee(n,!1,t+n.e+1)),i.isNeg()&&!i.isZero()?"-"+e:e};E.toFraction=function(t){var r,e,n,i,s,f,a,c,u,d,w,m,b=this,O=b.d,M=b.constructor;if(!O)return new M(b);if(u=e=new M(1),n=c=new M(0),r=new M(n),s=r.e=Wt(O)-b.e-1,f=s%P,r.d[0]=U(10,f<0?P+f:f),t==null)t=s>0?r:u;else{if(a=new M(t),!a.isInt()||a.lt(u))throw Error(ue+a);t=a.gt(r)?s>0?r:u:a}for(k=!1,a=new M(V(O)),d=M.precision,M.precision=s=O.length*P*2;w=j(a,r,0,1,1),i=e.plus(w.times(n)),i.cmp(t)!=1;)e=n,n=i,i=u,u=c.plus(w.times(i)),c=i,i=r,r=a.minus(w.times(i)),a=i;return i=j(t.minus(e),n,0,1,1),c=c.plus(i.times(u)),e=e.plus(i.times(n)),c.s=u.s=b.s,m=j(u,n,s,1).minus(b).abs().cmp(j(c,e,s,1).minus(b).abs())<1?[u,n]:[c,e],M.precision=d,k=!0,m};E.toHexadecimal=E.toHex=function(t,r){return ot(this,16,t,r)};E.toNearest=function(t,r){var e=this,n=e.constructor;if(e=new n(e),t==null){if(!e.d)return e;t=new n(1),r=n.rounding}else{if(t=new n(t),r===void 0?r=n.rounding:z(r,0,8),!e.d)return t.s?e:t;if(!t.d)return t.s&&(t.s=e.s),t}return t.d[0]?(k=!1,e=j(e,t,0,r,1).times(t),k=!0,S(e)):(t.s=e.s,e=t),e};E.toNumber=function(){return+this};E.toOctal=function(t,r){return ot(this,8,t,r)};E.toPower=E.pow=function(t){var r,e,n,i,s,f,a=this,c=a.constructor,u=+(t=new c(t));if(!a.d||!t.d||!a.d[0]||!t.d[0])return new c(U(+a,u));if(a=new c(a),a.eq(1))return a;if(n=c.precision,s=c.rounding,t.eq(1))return S(a,n,s);if(r=W(t.e/P),r>=t.d.length-1&&(e=u<0?-u:u)<=Zr)return i=Gt(c,a,e,n),t.s<0?new c(1).div(i):S(i,n,s);if(f=a.s,f<0){if(r<t.d.length-1)return new c(NaN);if((t.d[r]&1)==0&&(f=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=f,a}return e=U(+a,u),r=e==0||!isFinite(e)?W(u*(Math.log("0."+V(a.d))/Math.LN10+a.e+1)):new c(e+"").e,r>c.maxE+1||r<c.minE-1?new c(r>0?f/0:0):(k=!1,c.rounding=a.s=1,e=Math.min(12,(r+"").length),i=it(t.times(ce(a,n+e)),n),i.d&&(i=S(i,n+5,1),xe(i.d,n,s)&&(r=n+10,i=S(it(t.times(ce(a,r+e)),r),r+5,1),+V(i.d).slice(n+1,n+15)+1==1e14&&(i=S(i,n+1,0)))),i.s=f,k=!0,c.rounding=s,S(i,n,s))};E.toPrecision=function(t,r){var e,n=this,i=n.constructor;return t===void 0?e=ee(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(z(t,1,pe),r===void 0?r=i.rounding:z(r,0,8),n=S(new i(n),t,r),e=ee(n,t<=n.e||n.e<=i.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+e:e};E.toSignificantDigits=E.toSD=function(t,r){var e=this,n=e.constructor;return t===void 0?(t=n.precision,r=n.rounding):(z(t,1,pe),r===void 0?r=n.rounding:z(r,0,8)),S(new n(e),t,r)};E.toString=function(){var t=this,r=t.constructor,e=ee(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()&&!t.isZero()?"-"+e:e};E.truncated=E.trunc=function(){return S(new this.constructor(this),this.e+1,1)};E.valueOf=E.toJSON=function(){var t=this,r=t.constructor,e=ee(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()?"-"+e:e};function V(t){var r,e,n,i=t.length-1,s="",f=t[0];if(i>0){for(s+=f,r=1;r<i;r++)n=t[r]+"",e=P-n.length,e&&(s+=le(e)),s+=n;f=t[r],n=f+"",e=P-n.length,e&&(s+=le(e))}else if(f===0)return"0";for(;f%10===0;)f/=10;return s+f}function z(t,r,e){if(t!==~~t||t<r||t>e)throw Error(ue+t)}function xe(t,r,e,n){var i,s,f,a;for(s=t[0];s>=10;s/=10)--r;return--r<0?(r+=P,i=0):(i=Math.ceil((r+1)/P),r%=P),s=U(10,P-r),a=t[i]%s|0,n==null?r<3?(r==0?a=a/100|0:r==1&&(a=a/10|0),f=e<4&&a==99999||e>3&&a==49999||a==5e4||a==0):f=(e<4&&a+1==s||e>3&&a+1==s/2)&&(t[i+1]/s/100|0)==U(10,r-2)-1||(a==s/2||a==0)&&(t[i+1]/s/100|0)==0:r<4?(r==0?a=a/1e3|0:r==1?a=a/100|0:r==2&&(a=a/10|0),f=(n||e<4)&&a==9999||!n&&e>3&&a==4999):f=((n||e<4)&&a+1==s||!n&&e>3&&a+1==s/2)&&(t[i+1]/s/1e3|0)==U(10,r-3)-1,f}function Le(t,r,e){for(var n,i=[0],s,f=0,a=t.length;f<a;){for(s=i.length;s--;)i[s]*=r;for(i[0]+=tt.indexOf(t.charAt(f++)),n=0;n<i.length;n++)i[n]>e-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/e|0,i[n]%=e)}return i.reverse()}function Vr(t,r){var e,n,i;if(r.isZero())return r;n=r.d.length,n<32?(e=Math.ceil(n/3),i=(1/Te(4,e)).toString()):(e=16,i="2.3283064365386962890625e-10"),t.precision+=e,r=ye(t,1,r.times(i),new t(1));for(var s=e;s--;){var f=r.times(r);r=f.times(f).minus(f).times(8).plus(1)}return t.precision-=e,r}var j=(function(){function t(n,i,s){var f,a=0,c=n.length;for(n=n.slice();c--;)f=n[c]*i+a,n[c]=f%s|0,a=f/s|0;return a&&n.unshift(a),n}function r(n,i,s,f){var a,c;if(s!=f)c=s>f?1:-1;else for(a=c=0;a<s;a++)if(n[a]!=i[a]){c=n[a]>i[a]?1:-1;break}return c}function e(n,i,s,f){for(var a=0;s--;)n[s]-=a,a=n[s]<i[s]?1:0,n[s]=a*f+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,f,a,c){var u,d,w,m,b,O,M,Z,_,G,I,T,se,Q,he,de,oe,$e,X,ge,fe=n.constructor,ve=n.s==i.s?1:-1,B=n.d,F=i.d;if(!B||!B[0]||!F||!F[0])return new fe(!n.s||!i.s||(B?F&&B[0]==F[0]:!F)?NaN:B&&B[0]==0||!F?ve*0:ve/0);for(c?(b=1,d=n.e-i.e):(c=K,b=P,d=W(n.e/b)-W(i.e/b)),X=F.length,oe=B.length,_=new fe(ve),G=_.d=[],w=0;F[w]==(B[w]||0);w++);if(F[w]>(B[w]||0)&&d--,s==null?(Q=s=fe.precision,f=fe.rounding):a?Q=s+(n.e-i.e)+1:Q=s,Q<0)G.push(1),O=!0;else{if(Q=Q/b+2|0,w=0,X==1){for(m=0,F=F[0],Q++;(w<oe||m)&&Q--;w++)he=m*c+(B[w]||0),G[w]=he/F|0,m=he%F|0;O=m||w<oe}else{for(m=c/(F[0]+1)|0,m>1&&(F=t(F,m,c),B=t(B,m,c),X=F.length,oe=B.length),de=X,I=B.slice(0,X),T=I.length;T<X;)I[T++]=0;ge=F.slice(),ge.unshift(0),$e=F[0],F[1]>=c/2&&++$e;do m=0,u=r(F,I,X,T),u<0?(se=I[0],X!=T&&(se=se*c+(I[1]||0)),m=se/$e|0,m>1?(m>=c&&(m=c-1),M=t(F,m,c),Z=M.length,T=I.length,u=r(M,I,Z,T),u==1&&(m--,e(M,X<Z?ge:F,Z,c))):(m==0&&(u=m=1),M=F.slice()),Z=M.length,Z<T&&M.unshift(0),e(I,M,T,c),u==-1&&(T=I.length,u=r(F,I,X,T),u<1&&(m++,e(I,X<T?ge:F,T,c))),T=I.length):u===0&&(m++,I=[0]),G[w++]=m,u&&I[0]?I[T++]=B[de]||0:(I=[B[de]],T=1);while((de++<oe||I[0]!==void 0)&&Q--);O=I[0]!==void 0}G[0]||G.shift()}if(b==1)_.e=d,Ut=O;else{for(w=1,m=G[0];m>=10;m/=10)w++;_.e=w+d*b-1,S(_,a?s+_.e+1:s,f,O)}return _}})();function S(t,r,e,n){var i,s,f,a,c,u,d,w,m,b=t.constructor;e:if(r!=null){if(w=t.d,!w)return t;for(i=1,a=w[0];a>=10;a/=10)i++;if(s=r-i,s<0)s+=P,f=r,d=w[m=0],c=d/U(10,i-f-1)%10|0;else if(m=Math.ceil((s+1)/P),a=w.length,m>=a)if(n){for(;a++<=m;)w.push(0);d=c=0,i=1,s%=P,f=s-P+1}else break e;else{for(d=a=w[m],i=1;a>=10;a/=10)i++;s%=P,f=s-P+i,c=f<0?0:d/U(10,i-f-1)%10|0}if(n=n||r<0||w[m+1]!==void 0||(f<0?d:d%U(10,i-f-1)),u=e<4?(c||n)&&(e==0||e==(t.s<0?3:2)):c>5||c==5&&(e==4||n||e==6&&(s>0?f>0?d/U(10,i-f):0:w[m-1])%10&1||e==(t.s<0?8:7)),r<1||!w[0])return w.length=0,u?(r-=t.e+1,w[0]=U(10,(P-r%P)%P),t.e=-r||0):w[0]=t.e=0,t;if(s==0?(w.length=m,a=1,m--):(w.length=m+1,a=U(10,P-s),w[m]=f>0?(d/U(10,i-f)%U(10,f)|0)*a:0),u)for(;;)if(m==0){for(s=1,f=w[0];f>=10;f/=10)s++;for(f=w[0]+=a,a=1;f>=10;f/=10)a++;s!=a&&(t.e++,w[0]==K&&(w[0]=1));break}else{if(w[m]+=a,w[m]!=K)break;w[m--]=0,a=1}for(s=w.length;w[--s]===0;)w.pop()}return k&&(t.e>b.maxE?(t.d=null,t.e=NaN):t.e<b.minE&&(t.e=0,t.d=[0])),t}function ee(t,r,e){if(!t.isFinite())return zt(t);var n,i=t.e,s=V(t.d),f=s.length;return r?(e&&(n=e-f)>0?s=s.charAt(0)+"."+s.slice(1)+le(n):f>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(t.e<0?"e":"e+")+t.e):i<0?(s="0."+le(-i-1)+s,e&&(n=e-f)>0&&(s+=le(n))):i>=f?(s+=le(i+1-f),e&&(n=e-i-1)>0&&(s=s+"."+le(n))):((n=i+1)<f&&(s=s.slice(0,n)+"."+s.slice(n)),e&&(n=e-f)>0&&(i+1===f&&(s+="."),s+=le(n))),s}function Re(t,r){var e=t[0];for(r*=P;e>=10;e/=10)r++;return r}function je(t,r,e){if(r>Br)throw k=!0,e&&(t.precision=e),Error(Zt);return S(new t(Ie),r,1,!0)}function Y(t,r,e){if(r>nt)throw Error(Zt);return S(new t(_e),r,e,!0)}function Wt(t){var r=t.length-1,e=r*P+1;if(r=t[r],r){for(;r%10==0;r/=10)e--;for(r=t[0];r>=10;r/=10)e++}return e}function le(t){for(var r="";t--;)r+="0";return r}function Gt(t,r,e,n){var i,s=new t(1),f=Math.ceil(n/P+4);for(k=!1;;){if(e%2&&(s=s.times(r),Dt(s.d,f)&&(i=!0)),e=W(e/2),e===0){e=s.d.length-1,i&&s.d[e]===0&&++s.d[e];break}r=r.times(r),Dt(r.d,f)}return k=!0,s}function jt(t){return t.d[t.d.length-1]&1}function Xt(t,r,e){for(var n,i,s=new t(r[0]),f=0;++f<r.length;){if(i=new t(r[f]),!i.s){s=i;break}n=s.cmp(i),(n===e||n===0&&s.s===e)&&(s=i)}return s}function it(t,r){var e,n,i,s,f,a,c,u=0,d=0,w=0,m=t.constructor,b=m.rounding,O=m.precision;if(!t.d||!t.d[0]||t.e>17)return new m(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(r==null?(k=!1,c=O):c=r,a=new m(.03125);t.e>-2;)t=t.times(a),w+=5;for(n=Math.log(U(2,w))/Math.LN10*2+5|0,c+=n,e=s=f=new m(1),m.precision=c;;){if(s=S(s.times(t),c,1),e=e.times(++d),a=f.plus(j(s,e,c,1)),V(a.d).slice(0,c)===V(f.d).slice(0,c)){for(i=w;i--;)f=S(f.times(f),c,1);if(r==null)if(u<3&&xe(f.d,c-n,b,u))m.precision=c+=10,e=s=a=new m(1),d=0,u++;else return S(f,m.precision=O,b,k=!0);else return m.precision=O,f}f=a}}function ce(t,r){var e,n,i,s,f,a,c,u,d,w,m,b=1,O=10,M=t,Z=M.d,_=M.constructor,G=_.rounding,I=_.precision;if(M.s<0||!Z||!Z[0]||!M.e&&Z[0]==1&&Z.length==1)return new _(Z&&!Z[0]?-1/0:M.s!=1?NaN:Z?0:M);if(r==null?(k=!1,d=I):d=r,_.precision=d+=O,e=V(Z),n=e.charAt(0),Math.abs(s=M.e)<15e14){for(;n<7&&n!=1||n==1&&e.charAt(1)>3;)M=M.times(t),e=V(M.d),n=e.charAt(0),b++;s=M.e,n>1?(M=new _("0."+e),s++):M=new _(n+"."+e.slice(1))}else return u=je(_,d+2,I).times(s+""),M=ce(new _(n+"."+e.slice(1)),d-O).plus(u),_.precision=I,r==null?S(M,I,G,k=!0):M;for(w=M,c=f=M=j(M.minus(1),M.plus(1),d,1),m=S(M.times(M),d,1),i=3;;){if(f=S(f.times(m),d,1),u=c.plus(j(f,new _(i),d,1)),V(u.d).slice(0,d)===V(c.d).slice(0,d))if(c=c.times(2),s!==0&&(c=c.plus(je(_,d+2,I).times(s+""))),c=j(c,new _(b),d,1),r==null)if(xe(c.d,d-O,G,a))_.precision=d+=O,u=f=M=j(w.minus(1),w.plus(1),d,1),m=S(M.times(M),d,1),i=a=1;else return S(c,_.precision=I,G,k=!0);else return _.precision=I,c;c=u,i+=2}}function zt(t){return String(t.s*t.s/0)}function Fe(t,r){var e,n,i;for((e=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(e<0&&(e=n),e+=+r.slice(n+1),r=r.substring(0,n)):e<0&&(e=r.length),n=0;r.charCodeAt(n)===48;n++);for(i=r.length;r.charCodeAt(i-1)===48;--i);if(r=r.slice(n,i),r){if(i-=n,t.e=e=e-n-1,t.d=[],n=(e+1)%P,e<0&&(n+=P),n<i){for(n&&t.d.push(+r.slice(0,n)),i-=P;n<i;)t.d.push(+r.slice(n,n+=P));r=r.slice(n),n=P-r.length}else n-=i;for(;n--;)r+="0";t.d.push(+r),k&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function Hr(t,r){var e,n,i,s,f,a,c,u,d;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),Ht.test(r))return Fe(t,r)}else if(r==="Infinity"||r==="NaN")return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(Tr.test(r))e=16,r=r.toLowerCase();else if(Rr.test(r))e=2;else if(Ur.test(r))e=8;else throw Error(ue+r);for(s=r.search(/p/i),s>0?(c=+r.slice(s+1),r=r.substring(2,s)):r=r.slice(2),s=r.indexOf("."),f=s>=0,n=t.constructor,f&&(r=r.replace(".",""),a=r.length,s=a-s,i=Gt(n,new n(e),s,s*2)),u=Le(r,e,K),d=u.length-1,s=d;u[s]===0;--s)u.pop();return s<0?new n(t.s*0):(t.e=Re(u,d),t.d=u,k=!1,f&&(t=j(t,i,a*4)),c&&(t=t.times(Math.abs(c)<54?U(2,c):L.pow(2,c))),k=!0,t)}function Wr(t,r){var e,n=r.d.length;if(n<3)return r.isZero()?r:ye(t,2,r,r);e=1.4*Math.sqrt(n),e=e>16?16:e|0,r=r.times(1/Te(5,e)),r=ye(t,2,r,r);for(var i,s=new t(5),f=new t(16),a=new t(20);e--;)i=r.times(r),r=r.times(s.plus(i.times(f.times(i).minus(a))));return r}function ye(t,r,e,n,i){var s,f,a,c,u=t.precision,d=Math.ceil(u/P);for(k=!1,c=e.times(e),a=new t(n);;){if(f=j(a.times(c),new t(r++*r++),u,1),a=i?n.plus(f):n.minus(f),n=j(f.times(c),new t(r++*r++),u,1),f=a.plus(n),f.d[d]!==void 0){for(s=d;f.d[s]===a.d[s]&&s--;);if(s==-1)break}s=a,a=n,n=f,f=s}return k=!0,f.d.length=d+1,f}function Te(t,r){for(var e=t;--r;)e*=t;return e}function Qt(t,r){var e,n=r.s<0,i=Y(t,t.precision,1),s=i.times(.5);if(r=r.abs(),r.lte(s))return ie=n?4:1,r;if(e=r.divToInt(i),e.isZero())ie=n?3:2;else{if(r=r.minus(e.times(i)),r.lte(s))return ie=jt(e)?n?2:3:n?4:1,r;ie=jt(e)?n?1:4:n?3:2}return r.minus(i).abs()}function ot(t,r,e,n){var i,s,f,a,c,u,d,w,m,b=t.constructor,O=e!==void 0;if(O?(z(e,1,pe),n===void 0?n=b.rounding:z(n,0,8)):(e=b.precision,n=b.rounding),!t.isFinite())d=zt(t);else{for(d=ee(t),f=d.indexOf("."),O?(i=2,r==16?e=e*4-3:r==8&&(e=e*3-2)):i=r,f>=0&&(d=d.replace(".",""),m=new b(1),m.e=d.length-f,m.d=Le(ee(m),10,i),m.e=m.d.length),w=Le(d,10,i),s=c=w.length;w[--c]==0;)w.pop();if(!w[0])d=O?"0p+0":"0";else{if(f<0?s--:(t=new b(t),t.d=w,t.e=s,t=j(t,m,e,n,0,i),w=t.d,s=t.e,u=Ut),f=w[e],a=i/2,u=u||w[e+1]!==void 0,u=n<4?(f!==void 0||u)&&(n===0||n===(t.s<0?3:2)):f>a||f===a&&(n===4||u||n===6&&w[e-1]&1||n===(t.s<0?8:7)),w.length=e,u)for(;++w[--e]>i-1;)w[e]=0,e||(++s,w.unshift(1));for(c=w.length;!w[c-1];--c);for(f=0,d="";f<c;f++)d+=tt.charAt(w[f]);if(O){if(c>1)if(r==16||r==8){for(f=r==16?4:3,--c;c%f;c++)d+="0";for(w=Le(d,i,r),c=w.length;!w[c-1];--c);for(f=1,d="1.";f<c;f++)d+=tt.charAt(w[f])}else d=d.charAt(0)+"."+d.slice(1);d=d+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)d="0"+d;d="0."+d}else if(++s>c)for(s-=c;s--;)d+="0";else s<c&&(d=d.slice(0,s)+"."+d.slice(s))}d=(r==16?"0x":r==2?"0b":r==8?"0o":"")+d}return t.s<0?"-"+d:d}function Dt(t,r){if(t.length>r)return t.length=r,!0}function Gr(t){return new this(t).abs()}function Xr(t){return new this(t).acos()}function zr(t){return new this(t).acosh()}function Qr(t,r){return new this(t).plus(r)}function Jr(t){return new this(t).asin()}function Kr(t){return new this(t).asinh()}function Yr(t){return new this(t).atan()}function en(t){return new this(t).atanh()}function tn(t,r){t=new this(t),r=new this(r);var e,n=this.precision,i=this.rounding,s=n+4;return!t.s||!r.s?e=new this(NaN):!t.d&&!r.d?(e=Y(this,s,1).times(r.s>0?.25:.75),e.s=t.s):!r.d||t.isZero()?(e=r.s<0?Y(this,n,i):new this(0),e.s=t.s):!t.d||r.isZero()?(e=Y(this,s,1).times(.5),e.s=t.s):r.s<0?(this.precision=s,this.rounding=1,e=this.atan(j(t,r,s,1)),r=Y(this,s,1),this.precision=n,this.rounding=i,e=t.s<0?e.minus(r):e.plus(r)):e=this.atan(j(t,r,s,1)),e}function rn(t){return new this(t).cbrt()}function nn(t){return S(t=new this(t),t.e+1,2)}function sn(t,r,e){return new this(t).clamp(r,e)}function on(t){if(!t||typeof t!="object")throw Error(De+"Object expected");var r,e,n,i=t.defaults===!0,s=["precision",1,pe,"rounding",0,8,"toExpNeg",-Ne,0,"toExpPos",0,Ne,"maxE",0,Ne,"minE",-Ne,0,"modulo",0,9];for(r=0;r<s.length;r+=3)if(e=s[r],i&&(this[e]=rt[e]),(n=t[e])!==void 0)if(W(n)===n&&n>=s[r+1]&&n<=s[r+2])this[e]=n;else throw Error(ue+e+": "+n);if(e="crypto",i&&(this[e]=rt[e]),(n=t[e])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(Bt);else this[e]=!1;else throw Error(ue+e+": "+n);return this}function fn(t){return new this(t).cos()}function an(t){return new this(t).cosh()}function Jt(t){var r,e,n;function i(s){var f,a,c,u=this;if(!(u instanceof i))return new i(s);if(u.constructor=i,Rt(s)){u.s=s.s,k?!s.d||s.e>i.maxE?(u.e=NaN,u.d=null):s.e<i.minE?(u.e=0,u.d=[0]):(u.e=s.e,u.d=s.d.slice()):(u.e=s.e,u.d=s.d?s.d.slice():s.d);return}if(c=typeof s,c==="number"){if(s===0){u.s=1/s<0?-1:1,u.e=0,u.d=[0];return}if(s<0?(s=-s,u.s=-1):u.s=1,s===~~s&&s<1e7){for(f=0,a=s;a>=10;a/=10)f++;k?f>i.maxE?(u.e=NaN,u.d=null):f<i.minE?(u.e=0,u.d=[0]):(u.e=f,u.d=[s]):(u.e=f,u.d=[s]);return}if(s*0!==0){s||(u.s=NaN),u.e=NaN,u.d=null;return}return Fe(u,s.toString())}if(c==="string")return(a=s.charCodeAt(0))===45?(s=s.slice(1),u.s=-1):(a===43&&(s=s.slice(1)),u.s=1),Ht.test(s)?Fe(u,s):Hr(u,s);if(c==="bigint")return s<0?(s=-s,u.s=-1):u.s=1,Fe(u,s.toString());throw Error(ue+s)}if(i.prototype=E,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=on,i.clone=Jt,i.isDecimal=Rt,i.abs=Gr,i.acos=Xr,i.acosh=zr,i.add=Qr,i.asin=Jr,i.asinh=Kr,i.atan=Yr,i.atanh=en,i.atan2=tn,i.cbrt=rn,i.ceil=nn,i.clamp=sn,i.cos=fn,i.cosh=an,i.div=ln,i.exp=cn,i.floor=un,i.hypot=pn,i.ln=hn,i.log=dn,i.log10=mn,i.log2=gn,i.max=wn,i.min=$n,i.mod=vn,i.mul=En,i.pow=bn,i.random=Nn,i.round=yn,i.sign=An,i.sin=Cn,i.sinh=Sn,i.sqrt=Mn,i.sub=xn,i.sum=Pn,i.tan=On,i.tanh=kn,i.trunc=Ln,t===void 0&&(t={}),t&&t.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)t.hasOwnProperty(e=n[r++])||(t[e]=this[e]);return i.config(t),i}function ln(t,r){return new this(t).div(r)}function cn(t){return new this(t).exp()}function un(t){return S(t=new this(t),t.e+1,3)}function pn(){var t,r,e=new this(0);for(k=!1,t=0;t<arguments.length;)if(r=new this(arguments[t++]),r.d)e.d&&(e=e.plus(r.times(r)));else{if(r.s)return k=!0,new this(1/0);e=r}return k=!0,e.sqrt()}function Rt(t){return t instanceof L||t&&t.toStringTag===Vt||!1}function hn(t){return new this(t).ln()}function dn(t,r){return new this(t).log(r)}function gn(t){return new this(t).log(2)}function mn(t){return new this(t).log(10)}function wn(){return Xt(this,arguments,-1)}function $n(){return Xt(this,arguments,1)}function vn(t,r){return new this(t).mod(r)}function En(t,r){return new this(t).mul(r)}function bn(t,r){return new this(t).pow(r)}function Nn(t){var r,e,n,i,s=0,f=new this(1),a=[];if(t===void 0?t=this.precision:z(t,1,pe),n=Math.ceil(t/P),this.crypto)if(crypto.getRandomValues)for(r=crypto.getRandomValues(new Uint32Array(n));s<n;)i=r[s],i>=429e7?r[s]=crypto.getRandomValues(new Uint32Array(1))[0]:a[s++]=i%1e7;else if(crypto.randomBytes){for(r=crypto.randomBytes(n*=4);s<n;)i=r[s]+(r[s+1]<<8)+(r[s+2]<<16)+((r[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(r,s):(a.push(i%1e7),s+=4);s=n/4}else throw Error(Bt);else for(;s<n;)a[s++]=Math.random()*1e7|0;for(n=a[--s],t%=P,n&&t&&(i=U(10,P-t),a[s]=(n/i|0)*i);a[s]===0;s--)a.pop();if(s<0)e=0,a=[0];else{for(e=-1;a[0]===0;e-=P)a.shift();for(n=1,i=a[0];i>=10;i/=10)n++;n<P&&(e-=P-n)}return f.e=e,f.d=a,f}function yn(t){return S(t=new this(t),t.e+1,this.rounding)}function An(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function Cn(t){return new this(t).sin()}function Sn(t){return new this(t).sinh()}function Mn(t){return new this(t).sqrt()}function xn(t,r){return new this(t).sub(r)}function Pn(){var t=0,r=arguments,e=new this(r[t]);for(k=!1;e.s&&++t<r.length;)e=e.plus(r[t]);return k=!0,S(e,this.precision,this.rounding)}function On(t){return new this(t).tan()}function kn(t){return new this(t).tanh()}function Ln(t){return S(t=new this(t),t.e+1,1)}E[Symbol.for("nodejs.util.inspect.custom")]=E.toString;E[Symbol.toStringTag]="Decimal";var L=E.constructor=Jt(rt);Ie=new L(Ie);_e=new L(_e);class Tt extends SyntaxError{constructor(r,e,n,i){super(r),this.expected=e,this.found=n,this.location=i,this.name="SyntaxError"}format(r){let e="Error: "+this.message;if(this.location){let n=null;const i=r.find(c=>c.source===this.location.source);i&&(n=i.text.split(/\r\n|\n|\r/g));const s=this.location.start,f=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(s):s,a=this.location.source+":"+f.line+":"+f.column;if(n){const c=this.location.end,u="".padEnd(f.line.toString().length," "),d=n[s.line-1],m=(s.line===c.line?c.column:d.length+1)-s.column||1;e+=`
 --> `+a+`
`+u+` |
`+f.line+" | "+d+`
`+u+" | "+"".padEnd(s.column-1," ")+"".padEnd(m,"^")}else e+=`
 at `+a}return e}static buildMessage(r,e){function n(m){return m.codePointAt(0).toString(16).toUpperCase()}const i=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function s(m){return i?m.replace(i,b=>"\\u{"+n(b)+"}"):m}function f(m){return s(m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,b=>"\\x0"+n(b)).replace(/[\x10-\x1F\x7F-\x9F]/g,b=>"\\x"+n(b)))}function a(m){return s(m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,b=>"\\x0"+n(b)).replace(/[\x10-\x1F\x7F-\x9F]/g,b=>"\\x"+n(b)))}const c={literal(m){return'"'+f(m.text)+'"'},class(m){const b=m.parts.map(O=>Array.isArray(O)?a(O[0])+"-"+a(O[1]):a(O));return"["+(m.inverted?"^":"")+b.join("")+"]"+(m.unicode?"u":"")},any(){return"any character"},end(){return"end of input"},other(m){return m.description}};function u(m){return c[m.type](m)}function d(m){const b=m.map(u);if(b.sort(),b.length>0){let O=1;for(let M=1;M<b.length;M++)b[M-1]!==b[M]&&(b[O]=b[M],O++);b.length=O}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}function w(m){return m?'"'+f(m)+'"':"end of input"}return"Expected "+d(r)+" but "+w(e)+" found."}}function Kt(t,r){r=r!==void 0?r:{};const e={},n=r.grammarSource,i={Expression:ae};let s=ae;const f="?",a=":",c="||",u="??",d="&&",w="!=",m="==",b="=",O="<=",M=">=",Z="**",_="(",G=")",I="[",T="]",se=".",Q='"',he="'",de=",",oe="true",$e="false",X="null",ge=/^[<>]/,fe=/^[+\-]/,ve=/^[%*\/]/,B=/^[!+\-]/,F=/^[0-9]/,Yt=/^[eE]/,Ae=/^[a-zA-Z0-9_$]/,er=/^[a-zA-Z_$]/,at=/^[ \t\n\r]/,tr=R("?",!1),rr=R(":",!1),lt=R("||",!1),ct=R("??",!1),ut=R("&&",!1),pt=R("!=",!1),ht=R("==",!1),dt=R("=",!1),gt=R("<=",!1),mt=R(">=",!1),wt=te(["<",">"],!1,!1,!1),Ze=te(["+","-"],!1,!1,!1),$t=te(["%","*","/"],!1,!1,!1),nr=R("**",!1),ir=te(["!","+","-"],!1,!1,!1),Be=R("(",!1),Ve=R(")",!1),vt=R("[",!1),Et=R("]",!1),He=R(".",!1),We=R('"',!1),Ge=R("'",!1),bt=Pr(),Nt=R(",",!1),Ee=te([["0","9"]],!1,!1,!1),sr=te(["e","E"],!1,!1,!1),or=R("true",!1),Ce=te([["a","z"],["A","Z"],["0","9"],"_","$"],!1,!1,!1),fr=R("false",!1),ar=R("null",!1),lr=te([["a","z"],["A","Z"],"_","$"],!1,!1,!1),yt=te([" ","	",`
`,"\r"],!1,!1,!1);function Vn(l){return l}function cr(l,h,$){return{type:"ConditionalExpression",test:l,consequent:h,alternate:$}}function ur(l,h){return h.reduce(($,p)=>({type:"LogicalExpression",operator:p[1],left:$,right:p[3]}),l)}function pr(l,h){return h.reduce(($,p)=>({type:"LogicalExpression",operator:p[1],left:$,right:p[3]}),l)}function hr(l,h){return ke(l,h)}function dr(l,h){return ke(l,h)}function gr(l,h){return ke(l,h)}function mr(l,h){return ke(l,h)}function wr(l,h){return h?{type:"BinaryExpression",operator:"**",left:l,right:h[3]}:l}function $r(l,h){return{type:"UnaryExpression",operator:l,argument:h,prefix:!0}}function At(l,h){return{type:"call",args:h||[]}}function Ct(l,h){return{type:"member",property:h,computed:!0}}function St(l,h){return{type:"member",property:h,computed:!1}}function vr(l,h){return h.reduce(($,p)=>p.type==="call"?{type:"CallExpression",callee:$,arguments:p.args}:{type:"MemberExpression",object:$,property:p.property,computed:p.computed},l)}function Er(l){return{type:"Literal",value:l.join(""),raw:'"'+l.join("")+'"'}}function br(l){return{type:"Literal",value:l.join(""),raw:"'"+l.join("")+"'"}}function Hn(l){return l}function Wn(l){return l}function Nr(l,h){return[l].concat(h.map($=>$[3]))}function Gn(l){return l}function yr(l){return{type:"Literal",value:parseFloat(l),raw:l}}function Ar(){return{type:"Literal",value:!0,raw:"true"}}function Cr(){return{type:"Literal",value:!1,raw:"false"}}function Sr(){return{type:"Literal",value:null,raw:"null"}}function Mr(l){return{type:"Identifier",name:l}}let o=r.peg$currPos|0;const be=[{line:1,column:1}];let J=o,Pe=r.peg$maxFailExpected||[],N=r.peg$silentFails|0,Se;if(r.startRule){if(!(r.startRule in i))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');s=i[r.startRule]}function xr(l=o){const h=t.codePointAt(l);return h===void 0?"":String.fromCodePoint(h)}function R(l,h){return{type:"literal",text:l,ignoreCase:h}}function te(l,h,$,p){return{type:"class",parts:l,inverted:h,ignoreCase:$,unicode:p}}function Pr(){return{type:"any"}}function Or(){return{type:"end"}}function Mt(l){let h=be[l],$;if(h)return h;if(l>=be.length)$=be.length-1;else for($=l;!be[--$];);for(h=be[$],h={line:h.line,column:h.column};$<l;)t.charCodeAt($)===10?(h.line++,h.column=1):h.column++,$++;return be[l]=h,h}function xt(l,h,$){const p=Mt(l),v=Mt(h);return{source:n,start:{offset:l,line:p.line,column:p.column},end:{offset:h,line:v.line,column:v.column}}}function y(l){o<J||(o>J&&(J=o,Pe=[]),Pe.push(l))}function kr(l,h,$){return new Tt(Tt.buildMessage(l,h),l,h,$)}function ae(){let l,h;return l=o,x(),h=Pt(),h!==e?(x(),l=h):(o=l,l=e),l}function Pt(){let l,h,$,p,v,g;return l=o,h=Ot(),h!==e?(x(),t.charCodeAt(o)===63?($=f,o++):($=e,N===0&&y(tr)),$!==e?(x(),p=ae(),p!==e?(x(),t.charCodeAt(o)===58?(v=a,o++):(v=e,N===0&&y(rr)),v!==e?(x(),g=Pt(),g!==e?l=cr(h,p,g):(o=l,l=e)):(o=l,l=e)):(o=l,l=e)):(o=l,l=e)):(o=l,l=e),l===e&&(l=Ot()),l}function Ot(){let l,h,$,p,v,g,A,C;if(l=o,h=Xe(),h!==e){for($=[],p=o,v=x(),t.substr(o,2)===c?(g=c,o+=2):(g=e,N===0&&y(lt)),g===e&&(t.substr(o,2)===u?(g=u,o+=2):(g=e,N===0&&y(ct))),g!==e?(A=x(),C=Xe(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);p!==e;)$.push(p),p=o,v=x(),t.substr(o,2)===c?(g=c,o+=2):(g=e,N===0&&y(lt)),g===e&&(t.substr(o,2)===u?(g=u,o+=2):(g=e,N===0&&y(ct))),g!==e?(A=x(),C=Xe(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);l=ur(h,$)}else o=l,l=e;return l}function Xe(){let l,h,$,p,v,g,A,C;if(l=o,h=ze(),h!==e){for($=[],p=o,v=x(),t.substr(o,2)===d?(g=d,o+=2):(g=e,N===0&&y(ut)),g!==e?(A=x(),C=ze(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);p!==e;)$.push(p),p=o,v=x(),t.substr(o,2)===d?(g=d,o+=2):(g=e,N===0&&y(ut)),g!==e?(A=x(),C=ze(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);l=pr(h,$)}else o=l,l=e;return l}function ze(){let l,h,$,p,v,g,A,C;if(l=o,h=Qe(),h!==e){for($=[],p=o,v=x(),t.substr(o,2)===w?(g=w,o+=2):(g=e,N===0&&y(pt)),g===e&&(t.substr(o,2)===m?(g=m,o+=2):(g=e,N===0&&y(ht)),g===e&&(t.charCodeAt(o)===61?(g=b,o++):(g=e,N===0&&y(dt)))),g!==e?(A=x(),C=Qe(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);p!==e;)$.push(p),p=o,v=x(),t.substr(o,2)===w?(g=w,o+=2):(g=e,N===0&&y(pt)),g===e&&(t.substr(o,2)===m?(g=m,o+=2):(g=e,N===0&&y(ht)),g===e&&(t.charCodeAt(o)===61?(g=b,o++):(g=e,N===0&&y(dt)))),g!==e?(A=x(),C=Qe(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);l=hr(h,$)}else o=l,l=e;return l}function Qe(){let l,h,$,p,v,g,A,C;if(l=o,h=Je(),h!==e){for($=[],p=o,v=x(),t.substr(o,2)===O?(g=O,o+=2):(g=e,N===0&&y(gt)),g===e&&(t.substr(o,2)===M?(g=M,o+=2):(g=e,N===0&&y(mt)),g===e&&(g=t.charAt(o),ge.test(g)?o++:(g=e,N===0&&y(wt)))),g!==e?(A=x(),C=Je(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);p!==e;)$.push(p),p=o,v=x(),t.substr(o,2)===O?(g=O,o+=2):(g=e,N===0&&y(gt)),g===e&&(t.substr(o,2)===M?(g=M,o+=2):(g=e,N===0&&y(mt)),g===e&&(g=t.charAt(o),ge.test(g)?o++:(g=e,N===0&&y(wt)))),g!==e?(A=x(),C=Je(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);l=dr(h,$)}else o=l,l=e;return l}function Je(){let l,h,$,p,v,g,A,C;if(l=o,h=Ke(),h!==e){for($=[],p=o,v=x(),g=t.charAt(o),fe.test(g)?o++:(g=e,N===0&&y(Ze)),g!==e?(A=x(),C=Ke(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);p!==e;)$.push(p),p=o,v=x(),g=t.charAt(o),fe.test(g)?o++:(g=e,N===0&&y(Ze)),g!==e?(A=x(),C=Ke(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);l=gr(h,$)}else o=l,l=e;return l}function Ke(){let l,h,$,p,v,g,A,C;if(l=o,h=Oe(),h!==e){for($=[],p=o,v=x(),g=t.charAt(o),ve.test(g)?o++:(g=e,N===0&&y($t)),g!==e?(A=x(),C=Oe(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);p!==e;)$.push(p),p=o,v=x(),g=t.charAt(o),ve.test(g)?o++:(g=e,N===0&&y($t)),g!==e?(A=x(),C=Oe(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);l=mr(h,$)}else o=l,l=e;return l}function Oe(){let l,h,$,p,v,g,A;return l=o,h=kt(),h!==e?($=o,p=x(),t.substr(o,2)===Z?(v=Z,o+=2):(v=e,N===0&&y(nr)),v!==e?(g=x(),A=Oe(),A!==e?(p=[p,v,g,A],$=p):(o=$,$=e)):(o=$,$=e),$===e&&($=null),l=wr(h,$)):(o=l,l=e),l}function kt(){let l,h,$;return l=o,h=t.charAt(o),B.test(h)?o++:(h=e,N===0&&y(ir)),h!==e?(x(),$=kt(),$!==e?l=$r(h,$):(o=l,l=e)):(o=l,l=e),l===e&&(l=Lr()),l}function Lr(){let l,h,$,p,v,g,A;if(l=o,h=qr(),h!==e){for($=[],p=o,x(),t.charCodeAt(o)===40?(v=_,o++):(v=e,N===0&&y(Be)),v!==e?(x(),g=It(),g===e&&(g=null),x(),t.charCodeAt(o)===41?(A=G,o++):(A=e,N===0&&y(Ve)),A!==e?p=At(h,g):(o=p,p=e)):(o=p,p=e),p===e&&(p=o,x(),t.charCodeAt(o)===91?(v=I,o++):(v=e,N===0&&y(vt)),v!==e?(x(),g=Lt(),g!==e?(x(),t.charCodeAt(o)===93?(A=T,o++):(A=e,N===0&&y(Et)),A!==e?p=Ct(h,g):(o=p,p=e)):(o=p,p=e)):(o=p,p=e),p===e&&(p=o,x(),t.charCodeAt(o)===46?(v=se,o++):(v=e,N===0&&y(He)),v!==e?(x(),g=Ye(),g!==e?p=St(h,g):(o=p,p=e)):(o=p,p=e)));p!==e;)$.push(p),p=o,x(),t.charCodeAt(o)===40?(v=_,o++):(v=e,N===0&&y(Be)),v!==e?(x(),g=It(),g===e&&(g=null),x(),t.charCodeAt(o)===41?(A=G,o++):(A=e,N===0&&y(Ve)),A!==e?p=At(h,g):(o=p,p=e)):(o=p,p=e),p===e&&(p=o,x(),t.charCodeAt(o)===91?(v=I,o++):(v=e,N===0&&y(vt)),v!==e?(x(),g=Lt(),g!==e?(x(),t.charCodeAt(o)===93?(A=T,o++):(A=e,N===0&&y(Et)),A!==e?p=Ct(h,g):(o=p,p=e)):(o=p,p=e)):(o=p,p=e),p===e&&(p=o,x(),t.charCodeAt(o)===46?(v=se,o++):(v=e,N===0&&y(He)),v!==e?(x(),g=Ye(),g!==e?p=St(h,g):(o=p,p=e)):(o=p,p=e)));l=vr(h,$)}else o=l,l=e;return l}function Lt(){let l;return l=Fr(),l===e&&(l=ae()),l}function Fr(){let l,h,$,p;if(l=o,t.charCodeAt(o)===34?(h=Q,o++):(h=e,N===0&&y(We)),h!==e){for($=[],p=Ft();p!==e;)$.push(p),p=Ft();t.charCodeAt(o)===34?(p=Q,o++):(p=e,N===0&&y(We)),p!==e?l=Er($):(o=l,l=e)}else o=l,l=e;if(l===e)if(l=o,t.charCodeAt(o)===39?(h=he,o++):(h=e,N===0&&y(Ge)),h!==e){for($=[],p=qt();p!==e;)$.push(p),p=qt();t.charCodeAt(o)===39?(p=he,o++):(p=e,N===0&&y(Ge)),p!==e?l=br($):(o=l,l=e)}else o=l,l=e;return l}function Ft(){let l,h,$;return l=o,h=o,N++,t.charCodeAt(o)===34?($=Q,o++):($=e,N===0&&y(We)),N--,$===e?h=void 0:(o=h,h=e),h!==e?(t.length>o?($=t.charAt(o),o++):($=e,N===0&&y(bt)),$!==e?l=$:(o=l,l=e)):(o=l,l=e),l}function qt(){let l,h,$;return l=o,h=o,N++,t.charCodeAt(o)===39?($=he,o++):($=e,N===0&&y(Ge)),N--,$===e?h=void 0:(o=h,h=e),h!==e?(t.length>o?($=t.charAt(o),o++):($=e,N===0&&y(bt)),$!==e?l=$:(o=l,l=e)):(o=l,l=e),l}function It(){let l,h,$,p,v,g,A,C;if(l=o,h=ae(),h!==e){for($=[],p=o,v=x(),t.charCodeAt(o)===44?(g=de,o++):(g=e,N===0&&y(Nt)),g!==e?(A=x(),C=ae(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);p!==e;)$.push(p),p=o,v=x(),t.charCodeAt(o)===44?(g=de,o++):(g=e,N===0&&y(Nt)),g!==e?(A=x(),C=ae(),C!==e?(v=[v,g,A,C],p=v):(o=p,p=e)):(o=p,p=e);l=Nr(h,$)}else o=l,l=e;return l}function qr(){let l,h,$,p;return l=Ir(),l===e&&(l=Ye(),l===e&&(l=o,t.charCodeAt(o)===40?(h=_,o++):(h=e,N===0&&y(Be)),h!==e?(x(),$=ae(),$!==e?(x(),t.charCodeAt(o)===41?(p=G,o++):(p=e,N===0&&y(Ve)),p!==e?l=$:(o=l,l=e)):(o=l,l=e)):(o=l,l=e))),l}function Ir(){let l;return l=_r(),l===e&&(l=jr(),l===e&&(l=Dr())),l}function _r(){let l,h,$,p,v,g,A,C,Me,re;if(l=o,h=o,$=o,p=[],v=t.charAt(o),F.test(v)?o++:(v=e,N===0&&y(Ee)),v!==e)for(;v!==e;)p.push(v),v=t.charAt(o),F.test(v)?o++:(v=e,N===0&&y(Ee));else p=e;if(p!==e){if(v=o,t.charCodeAt(o)===46?(g=se,o++):(g=e,N===0&&y(He)),g!==e){if(A=[],C=t.charAt(o),F.test(C)?o++:(C=e,N===0&&y(Ee)),C!==e)for(;C!==e;)A.push(C),C=t.charAt(o),F.test(C)?o++:(C=e,N===0&&y(Ee));else A=e;A!==e?(g=[g,A],v=g):(o=v,v=e)}else o=v,v=e;if(v===e&&(v=null),g=o,A=t.charAt(o),Yt.test(A)?o++:(A=e,N===0&&y(sr)),A!==e){if(C=t.charAt(o),fe.test(C)?o++:(C=e,N===0&&y(Ze)),C===e&&(C=null),Me=[],re=t.charAt(o),F.test(re)?o++:(re=e,N===0&&y(Ee)),re!==e)for(;re!==e;)Me.push(re),re=t.charAt(o),F.test(re)?o++:(re=e,N===0&&y(Ee));else Me=e;Me!==e?(A=[A,C,Me],g=A):(o=g,g=e)}else o=g,g=e;g===e&&(g=null),p=[p,v,g],$=p}else o=$,$=e;return $!==e?h=t.substring(h,o):h=$,h!==e&&(h=yr(h)),l=h,l}function jr(){let l,h,$,p;return l=o,t.substr(o,4)===oe?(h=oe,o+=4):(h=e,N===0&&y(or)),h!==e?($=o,N++,p=t.charAt(o),Ae.test(p)?o++:(p=e,N===0&&y(Ce)),N--,p===e?$=void 0:(o=$,$=e),$!==e?l=Ar():(o=l,l=e)):(o=l,l=e),l===e&&(l=o,t.substr(o,5)===$e?(h=$e,o+=5):(h=e,N===0&&y(fr)),h!==e?($=o,N++,p=t.charAt(o),Ae.test(p)?o++:(p=e,N===0&&y(Ce)),N--,p===e?$=void 0:(o=$,$=e),$!==e?l=Cr():(o=l,l=e)):(o=l,l=e)),l}function Dr(){let l,h,$,p;return l=o,t.substr(o,4)===X?(h=X,o+=4):(h=e,N===0&&y(ar)),h!==e?($=o,N++,p=t.charAt(o),Ae.test(p)?o++:(p=e,N===0&&y(Ce)),N--,p===e?$=void 0:(o=$,$=e),$!==e?l=Sr():(o=l,l=e)):(o=l,l=e),l}function Ye(){let l,h,$,p,v,g;if(l=o,h=o,$=o,p=t.charAt(o),er.test(p)?o++:(p=e,N===0&&y(lr)),p!==e){for(v=[],g=t.charAt(o),Ae.test(g)?o++:(g=e,N===0&&y(Ce));g!==e;)v.push(g),g=t.charAt(o),Ae.test(g)?o++:(g=e,N===0&&y(Ce));p=[p,v],$=p}else o=$,$=e;return $!==e?h=t.substring(h,o):h=$,h!==e&&(h=Mr(h)),l=h,l}function x(){let l,h;for(N++,l=[],h=t.charAt(o),at.test(h)?o++:(h=e,N===0&&y(yt));h!==e;)l.push(h),h=t.charAt(o),at.test(h)?o++:(h=e,N===0&&y(yt));return N--,l}function ke(l,h){return h.reduce(($,p)=>({type:"BinaryExpression",operator:p[1],left:$,right:p[3]}),l)}Se=s();const et=Se!==e&&o===t.length;function _t(){throw Se!==e&&o<t.length&&y(Or()),kr(Pe,J<t.length?xr(J):null,J<t.length?xt(J,J+1):xt(J,J))}if(r.peg$library)return{peg$result:Se,peg$currPos:o,peg$FAILED:e,peg$maxFailExpected:Pe,peg$maxFailPos:J,peg$success:et,peg$throw:et?void 0:_t};if(et)return Se;_t()}const Fn=t=>{const r=new Set,e=n=>{if(!(!n||typeof n!="object"))switch(n.type){case"Identifier":r.add(n.name);break;case"MemberExpression":e(n.object),n.computed&&e(n.property);break;case"BinaryExpression":case"LogicalExpression":e(n.left),e(n.right);break;case"UnaryExpression":e(n.argument);break;case"CallExpression":if(e(n.callee),n.arguments)for(const i of n.arguments)e(i);break;case"ConditionalExpression":e(n.test),e(n.consequent),e(n.alternate);break;case"ArrayExpression":if(n.elements)for(const i of n.elements)e(i);break;case"ObjectExpression":if(n.properties)for(const i of n.properties)i.type==="Property"?(i.computed&&e(i.key),e(i.value)):i.type==="SpreadElement"&&e(i.argument);break}};return e(t),Array.from(r).filter(n=>!n.startsWith("$"))};class we extends Error{constructor(r){super(r),this.name="EvallaError",Object.setPrototypeOf(this,we.prototype)}}class Ue extends we{constructor(r,e){super(r),this.name="SecurityError",this.property=e,Object.setPrototypeOf(this,Ue.prototype)}}class ft extends we{constructor(r,e){super(r),this.name="CircularDependencyError",this.cycle=e,Object.setPrototypeOf(this,ft.prototype)}}class ne extends we{constructor(r,e){super(r),this.name="ValidationError",this.variableName=e,Object.setPrototypeOf(this,ne.prototype)}}class D extends we{constructor(r,e){super(r),this.name="EvaluationError",this.variableName=e,Object.setPrototypeOf(this,D.prototype)}}class me extends D{constructor(r,e){super(r,e?.variableName),this.name="ParseError",this.expression=e?.expression,this.line=e?.line,this.column=e?.column,Object.setPrototypeOf(this,me.prototype)}}const qn=t=>{try{return Kt(t.trim())}catch(r){if(r.location){const{line:e,column:n}=r.location.start;throw new me(`Parse error at line ${e}, column ${n}: ${r.message}`,{line:e,column:n,expression:t})}throw new me(`Parse error: ${r.message}`,{expression:t})}},In=t=>Fn(t),_n=t=>{const r=new Map,e=new Set,n=new Map;for(const c of t)if(e.add(c.name),c.expr)try{const u=qn(c.expr);n.set(c.name,u)}catch(u){throw u instanceof me?new me(`Failed to parse expression for "${c.name}": ${u.message}`,{variableName:c.name,expression:c.expr,line:u.line,column:u.column}):new me(`Failed to parse expression for "${c.name}": ${u instanceof Error?u.message:String(u)}`,{variableName:c.name,expression:c.expr})}for(const c of t){if(!c.expr){r.set(c.name,[]);continue}const u=n.get(c.name);if(!u)throw new D(`No AST found for: ${c.name}`);const w=In(u).filter(m=>e.has(m));r.set(c.name,w)}const i=new Set,s=new Set,f=[],a=(c,u=[])=>{if(i.has(c))return;if(s.has(c)){const w=[...u,c];throw new ft(`Circular dependency detected: ${w.join(" -> ")}`,w)}s.add(c);const d=r.get(c)||[];for(const w of d)e.has(w)&&a(w,[...u,c]);s.delete(c),i.add(c),f.push(c)};for(const c of e)a(c);return{order:f,asts:n}},q=t=>t instanceof L?t:new L(t),qe=Symbol("NAMESPACE_HEAD"),st=t=>t!=null&&typeof t=="object"&&t[qe]===!0,jn=()=>{const t=Object.create(null);return t.$math=Object.create(null),t.$math[qe]=!0,t.$math.PI=new L(-1).acos(),t.$math.E=new L(1).exp(),t.$math.SQRT2=new L(2).sqrt(),t.$math.SQRT1_2=new L(.5).sqrt(),t.$math.LN2=new L(2).ln(),t.$math.LN10=new L(10).ln(),t.$math.LOG2E=t.$math.E.log(2),t.$math.LOG10E=t.$math.E.log(10),t.$math.abs=r=>q(r).abs(),t.$math.sqrt=r=>q(r).sqrt(),t.$math.cbrt=r=>q(r).cbrt(),t.$math.floor=r=>q(r).floor(),t.$math.ceil=r=>q(r).ceil(),t.$math.round=r=>q(r).round(),t.$math.trunc=r=>q(r).trunc(),t.$math.sin=r=>new L(Math.sin(q(r).toNumber())),t.$math.cos=r=>new L(Math.cos(q(r).toNumber())),t.$math.tan=r=>new L(Math.tan(q(r).toNumber())),t.$math.asin=r=>new L(Math.asin(q(r).toNumber())),t.$math.acos=r=>new L(Math.acos(q(r).toNumber())),t.$math.atan=r=>new L(Math.atan(q(r).toNumber())),t.$math.atan2=(r,e)=>new L(Math.atan2(q(r).toNumber(),q(e).toNumber())),t.$math.exp=r=>q(r).exp(),t.$math.ln=r=>q(r).ln(),t.$math.log=r=>q(r).log(),t.$math.log10=r=>q(r).log(10),t.$math.log2=r=>q(r).log(2),t.$math.pow=(r,e)=>q(r).pow(q(e)),t.$math.min=(...r)=>L.min(...r.map(q)),t.$math.max=(...r)=>L.max(...r.map(q)),t.$unit=Object.create(null),t.$unit[qe]=!0,t.$unit.mmToInch=r=>q(r).div(25.4),t.$unit.inchToMm=r=>q(r).mul(25.4),t.$unit.cmToInch=r=>q(r).div(2.54),t.$unit.inchToCm=r=>q(r).mul(2.54),t.$unit.mToFt=r=>q(r).mul(3.28084),t.$unit.ftToM=r=>q(r).div(3.28084),t.$angle=Object.create(null),t.$angle[qe]=!0,t.$angle.toRad=r=>q(r).mul(t.$math.PI).div(180),t.$angle.toDeg=r=>q(r).mul(180).div(t.$math.PI),t},Dn=new Set(["prototype","__proto__","constructor"]),Rn=t=>!(Dn.has(t)||t.startsWith("__")),H=async(t,r)=>{switch(t.type){case"Literal":return typeof t.value=="number"?new L(t.raw||t.value):t.value;case"Identifier":if(!(t.name in r))throw new D(`Undefined variable: ${t.name}`);return r[t.name];case"MemberExpression":const e=await H(t.object,r);if(e==null)throw new D(`Cannot access property of ${e}`);let n;if(t.computed){const m=await H(t.property,r);n=String(m)}else n=t.property.name;if(!Rn(n))throw new Ue(`Access to property "${n}" is not allowed for security reasons`,n);return e[n];case"BinaryExpression":const i=await H(t.left,r),s=await H(t.right,r);return Tn(t.operator,i,s);case"UnaryExpression":const f=await H(t.argument,r);return Un(t.operator,f);case"CallExpression":const a=await H(t.callee,r),c=[];for(const m of t.arguments)c.push(await H(m,r));if(typeof a!="function")throw new D("Callee is not a function");let u=null;return t.callee.type==="MemberExpression"&&(u=await H(t.callee.object,r)),a.apply(u,c);case"ConditionalExpression":return await H(t.test,r)?await H(t.consequent,r):await H(t.alternate,r);case"LogicalExpression":const w=await H(t.left,r);if(t.operator==="&&")return w&&await H(t.right,r);if(t.operator==="||")return w||await H(t.right,r);if(t.operator==="??")return w??await H(t.right,r);throw new D(`Unsupported logical operator: ${t.operator}`);default:throw new D(`Unsupported node type: ${t.type}`)}},Tn=(t,r,e)=>{if(st(r)||st(e))throw new D("Cannot use namespace head in operations - namespace heads must be used with property access (e.g., $math.PI) or method calls (e.g., $math.abs(x))");const n=["+","-","*","/","%","**"],i=["<",">","<=",">="];if(n.includes(t)||i.includes(t)){if(typeof r=="string")throw new D(`Cannot use string in ${t} operation - strings are not supported in mathematical expressions`);if(typeof r=="object"&&r!==null&&!(r instanceof L)&&!Array.isArray(r))throw new D(`Cannot use object in ${t} operation - only numeric values are allowed`);if(Array.isArray(r))throw new D(`Cannot use array in ${t} operation - only numeric values are allowed`);if(typeof e=="string")throw new D(`Cannot use string in ${t} operation - strings are not supported in mathematical expressions`);if(typeof e=="object"&&e!==null&&!(e instanceof L)&&!Array.isArray(e))throw new D(`Cannot use object in ${t} operation - only numeric values are allowed`);if(Array.isArray(e))throw new D(`Cannot use array in ${t} operation - only numeric values are allowed`)}if(t==="=="||t==="="||t==="!="){if(r instanceof L&&e instanceof L){const a=r.eq(e);return t==="!="?!a:a}if(typeof r=="boolean"||r===null||typeof e=="boolean"||e===null){const a=r===e;return t==="!="?!a:a}const f=r==e;return t==="!="?!f:f}const s=f=>f instanceof L?f:new L(f);switch(t){case"+":return s(r).plus(s(e));case"-":return s(r).minus(s(e));case"*":return s(r).times(s(e));case"/":return s(r).div(s(e));case"%":return s(r).mod(s(e));case"**":return s(r).pow(s(e));case"<":return s(r).lt(s(e));case">":return s(r).gt(s(e));case"<=":return s(r).lte(s(e));case">=":return s(r).gte(s(e));default:throw new D(`Unsupported binary operator: ${t}`)}},Un=(t,r)=>{switch(t){case"-":case"+":if(typeof r=="string")throw new D(`Cannot use string with unary ${t} - strings are not supported in mathematical expressions`);if(typeof r=="object"&&r!==null&&!(r instanceof L)&&!Array.isArray(r))throw new D(`Cannot use object with unary ${t} - only numeric values are allowed`);if(Array.isArray(r))throw new D(`Cannot use array with unary ${t} - only numeric values are allowed`);return t==="-"?r instanceof L?r.neg():-r:r instanceof L?r:+r;case"!":return!r;default:throw new D(`Unsupported unary operator: ${t}`)}},Zn=async(t,r)=>{try{const e=jn(),n=Object.create(null);for(const[s,f]of Object.entries(r))n[s]=f;for(const[s,f]of Object.entries(e))n[s]=f;const i=await H(t,n);if(st(i))throw new D("Cannot use namespace head as a value - namespace heads must be used with property access (e.g., $math.PI) or method calls (e.g., $math.abs(x))");if(typeof i=="function")throw new Ue("Cannot alias functions - functions must be called with parentheses");if(typeof i=="object"&&i!==null&&!(i instanceof L))throw Array.isArray(i)?new D("Expressions cannot return arrays - arrays must be provided via the value property"):new D("Expressions cannot return objects - objects must be provided via the value property");if(typeof i=="string"){if(!isNaN(Number(i)))return new L(i);throw new D("Expressions cannot return strings - strings must be provided via the value property")}if(i instanceof L)return i;if(typeof i=="number")return new L(i);if(typeof i=="boolean"||i===null)return i;throw new D(`Unsupported expression result type: ${typeof i}`)}catch(e){throw e instanceof we?e:new Error(`Failed to evaluate expression: ${e instanceof Error?e.message:String(e)}`)}},Bn=t=>typeof t!="string"?{valid:!1,error:"Variable name must be a string"}:t===""?{valid:!1,error:"Variable name cannot be empty"}:t.startsWith("$")?{valid:!1,error:"Variable names cannot start with $ (reserved for system namespaces)"}:t.startsWith("__")?{valid:!1,error:"Variable names cannot start with __ (reserved for security reasons)"}:["true","false","null","Infinity"].includes(t)?{valid:!1,error:`Variable name cannot be a reserved value: ${t}`}:/^\d/.test(t)?{valid:!1,error:"Variable names cannot start with a number"}:t.includes(".")?{valid:!1,error:"Variable names cannot contain dots (dots are only for property access in expressions)"}:/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(t)?{valid:!0}:{valid:!1,error:"Variable name contains invalid characters (only letters, digits, underscore, or $ allowed)"},Xn=t=>{if(typeof t!="string")return{valid:!1,error:"Expression must be a string"};const r=t.trim();if(r==="")return{valid:!1,error:"Expression cannot be empty"};try{return Kt(r),{valid:!0}}catch(e){if(e.location){const{line:n,column:i}=e.location.start;return{valid:!1,error:`Parse error at line ${n}, column ${i}: ${e.message}`,line:n,column:i}}return{valid:!1,error:`Parse error: ${e.message||String(e)}`}}},zn=async t=>{if(!Array.isArray(t))throw new ne("Input must be an array");for(const a of t){if(!a||typeof a!="object")throw new ne("Each input must be an object");if(typeof a.name!="string"||!a.name)throw new ne('Each input must have a non-empty string "name"');const c=Bn(a.name);if(!c.valid)throw new ne(`${c.error}: ${a.name}`,a.name);if(!a.expr&&a.value===void 0)throw new ne(`Each input must have either "expr" or "value": ${a.name}`,a.name);if(a.expr!==void 0&&typeof a.expr!="string")throw new ne(`"expr" must be a string if provided: ${a.name}`,a.name)}const r=new Set;for(const a of t){if(r.has(a.name))throw new ne(`Duplicate name: ${a.name}`,a.name);r.add(a.name)}const{order:e,asts:n}=_n(t),i=new Map;for(const a of t)a.value!==void 0&&i.set(a.name,a.value);const s=Object.create(null),f=Object.create(null);for(const a of e){let c;if(i.has(a))c=i.get(a);else{const u=n.get(a);if(!u)throw new Error(`No expression or value found for: ${a}`);c=await Zn(u,f)}c instanceof L||typeof c=="boolean"||c===null?(s[a]=c,f[a]=c):(f[a]=c,typeof c=="number"&&(s[a]=new L(c)))}return{values:s,order:e}};export{ft as CircularDependencyError,L as Decimal,we as EvallaError,D as EvaluationError,me as ParseError,Ue as SecurityError,ne as ValidationError,Xn as checkSyntax,Bn as checkVariableName,zn as evalla};
