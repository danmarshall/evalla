import{r as ce}from"./index.DiEladB3.js";var Nt={exports:{}},qe={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wt;function sr(){if(Wt)return qe;Wt=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var l in i)l!=="key"&&(s[l]=i[l])}else s=i;return i=s.ref,{$$typeof:e,type:r,key:o,ref:i!==void 0?i:null,props:s}}return qe.Fragment=n,qe.jsx=t,qe.jsxs=t,qe}var Zt;function ir(){return Zt||(Zt=1,Nt.exports=sr()),Nt.exports}var h=ir();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=e=>{const n=or(e);return n.charAt(0).toUpperCase()+n.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=e=>{for(const n in e)if(n.startsWith("aria-")||n==="role"||n==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=ce.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...l},c)=>ce.createElement("svg",{ref:c,...lr,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:ln("lucide",i),...!s&&!cr(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,m])=>ce.createElement(u,m)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=(e,n)=>{const t=ce.forwardRef(({className:r,...i},s)=>ce.createElement(ur,{ref:s,iconNode:n,className:ln(`lucide-${ar(zt(e))}`,`lucide-${e}`,r),...i}));return t.displayName=zt(e),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],pr=Ce("download",fr);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Qt=Ce("file-text",dr);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],hr=Ce("play",mr);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Kt=Ce("plus",gr);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Xe=Ce("trash-2",xr);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],en=Ce("upload",Er);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],tn=Ce("x",Nr),nn={circle:{name:"Circle calculations",expressions:[{name:"radius",expr:"5",mode:"expr"},{name:"pi",expr:"$math.PI",mode:"expr"},{name:"circumference",expr:"2 * pi * radius",mode:"expr"},{name:"area",expr:"pi * radius * radius",mode:"expr"}]},arrayLiterals:{name:"Arrays via value property",expressions:[{name:"data",value:[10,20,30,40,50],mode:"value"},{name:"first",expr:"data[0]",mode:"expr"},{name:"last",expr:"data[4]",mode:"expr"},{name:"sum",expr:"data[0] + data[1] + data[2] + data[3] + data[4]",mode:"expr"},{name:"average",expr:"sum / 5",mode:"expr"}]},objectProperties:{name:"Object properties with dot notation",expressions:[{name:"point",value:{x:10,y:20},mode:"value"},{name:"scaledX",expr:"point.x * 2",mode:"expr"},{name:"scaledY",expr:"point.y * 2",mode:"expr"},{name:"distance",expr:"$math.sqrt(point.x**2 + point.y**2)",mode:"expr"}]},nestedObjects:{name:"Nested objects with dot notation",expressions:[{name:"config",value:{display:{width:1920,height:1080},scale:2},mode:"value"},{name:"scaledWidth",expr:"config.display.width / config.scale",mode:"expr"},{name:"scaledHeight",expr:"config.display.height / config.scale",mode:"expr"},{name:"aspectRatio",expr:"config.display.width / config.display.height",mode:"expr"}]},precision:{name:"Decimal precision",expressions:[{name:"a",expr:"0.1"},{name:"b",expr:"0.2"},{name:"sum",expr:"a + b"}]},trig:{name:"Trigonometry",expressions:[{name:"degrees",expr:"45"},{name:"radians",expr:"$angle.toRad(degrees)"},{name:"sine",expr:"$math.sin(radians)"},{name:"cosine",expr:"$math.cos(radians)"}]},mathConstants:{name:"$math - Constants",expressions:[{name:"pi",expr:"$math.PI"},{name:"e",expr:"$math.E"},{name:"sqrt2",expr:"$math.SQRT2"},{name:"ln2",expr:"$math.LN2"},{name:"log2e",expr:"$math.LOG2E"}]},mathBasic:{name:"$math - Basic functions",expressions:[{name:"absVal",expr:"$math.abs(-42)"},{name:"sqrtVal",expr:"$math.sqrt(144)"},{name:"cbrtVal",expr:"$math.cbrt(27)"},{name:"floorVal",expr:"$math.floor(4.9)"},{name:"ceilVal",expr:"$math.ceil(4.1)"},{name:"roundVal",expr:"$math.round(4.5)"}]},mathAdvanced:{name:"$math - Powers & logs",expressions:[{name:"base",expr:"2"},{name:"exponent",expr:"10"},{name:"power",expr:"$math.pow(base, exponent)"},{name:"log2",expr:"$math.log2(power)"},{name:"ln",expr:"$math.ln($math.E)"},{name:"log10",expr:"$math.log10(1000)"}]},mathMinMax:{name:"$math - Min/Max with arrays",expressions:[{name:"values",value:[42,17,99,8],mode:"value"},{name:"minVal",expr:"$math.min(values[0], values[1], values[2], values[3])",mode:"expr"},{name:"maxVal",expr:"$math.max(values[0], values[1], values[2], values[3])",mode:"expr"},{name:"range",expr:"maxVal - minVal",mode:"expr"}]},trigAdvanced:{name:"$math - Advanced trig",expressions:[{name:"angle",expr:"30"},{name:"rad",expr:"$angle.toRad(angle)"},{name:"tanVal",expr:"$math.tan(rad)"},{name:"atanVal",expr:"$math.atan(tanVal)"},{name:"backToDeg",expr:"$angle.toDeg(atanVal)"}]},unitLength:{name:"$unit - Length conversions",expressions:[{name:"mm",expr:"25.4"},{name:"inches",expr:"$unit.mmToInch(mm)"},{name:"cm",expr:"mm / 10"},{name:"inchesFromCm",expr:"$unit.cmToInch(cm)"},{name:"meters",expr:"1"},{name:"feet",expr:"$unit.mToFt(meters)"}]},unitRoundTrip:{name:"$unit - Round-trip test",expressions:[{name:"original",expr:"100"},{name:"toInch",expr:"$unit.mmToInch(original)"},{name:"backToMm",expr:"$unit.inchToMm(toInch)"},{name:"difference",expr:"backToMm - original"}]},angleConversions:{name:"$angle - Conversions",expressions:[{name:"deg0",expr:"0"},{name:"deg90",expr:"90"},{name:"deg180",expr:"180"},{name:"deg360",expr:"360"},{name:"rad90",expr:"$angle.toRad(deg90)"},{name:"rad180",expr:"$angle.toRad(deg180)"},{name:"backTo180",expr:"$angle.toDeg(rad180)"}]},pythagorean:{name:"Pythagorean theorem",expressions:[{name:"a",expr:"3"},{name:"b",expr:"4"},{name:"aSquared",expr:"$math.pow(a, 2)"},{name:"bSquared",expr:"$math.pow(b, 2)"},{name:"cSquared",expr:"aSquared + bSquared"},{name:"c",expr:"$math.sqrt(cSquared)"}]},compoundInterest:{name:"Compound interest",expressions:[{name:"principal",expr:"1000"},{name:"rate",expr:"0.05"},{name:"years",expr:"10"},{name:"e",expr:"$math.E"},{name:"amount",expr:"principal * $math.pow(e, rate * years)"},{name:"interest",expr:"amount - principal"}]},nestedArrays:{name:"Nested arrays (matrices)",expressions:[{name:"matrix",value:[[1,2,3],[4,5,6],[7,8,9]],mode:"value"},{name:"topLeft",expr:"matrix[0][0]",mode:"expr"},{name:"center",expr:"matrix[1][1]",mode:"expr"},{name:"bottomRight",expr:"matrix[2][2]",mode:"expr"},{name:"diagonal",expr:"topLeft + center + bottomRight",mode:"expr"}]},stressDependencies:{name:"Stress test - Dependencies",expressions:[{name:"a",expr:"1"},{name:"b",expr:"a + 1"},{name:"c",expr:"b + 1"},{name:"d",expr:"c + 1"},{name:"e",expr:"d + 1"},{name:"f",expr:"e + 1"},{name:"g",expr:"f + 1"},{name:"h",expr:"g + 1"},{name:"i",expr:"h + 1"},{name:"j",expr:"i + 1"},{name:"sum",expr:"a + b + c + d + e + f + g + h + i + j"}]},stressMath:{name:"Stress test - Math ops",expressions:[{name:"n",expr:"1000000"},{name:"sqrt",expr:"$math.sqrt(n)"},{name:"log",expr:"$math.log10(n)"},{name:"power",expr:"$math.pow(sqrt, 2)"},{name:"nested",expr:"$math.sqrt($math.sqrt($math.sqrt(n)))"},{name:"combo",expr:"$math.max(sqrt, log, $math.min(power, nested))"}]},orderIndependent1:{name:"Order independence - Basic",expressions:[{name:"result",expr:"a + b + c"},{name:"c",expr:"30"},{name:"a",expr:"10"},{name:"b",expr:"20"}]},orderIndependent2:{name:"Order independence - Complex",expressions:[{name:"final",expr:"step3 * 2"},{name:"step1",expr:"base + 5"},{name:"step3",expr:"step2 + step1"},{name:"base",expr:"10"},{name:"step2",expr:"base * 2"}]},orderIndependent3:{name:"Order independence - Mixed",expressions:[{name:"total",expr:"subtotal + tax"},{name:"subtotal",expr:"price * quantity"},{name:"quantity",expr:"5"},{name:"tax",expr:"subtotal * taxRate"},{name:"price",expr:"19.99"},{name:"taxRate",expr:"0.08"}]},booleanSlope:{name:"Boolean - Is it steep?",expressions:[{name:"rise",expr:"15"},{name:"run",expr:"20"},{name:"slope",expr:"rise / run"},{name:"isSteep",expr:"slope > 0.5"},{name:"label",expr:"isSteep ? slope : null"}]},booleanComparisons:{name:"Boolean - Comparisons",expressions:[{name:"a",expr:"10"},{name:"b",expr:"20"},{name:"less",expr:"a < b"},{name:"greater",expr:"a > b"},{name:"equal",expr:"a = b"},{name:"notEqual",expr:"a != b"}]},booleanLogic:{name:"Boolean - Logical ops",expressions:[{name:"x",expr:"15"},{name:"inRange",expr:"x > 10 && x < 20"},{name:"outOfRange",expr:"x < 10 || x > 20"},{name:"valid",expr:"!outOfRange"}]},equalityOperators:{name:"Equality - Single & double",expressions:[{name:"x",expr:"5"},{name:"y",expr:"5"},{name:"z",expr:"10"},{name:"singleEq",expr:"x = y"},{name:"doubleEq",expr:"x == y"},{name:"calculated",expr:"(x + 5) = z"}]},reservedValues:{name:"Reserved values in action",expressions:[{name:"enabled",expr:"true"},{name:"disabled",expr:"false"},{name:"missing",expr:"null"},{name:"result",expr:"enabled && !disabled"},{name:"fallback",expr:"missing ?? 42"}]},ternaryBoolean:{name:"Ternary with boolean branches",expressions:[{name:"score",expr:"85"},{name:"passed",expr:"score >= 60 ? true : false"},{name:"grade",expr:"score >= 90 ? 100 : score"},{name:"bonus",expr:"score >= 90 ? 10 : null"}]}};/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var Me=9e15,Ie=1e9,_t="0123456789abcdef",Qe="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ke="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",wt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Me,maxE:Me,crypto:!1},cn,ve,D=!0,nt="[DecimalError] ",Pe=nt+"Invalid argument: ",un=nt+"Precision limit exceeded",fn=nt+"crypto unavailable",pn="[object Decimal]",le=Math.floor,ne=Math.pow,Ar=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,_r=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,wr=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,dn=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,de=1e7,L=7,Rr=9007199254740991,vr=Qe.length-1,Rt=Ke.length-1,w={toStringTag:pn};w.absoluteValue=w.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),$(e)};w.ceil=function(){return $(new this.constructor(this),this.e+1,2)};w.clampedTo=w.clamp=function(e,n){var t,r=this,i=r.constructor;if(e=new i(e),n=new i(n),!e.s||!n.s)return new i(NaN);if(e.gt(n))throw Error(Pe+n);return t=r.cmp(e),t<0?e:r.cmp(n)>0?n:new i(r)};w.comparedTo=w.cmp=function(e){var n,t,r,i,s=this,o=s.d,l=(e=new s.constructor(e)).d,c=s.s,u=e.s;if(!o||!l)return!c||!u?NaN:c!==u?c:o===l?0:!o^c<0?1:-1;if(!o[0]||!l[0])return o[0]?c:l[0]?-u:0;if(c!==u)return c;if(s.e!==e.e)return s.e>e.e^c<0?1:-1;for(r=o.length,i=l.length,n=0,t=r<i?r:i;n<t;++n)if(o[n]!==l[n])return o[n]>l[n]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};w.cosine=w.cos=function(){var e,n,t=this,r=t.constructor;return t.d?t.d[0]?(e=r.precision,n=r.rounding,r.precision=e+Math.max(t.e,t.sd())+L,r.rounding=1,t=br(r,En(r,t)),r.precision=e,r.rounding=n,$(ve==2||ve==3?t.neg():t,e,n,!0)):new r(1):new r(NaN)};w.cubeRoot=w.cbrt=function(){var e,n,t,r,i,s,o,l,c,u,m=this,N=m.constructor;if(!m.isFinite()||m.isZero())return new N(m);for(D=!1,s=m.s*ne(m.s*m,1/3),!s||Math.abs(s)==1/0?(t=ie(m.d),e=m.e,(s=(e-t.length+1)%3)&&(t+=s==1||s==-2?"0":"00"),s=ne(t,1/3),e=le((e+1)/3)-(e%3==(e<0?-1:2)),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new N(t),r.s=m.s):r=new N(s.toString()),o=(e=N.precision)+3;;)if(l=r,c=l.times(l).times(l),u=c.plus(m),r=z(u.plus(m).times(l),u.plus(c),o+2,1),ie(l.d).slice(0,o)===(t=ie(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&($(l,e+1,0),l.times(l).times(l).eq(m))){r=l;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&($(r,e+1,1),n=!r.times(r).times(r).eq(m));break}return D=!0,$(r,e,N.rounding,n)};w.decimalPlaces=w.dp=function(){var e,n=this.d,t=NaN;if(n){if(e=n.length-1,t=(e-le(this.e/L))*L,e=n[e],e)for(;e%10==0;e/=10)t--;t<0&&(t=0)}return t};w.dividedBy=w.div=function(e){return z(this,new this.constructor(e))};w.dividedToIntegerBy=w.divToInt=function(e){var n=this,t=n.constructor;return $(z(n,new t(e),0,1,1),t.precision,t.rounding)};w.equals=w.eq=function(e){return this.cmp(e)===0};w.floor=function(){return $(new this.constructor(this),this.e+1,3)};w.greaterThan=w.gt=function(e){return this.cmp(e)>0};w.greaterThanOrEqualTo=w.gte=function(e){var n=this.cmp(e);return n==1||n===0};w.hyperbolicCosine=w.cosh=function(){var e,n,t,r,i,s=this,o=s.constructor,l=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return l;t=o.precision,r=o.rounding,o.precision=t+Math.max(s.e,s.sd())+4,o.rounding=1,i=s.d.length,i<32?(e=Math.ceil(i/3),n=(1/st(4,e)).toString()):(e=16,n="2.3283064365386962890625e-10"),s=ke(o,1,s.times(n),new o(1),!0);for(var c,u=e,m=new o(8);u--;)c=s.times(s),s=l.minus(c.times(m.minus(c.times(m))));return $(s,o.precision=t,o.rounding=r,!0)};w.hyperbolicSine=w.sinh=function(){var e,n,t,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(n=s.precision,t=s.rounding,s.precision=n+Math.max(i.e,i.sd())+4,s.rounding=1,r=i.d.length,r<3)i=ke(s,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/st(5,e)),i=ke(s,2,i,i,!0);for(var o,l=new s(5),c=new s(16),u=new s(20);e--;)o=i.times(i),i=i.times(l.plus(o.times(c.times(o).plus(u))))}return s.precision=n,s.rounding=t,$(i,n,t,!0)};w.hyperbolicTangent=w.tanh=function(){var e,n,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(e=r.precision,n=r.rounding,r.precision=e+7,r.rounding=1,z(t.sinh(),t.cosh(),r.precision=e,r.rounding=n)):new r(t.s)};w.inverseCosine=w.acos=function(){var e=this,n=e.constructor,t=e.abs().cmp(1),r=n.precision,i=n.rounding;return t!==-1?t===0?e.isNeg()?xe(n,r,i):new n(0):new n(NaN):e.isZero()?xe(n,r+4,i).times(.5):(n.precision=r+6,n.rounding=1,e=new n(1).minus(e).div(e.plus(1)).sqrt().atan(),n.precision=r,n.rounding=i,e.times(2))};w.inverseHyperbolicCosine=w.acosh=function(){var e,n,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(e=r.precision,n=r.rounding,r.precision=e+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,D=!1,t=t.times(t).minus(1).sqrt().plus(t),D=!0,r.precision=e,r.rounding=n,t.ln()):new r(t)};w.inverseHyperbolicSine=w.asinh=function(){var e,n,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(e=r.precision,n=r.rounding,r.precision=e+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,D=!1,t=t.times(t).plus(1).sqrt().plus(t),D=!0,r.precision=e,r.rounding=n,t.ln())};w.inverseHyperbolicTangent=w.atanh=function(){var e,n,t,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=s.precision,n=s.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?$(new s(i),e,n,!0):(s.precision=t=r-i.e,i=z(i.plus(1),new s(1).minus(i),t+e,1),s.precision=e+4,s.rounding=1,i=i.ln(),s.precision=e,s.rounding=n,i.times(.5))):new s(NaN)};w.inverseSine=w.asin=function(){var e,n,t,r,i=this,s=i.constructor;return i.isZero()?new s(i):(n=i.abs().cmp(1),t=s.precision,r=s.rounding,n!==-1?n===0?(e=xe(s,t+4,r).times(.5),e.s=i.s,e):new s(NaN):(s.precision=t+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=t,s.rounding=r,i.times(2)))};w.inverseTangent=w.atan=function(){var e,n,t,r,i,s,o,l,c,u=this,m=u.constructor,N=m.precision,E=m.rounding;if(u.isFinite()){if(u.isZero())return new m(u);if(u.abs().eq(1)&&N+4<=Rt)return o=xe(m,N+4,E).times(.25),o.s=u.s,o}else{if(!u.s)return new m(NaN);if(N+4<=Rt)return o=xe(m,N+4,E).times(.5),o.s=u.s,o}for(m.precision=l=N+10,m.rounding=1,t=Math.min(28,l/L+2|0),e=t;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(D=!1,n=Math.ceil(l/L),r=1,c=u.times(u),o=new m(u),i=u;e!==-1;)if(i=i.times(c),s=o.minus(i.div(r+=2)),i=i.times(c),o=s.plus(i.div(r+=2)),o.d[n]!==void 0)for(e=n;o.d[e]===s.d[e]&&e--;);return t&&(o=o.times(2<<t-1)),D=!0,$(o,m.precision=N,m.rounding=E,!0)};w.isFinite=function(){return!!this.d};w.isInteger=w.isInt=function(){return!!this.d&&le(this.e/L)>this.d.length-2};w.isNaN=function(){return!this.s};w.isNegative=w.isNeg=function(){return this.s<0};w.isPositive=w.isPos=function(){return this.s>0};w.isZero=function(){return!!this.d&&this.d[0]===0};w.lessThan=w.lt=function(e){return this.cmp(e)<0};w.lessThanOrEqualTo=w.lte=function(e){return this.cmp(e)<1};w.logarithm=w.log=function(e){var n,t,r,i,s,o,l,c,u=this,m=u.constructor,N=m.precision,E=m.rounding,v=5;if(e==null)e=new m(10),n=!0;else{if(e=new m(e),t=e.d,e.s<0||!t||!t[0]||e.eq(1))return new m(NaN);n=e.eq(10)}if(t=u.d,u.s<0||!t||!t[0]||u.eq(1))return new m(t&&!t[0]?-1/0:u.s!=1?NaN:t?0:1/0);if(n)if(t.length>1)s=!0;else{for(i=t[0];i%10===0;)i/=10;s=i!==1}if(D=!1,l=N+v,o=ye(u,l),r=n?et(m,l+10):ye(e,l),c=z(o,r,l,1),Ye(c.d,i=N,E))do if(l+=10,o=ye(u,l),r=n?et(m,l+10):ye(e,l),c=z(o,r,l,1),!s){+ie(c.d).slice(i+1,i+15)+1==1e14&&(c=$(c,N+1,0));break}while(Ye(c.d,i+=10,E));return D=!0,$(c,N,E)};w.minus=w.sub=function(e){var n,t,r,i,s,o,l,c,u,m,N,E,v=this,U=v.constructor;if(e=new U(e),!v.d||!e.d)return!v.s||!e.s?e=new U(NaN):v.d?e.s=-e.s:e=new U(e.d||v.s!==e.s?v:NaN),e;if(v.s!=e.s)return e.s=-e.s,v.plus(e);if(u=v.d,E=e.d,l=U.precision,c=U.rounding,!u[0]||!E[0]){if(E[0])e.s=-e.s;else if(u[0])e=new U(v);else return new U(c===3?-0:0);return D?$(e,l,c):e}if(t=le(e.e/L),m=le(v.e/L),u=u.slice(),s=m-t,s){for(N=s<0,N?(n=u,s=-s,o=E.length):(n=E,t=m,o=u.length),r=Math.max(Math.ceil(l/L),o)+2,s>r&&(s=r,n.length=1),n.reverse(),r=s;r--;)n.push(0);n.reverse()}else{for(r=u.length,o=E.length,N=r<o,N&&(o=r),r=0;r<o;r++)if(u[r]!=E[r]){N=u[r]<E[r];break}s=0}for(N&&(n=u,u=E,E=n,e.s=-e.s),o=u.length,r=E.length-o;r>0;--r)u[o++]=0;for(r=E.length;r>s;){if(u[--r]<E[r]){for(i=r;i&&u[--i]===0;)u[i]=de-1;--u[i],u[r]+=de}u[r]-=E[r]}for(;u[--o]===0;)u.pop();for(;u[0]===0;u.shift())--t;return u[0]?(e.d=u,e.e=rt(u,t),D?$(e,l,c):e):new U(c===3?-0:0)};w.modulo=w.mod=function(e){var n,t=this,r=t.constructor;return e=new r(e),!t.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||t.d&&!t.d[0]?$(new r(t),r.precision,r.rounding):(D=!1,r.modulo==9?(n=z(t,e.abs(),0,3,1),n.s*=e.s):n=z(t,e,0,r.modulo,1),n=n.times(e),D=!0,t.minus(n))};w.naturalExponential=w.exp=function(){return vt(this)};w.naturalLogarithm=w.ln=function(){return ye(this)};w.negated=w.neg=function(){var e=new this.constructor(this);return e.s=-e.s,$(e)};w.plus=w.add=function(e){var n,t,r,i,s,o,l,c,u,m,N=this,E=N.constructor;if(e=new E(e),!N.d||!e.d)return!N.s||!e.s?e=new E(NaN):N.d||(e=new E(e.d||N.s===e.s?N:NaN)),e;if(N.s!=e.s)return e.s=-e.s,N.minus(e);if(u=N.d,m=e.d,l=E.precision,c=E.rounding,!u[0]||!m[0])return m[0]||(e=new E(N)),D?$(e,l,c):e;if(s=le(N.e/L),r=le(e.e/L),u=u.slice(),i=s-r,i){for(i<0?(t=u,i=-i,o=m.length):(t=m,r=s,o=u.length),s=Math.ceil(l/L),o=s>o?s+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=u.length,i=m.length,o-i<0&&(i=o,t=m,m=u,u=t),n=0;i;)n=(u[--i]=u[i]+m[i]+n)/de|0,u[i]%=de;for(n&&(u.unshift(n),++r),o=u.length;u[--o]==0;)u.pop();return e.d=u,e.e=rt(u,r),D?$(e,l,c):e};w.precision=w.sd=function(e){var n,t=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Pe+e);return t.d?(n=mn(t.d),e&&t.e+1>n&&(n=t.e+1)):n=NaN,n};w.round=function(){var e=this,n=e.constructor;return $(new n(e),e.e+1,n.rounding)};w.sine=w.sin=function(){var e,n,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(e=r.precision,n=r.rounding,r.precision=e+Math.max(t.e,t.sd())+L,r.rounding=1,t=Or(r,En(r,t)),r.precision=e,r.rounding=n,$(ve>2?t.neg():t,e,n,!0)):new r(NaN)};w.squareRoot=w.sqrt=function(){var e,n,t,r,i,s,o=this,l=o.d,c=o.e,u=o.s,m=o.constructor;if(u!==1||!l||!l[0])return new m(!u||u<0&&(!l||l[0])?NaN:l?o:1/0);for(D=!1,u=Math.sqrt(+o),u==0||u==1/0?(n=ie(l),(n.length+c)%2==0&&(n+="0"),u=Math.sqrt(n),c=le((c+1)/2)-(c<0||c%2),u==1/0?n="5e"+c:(n=u.toExponential(),n=n.slice(0,n.indexOf("e")+1)+c),r=new m(n)):r=new m(u.toString()),t=(c=m.precision)+3;;)if(s=r,r=s.plus(z(o,s,t+2,1)).times(.5),ie(s.d).slice(0,t)===(n=ie(r.d)).slice(0,t))if(n=n.slice(t-3,t+1),n=="9999"||!i&&n=="4999"){if(!i&&($(s,c+1,0),s.times(s).eq(o))){r=s;break}t+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&($(r,c+1,1),e=!r.times(r).eq(o));break}return D=!0,$(r,c,m.rounding,e)};w.tangent=w.tan=function(){var e,n,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(e=r.precision,n=r.rounding,r.precision=e+10,r.rounding=1,t=t.sin(),t.s=1,t=z(t,new r(1).minus(t.times(t)).sqrt(),e+10,0),r.precision=e,r.rounding=n,$(ve==2||ve==4?t.neg():t,e,n,!0)):new r(NaN)};w.times=w.mul=function(e){var n,t,r,i,s,o,l,c,u,m=this,N=m.constructor,E=m.d,v=(e=new N(e)).d;if(e.s*=m.s,!E||!E[0]||!v||!v[0])return new N(!e.s||E&&!E[0]&&!v||v&&!v[0]&&!E?NaN:!E||!v?e.s/0:e.s*0);for(t=le(m.e/L)+le(e.e/L),c=E.length,u=v.length,c<u&&(s=E,E=v,v=s,o=c,c=u,u=o),s=[],o=c+u,r=o;r--;)s.push(0);for(r=u;--r>=0;){for(n=0,i=c+r;i>r;)l=s[i]+v[r]*E[i-r-1]+n,s[i--]=l%de|0,n=l/de|0;s[i]=(s[i]+n)%de|0}for(;!s[--o];)s.pop();return n?++t:s.shift(),e.d=s,e.e=rt(s,t),D?$(e,N.precision,N.rounding):e};w.toBinary=function(e,n){return bt(this,2,e,n)};w.toDecimalPlaces=w.toDP=function(e,n){var t=this,r=t.constructor;return t=new r(t),e===void 0?t:(ue(e,0,Ie),n===void 0?n=r.rounding:ue(n,0,8),$(t,e+t.e+1,n))};w.toExponential=function(e,n){var t,r=this,i=r.constructor;return e===void 0?t=Ee(r,!0):(ue(e,0,Ie),n===void 0?n=i.rounding:ue(n,0,8),r=$(new i(r),e+1,n),t=Ee(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+t:t};w.toFixed=function(e,n){var t,r,i=this,s=i.constructor;return e===void 0?t=Ee(i):(ue(e,0,Ie),n===void 0?n=s.rounding:ue(n,0,8),r=$(new s(i),e+i.e+1,n),t=Ee(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};w.toFraction=function(e){var n,t,r,i,s,o,l,c,u,m,N,E,v=this,U=v.d,P=v.constructor;if(!U)return new P(v);if(u=t=new P(1),r=c=new P(0),n=new P(r),s=n.e=mn(U)-v.e-1,o=s%L,n.d[0]=ne(10,o<0?L+o:o),e==null)e=s>0?n:u;else{if(l=new P(e),!l.isInt()||l.lt(u))throw Error(Pe+l);e=l.gt(n)?s>0?n:u:l}for(D=!1,l=new P(ie(U)),m=P.precision,P.precision=s=U.length*L*2;N=z(l,n,0,1,1),i=t.plus(N.times(r)),i.cmp(e)!=1;)t=r,r=i,i=u,u=c.plus(N.times(i)),c=i,i=n,n=l.minus(N.times(i)),l=i;return i=z(e.minus(t),r,0,1,1),c=c.plus(i.times(u)),t=t.plus(i.times(r)),c.s=u.s=v.s,E=z(u,r,s,1).minus(v).abs().cmp(z(c,t,s,1).minus(v).abs())<1?[u,r]:[c,t],P.precision=m,D=!0,E};w.toHexadecimal=w.toHex=function(e,n){return bt(this,16,e,n)};w.toNearest=function(e,n){var t=this,r=t.constructor;if(t=new r(t),e==null){if(!t.d)return t;e=new r(1),n=r.rounding}else{if(e=new r(e),n===void 0?n=r.rounding:ue(n,0,8),!t.d)return e.s?t:e;if(!e.d)return e.s&&(e.s=t.s),e}return e.d[0]?(D=!1,t=z(t,e,0,n,1).times(e),D=!0,$(t)):(e.s=t.s,t=e),t};w.toNumber=function(){return+this};w.toOctal=function(e,n){return bt(this,8,e,n)};w.toPower=w.pow=function(e){var n,t,r,i,s,o,l=this,c=l.constructor,u=+(e=new c(e));if(!l.d||!e.d||!l.d[0]||!e.d[0])return new c(ne(+l,u));if(l=new c(l),l.eq(1))return l;if(r=c.precision,s=c.rounding,e.eq(1))return $(l,r,s);if(n=le(e.e/L),n>=e.d.length-1&&(t=u<0?-u:u)<=Rr)return i=hn(c,l,t,r),e.s<0?new c(1).div(i):$(i,r,s);if(o=l.s,o<0){if(n<e.d.length-1)return new c(NaN);if((e.d[n]&1)==0&&(o=1),l.e==0&&l.d[0]==1&&l.d.length==1)return l.s=o,l}return t=ne(+l,u),n=t==0||!isFinite(t)?le(u*(Math.log("0."+ie(l.d))/Math.LN10+l.e+1)):new c(t+"").e,n>c.maxE+1||n<c.minE-1?new c(n>0?o/0:0):(D=!1,c.rounding=l.s=1,t=Math.min(12,(n+"").length),i=vt(e.times(ye(l,r+t)),r),i.d&&(i=$(i,r+5,1),Ye(i.d,r,s)&&(n=r+10,i=$(vt(e.times(ye(l,n+t)),n),n+5,1),+ie(i.d).slice(r+1,r+15)+1==1e14&&(i=$(i,r+1,0)))),i.s=o,D=!0,c.rounding=s,$(i,r,s))};w.toPrecision=function(e,n){var t,r=this,i=r.constructor;return e===void 0?t=Ee(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(ue(e,1,Ie),n===void 0?n=i.rounding:ue(n,0,8),r=$(new i(r),e,n),t=Ee(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+t:t};w.toSignificantDigits=w.toSD=function(e,n){var t=this,r=t.constructor;return e===void 0?(e=r.precision,n=r.rounding):(ue(e,1,Ie),n===void 0?n=r.rounding:ue(n,0,8)),$(new r(t),e,n)};w.toString=function(){var e=this,n=e.constructor,t=Ee(e,e.e<=n.toExpNeg||e.e>=n.toExpPos);return e.isNeg()&&!e.isZero()?"-"+t:t};w.truncated=w.trunc=function(){return $(new this.constructor(this),this.e+1,1)};w.valueOf=w.toJSON=function(){var e=this,n=e.constructor,t=Ee(e,e.e<=n.toExpNeg||e.e>=n.toExpPos);return e.isNeg()?"-"+t:t};function ie(e){var n,t,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,n=1;n<i;n++)r=e[n]+"",t=L-r.length,t&&(s+=Se(t)),s+=r;o=e[n],r=o+"",t=L-r.length,t&&(s+=Se(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}function ue(e,n,t){if(e!==~~e||e<n||e>t)throw Error(Pe+e)}function Ye(e,n,t,r){var i,s,o,l;for(s=e[0];s>=10;s/=10)--n;return--n<0?(n+=L,i=0):(i=Math.ceil((n+1)/L),n%=L),s=ne(10,L-n),l=e[i]%s|0,r==null?n<3?(n==0?l=l/100|0:n==1&&(l=l/10|0),o=t<4&&l==99999||t>3&&l==49999||l==5e4||l==0):o=(t<4&&l+1==s||t>3&&l+1==s/2)&&(e[i+1]/s/100|0)==ne(10,n-2)-1||(l==s/2||l==0)&&(e[i+1]/s/100|0)==0:n<4?(n==0?l=l/1e3|0:n==1?l=l/100|0:n==2&&(l=l/10|0),o=(r||t<4)&&l==9999||!r&&t>3&&l==4999):o=((r||t<4)&&l+1==s||!r&&t>3&&l+1==s/2)&&(e[i+1]/s/1e3|0)==ne(10,n-3)-1,o}function We(e,n,t){for(var r,i=[0],s,o=0,l=e.length;o<l;){for(s=i.length;s--;)i[s]*=n;for(i[0]+=_t.indexOf(e.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function br(e,n){var t,r,i;if(n.isZero())return n;r=n.d.length,r<32?(t=Math.ceil(r/3),i=(1/st(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),e.precision+=t,n=ke(e,1,n.times(i),new e(1));for(var s=t;s--;){var o=n.times(n);n=o.times(o).minus(o).times(8).plus(1)}return e.precision-=t,n}var z=(function(){function e(r,i,s){var o,l=0,c=r.length;for(r=r.slice();c--;)o=r[c]*i+l,r[c]=o%s|0,l=o/s|0;return l&&r.unshift(l),r}function n(r,i,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(r[l]!=i[l]){c=r[l]>i[l]?1:-1;break}return c}function t(r,i,s,o){for(var l=0;s--;)r[s]-=l,l=r[s]<i[s]?1:0,r[s]=l*o+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o,l,c){var u,m,N,E,v,U,P,J,F,re,k,X,fe,se,Ne,Ae,me,be,ae,_e,he=r.constructor,Te=r.s==i.s?1:-1,te=r.d,V=i.d;if(!te||!te[0]||!V||!V[0])return new he(!r.s||!i.s||(te?V&&te[0]==V[0]:!V)?NaN:te&&te[0]==0||!V?Te*0:Te/0);for(c?(v=1,m=r.e-i.e):(c=de,v=L,m=le(r.e/v)-le(i.e/v)),ae=V.length,me=te.length,F=new he(Te),re=F.d=[],N=0;V[N]==(te[N]||0);N++);if(V[N]>(te[N]||0)&&m--,s==null?(se=s=he.precision,o=he.rounding):l?se=s+(r.e-i.e)+1:se=s,se<0)re.push(1),U=!0;else{if(se=se/v+2|0,N=0,ae==1){for(E=0,V=V[0],se++;(N<me||E)&&se--;N++)Ne=E*c+(te[N]||0),re[N]=Ne/V|0,E=Ne%V|0;U=E||N<me}else{for(E=c/(V[0]+1)|0,E>1&&(V=e(V,E,c),te=e(te,E,c),ae=V.length,me=te.length),Ae=ae,k=te.slice(0,ae),X=k.length;X<ae;)k[X++]=0;_e=V.slice(),_e.unshift(0),be=V[0],V[1]>=c/2&&++be;do E=0,u=n(V,k,ae,X),u<0?(fe=k[0],ae!=X&&(fe=fe*c+(k[1]||0)),E=fe/be|0,E>1?(E>=c&&(E=c-1),P=e(V,E,c),J=P.length,X=k.length,u=n(P,k,J,X),u==1&&(E--,t(P,ae<J?_e:V,J,c))):(E==0&&(u=E=1),P=V.slice()),J=P.length,J<X&&P.unshift(0),t(k,P,X,c),u==-1&&(X=k.length,u=n(V,k,ae,X),u<1&&(E++,t(k,ae<X?_e:V,X,c))),X=k.length):u===0&&(E++,k=[0]),re[N++]=E,u&&k[0]?k[X++]=te[Ae]||0:(k=[te[Ae]],X=1);while((Ae++<me||k[0]!==void 0)&&se--);U=k[0]!==void 0}re[0]||re.shift()}if(v==1)F.e=m,cn=U;else{for(N=1,E=re[0];E>=10;E/=10)N++;F.e=N+m*v-1,$(F,l?s+F.e+1:s,o,U)}return F}})();function $(e,n,t,r){var i,s,o,l,c,u,m,N,E,v=e.constructor;e:if(n!=null){if(N=e.d,!N)return e;for(i=1,l=N[0];l>=10;l/=10)i++;if(s=n-i,s<0)s+=L,o=n,m=N[E=0],c=m/ne(10,i-o-1)%10|0;else if(E=Math.ceil((s+1)/L),l=N.length,E>=l)if(r){for(;l++<=E;)N.push(0);m=c=0,i=1,s%=L,o=s-L+1}else break e;else{for(m=l=N[E],i=1;l>=10;l/=10)i++;s%=L,o=s-L+i,c=o<0?0:m/ne(10,i-o-1)%10|0}if(r=r||n<0||N[E+1]!==void 0||(o<0?m:m%ne(10,i-o-1)),u=t<4?(c||r)&&(t==0||t==(e.s<0?3:2)):c>5||c==5&&(t==4||r||t==6&&(s>0?o>0?m/ne(10,i-o):0:N[E-1])%10&1||t==(e.s<0?8:7)),n<1||!N[0])return N.length=0,u?(n-=e.e+1,N[0]=ne(10,(L-n%L)%L),e.e=-n||0):N[0]=e.e=0,e;if(s==0?(N.length=E,l=1,E--):(N.length=E+1,l=ne(10,L-s),N[E]=o>0?(m/ne(10,i-o)%ne(10,o)|0)*l:0),u)for(;;)if(E==0){for(s=1,o=N[0];o>=10;o/=10)s++;for(o=N[0]+=l,l=1;o>=10;o/=10)l++;s!=l&&(e.e++,N[0]==de&&(N[0]=1));break}else{if(N[E]+=l,N[E]!=de)break;N[E--]=0,l=1}for(s=N.length;N[--s]===0;)N.pop()}return D&&(e.e>v.maxE?(e.d=null,e.e=NaN):e.e<v.minE&&(e.e=0,e.d=[0])),e}function Ee(e,n,t){if(!e.isFinite())return xn(e);var r,i=e.e,s=ie(e.d),o=s.length;return n?(t&&(r=t-o)>0?s=s.charAt(0)+"."+s.slice(1)+Se(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(e.e<0?"e":"e+")+e.e):i<0?(s="0."+Se(-i-1)+s,t&&(r=t-o)>0&&(s+=Se(r))):i>=o?(s+=Se(i+1-o),t&&(r=t-i-1)>0&&(s=s+"."+Se(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(s+="."),s+=Se(r))),s}function rt(e,n){var t=e[0];for(n*=L;t>=10;t/=10)n++;return n}function et(e,n,t){if(n>vr)throw D=!0,t&&(e.precision=t),Error(un);return $(new e(Qe),n,1,!0)}function xe(e,n,t){if(n>Rt)throw Error(un);return $(new e(Ke),n,t,!0)}function mn(e){var n=e.length-1,t=n*L+1;if(n=e[n],n){for(;n%10==0;n/=10)t--;for(n=e[0];n>=10;n/=10)t++}return t}function Se(e){for(var n="";e--;)n+="0";return n}function hn(e,n,t,r){var i,s=new e(1),o=Math.ceil(r/L+4);for(D=!1;;){if(t%2&&(s=s.times(n),sn(s.d,o)&&(i=!0)),t=le(t/2),t===0){t=s.d.length-1,i&&s.d[t]===0&&++s.d[t];break}n=n.times(n),sn(n.d,o)}return D=!0,s}function rn(e){return e.d[e.d.length-1]&1}function gn(e,n,t){for(var r,i,s=new e(n[0]),o=0;++o<n.length;){if(i=new e(n[o]),!i.s){s=i;break}r=s.cmp(i),(r===t||r===0&&s.s===t)&&(s=i)}return s}function vt(e,n){var t,r,i,s,o,l,c,u=0,m=0,N=0,E=e.constructor,v=E.rounding,U=E.precision;if(!e.d||!e.d[0]||e.e>17)return new E(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(n==null?(D=!1,c=U):c=n,l=new E(.03125);e.e>-2;)e=e.times(l),N+=5;for(r=Math.log(ne(2,N))/Math.LN10*2+5|0,c+=r,t=s=o=new E(1),E.precision=c;;){if(s=$(s.times(e),c,1),t=t.times(++m),l=o.plus(z(s,t,c,1)),ie(l.d).slice(0,c)===ie(o.d).slice(0,c)){for(i=N;i--;)o=$(o.times(o),c,1);if(n==null)if(u<3&&Ye(o.d,c-r,v,u))E.precision=c+=10,t=s=l=new E(1),m=0,u++;else return $(o,E.precision=U,v,D=!0);else return E.precision=U,o}o=l}}function ye(e,n){var t,r,i,s,o,l,c,u,m,N,E,v=1,U=10,P=e,J=P.d,F=P.constructor,re=F.rounding,k=F.precision;if(P.s<0||!J||!J[0]||!P.e&&J[0]==1&&J.length==1)return new F(J&&!J[0]?-1/0:P.s!=1?NaN:J?0:P);if(n==null?(D=!1,m=k):m=n,F.precision=m+=U,t=ie(J),r=t.charAt(0),Math.abs(s=P.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)P=P.times(e),t=ie(P.d),r=t.charAt(0),v++;s=P.e,r>1?(P=new F("0."+t),s++):P=new F(r+"."+t.slice(1))}else return u=et(F,m+2,k).times(s+""),P=ye(new F(r+"."+t.slice(1)),m-U).plus(u),F.precision=k,n==null?$(P,k,re,D=!0):P;for(N=P,c=o=P=z(P.minus(1),P.plus(1),m,1),E=$(P.times(P),m,1),i=3;;){if(o=$(o.times(E),m,1),u=c.plus(z(o,new F(i),m,1)),ie(u.d).slice(0,m)===ie(c.d).slice(0,m))if(c=c.times(2),s!==0&&(c=c.plus(et(F,m+2,k).times(s+""))),c=z(c,new F(v),m,1),n==null)if(Ye(c.d,m-U,re,l))F.precision=m+=U,u=o=P=z(N.minus(1),N.plus(1),m,1),E=$(P.times(P),m,1),i=l=1;else return $(c,F.precision=k,re,D=!0);else return F.precision=k,c;c=u,i+=2}}function xn(e){return String(e.s*e.s/0)}function Ze(e,n){var t,r,i;for((t=n.indexOf("."))>-1&&(n=n.replace(".","")),(r=n.search(/e/i))>0?(t<0&&(t=r),t+=+n.slice(r+1),n=n.substring(0,r)):t<0&&(t=n.length),r=0;n.charCodeAt(r)===48;r++);for(i=n.length;n.charCodeAt(i-1)===48;--i);if(n=n.slice(r,i),n){if(i-=r,e.e=t=t-r-1,e.d=[],r=(t+1)%L,t<0&&(r+=L),r<i){for(r&&e.d.push(+n.slice(0,r)),i-=L;r<i;)e.d.push(+n.slice(r,r+=L));n=n.slice(r),r=L-n.length}else r-=i;for(;r--;)n+="0";e.d.push(+n),D&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Tr(e,n){var t,r,i,s,o,l,c,u,m;if(n.indexOf("_")>-1){if(n=n.replace(/(\d)_(?=\d)/g,"$1"),dn.test(n))return Ze(e,n)}else if(n==="Infinity"||n==="NaN")return+n||(e.s=NaN),e.e=NaN,e.d=null,e;if(_r.test(n))t=16,n=n.toLowerCase();else if(Ar.test(n))t=2;else if(wr.test(n))t=8;else throw Error(Pe+n);for(s=n.search(/p/i),s>0?(c=+n.slice(s+1),n=n.substring(2,s)):n=n.slice(2),s=n.indexOf("."),o=s>=0,r=e.constructor,o&&(n=n.replace(".",""),l=n.length,s=l-s,i=hn(r,new r(t),s,s*2)),u=We(n,t,de),m=u.length-1,s=m;u[s]===0;--s)u.pop();return s<0?new r(e.s*0):(e.e=rt(u,m),e.d=u,D=!1,o&&(e=z(e,i,l*4)),c&&(e=e.times(Math.abs(c)<54?ne(2,c):B.pow(2,c))),D=!0,e)}function Or(e,n){var t,r=n.d.length;if(r<3)return n.isZero()?n:ke(e,2,n,n);t=1.4*Math.sqrt(r),t=t>16?16:t|0,n=n.times(1/st(5,t)),n=ke(e,2,n,n);for(var i,s=new e(5),o=new e(16),l=new e(20);t--;)i=n.times(n),n=n.times(s.plus(i.times(o.times(i).minus(l))));return n}function ke(e,n,t,r,i){var s,o,l,c,u=e.precision,m=Math.ceil(u/L);for(D=!1,c=t.times(t),l=new e(r);;){if(o=z(l.times(c),new e(n++*n++),u,1),l=i?r.plus(o):r.minus(o),r=z(o.times(c),new e(n++*n++),u,1),o=l.plus(r),o.d[m]!==void 0){for(s=m;o.d[s]===l.d[s]&&s--;);if(s==-1)break}s=l,l=r,r=o,o=s}return D=!0,o.d.length=m+1,o}function st(e,n){for(var t=e;--n;)t*=e;return t}function En(e,n){var t,r=n.s<0,i=xe(e,e.precision,1),s=i.times(.5);if(n=n.abs(),n.lte(s))return ve=r?4:1,n;if(t=n.divToInt(i),t.isZero())ve=r?3:2;else{if(n=n.minus(t.times(i)),n.lte(s))return ve=rn(t)?r?2:3:r?4:1,n;ve=rn(t)?r?1:4:r?3:2}return n.minus(i).abs()}function bt(e,n,t,r){var i,s,o,l,c,u,m,N,E,v=e.constructor,U=t!==void 0;if(U?(ue(t,1,Ie),r===void 0?r=v.rounding:ue(r,0,8)):(t=v.precision,r=v.rounding),!e.isFinite())m=xn(e);else{for(m=Ee(e),o=m.indexOf("."),U?(i=2,n==16?t=t*4-3:n==8&&(t=t*3-2)):i=n,o>=0&&(m=m.replace(".",""),E=new v(1),E.e=m.length-o,E.d=We(Ee(E),10,i),E.e=E.d.length),N=We(m,10,i),s=c=N.length;N[--c]==0;)N.pop();if(!N[0])m=U?"0p+0":"0";else{if(o<0?s--:(e=new v(e),e.d=N,e.e=s,e=z(e,E,t,r,0,i),N=e.d,s=e.e,u=cn),o=N[t],l=i/2,u=u||N[t+1]!==void 0,u=r<4?(o!==void 0||u)&&(r===0||r===(e.s<0?3:2)):o>l||o===l&&(r===4||u||r===6&&N[t-1]&1||r===(e.s<0?8:7)),N.length=t,u)for(;++N[--t]>i-1;)N[t]=0,t||(++s,N.unshift(1));for(c=N.length;!N[c-1];--c);for(o=0,m="";o<c;o++)m+=_t.charAt(N[o]);if(U){if(c>1)if(n==16||n==8){for(o=n==16?4:3,--c;c%o;c++)m+="0";for(N=We(m,i,n),c=N.length;!N[c-1];--c);for(o=1,m="1.";o<c;o++)m+=_t.charAt(N[o])}else m=m.charAt(0)+"."+m.slice(1);m=m+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)m="0"+m;m="0."+m}else if(++s>c)for(s-=c;s--;)m+="0";else s<c&&(m=m.slice(0,s)+"."+m.slice(s))}m=(n==16?"0x":n==2?"0b":n==8?"0o":"")+m}return e.s<0?"-"+m:m}function sn(e,n){if(e.length>n)return e.length=n,!0}function Sr(e){return new this(e).abs()}function yr(e){return new this(e).acos()}function Pr(e){return new this(e).acosh()}function Ir(e,n){return new this(e).plus(n)}function $r(e){return new this(e).asin()}function Cr(e){return new this(e).asinh()}function jr(e){return new this(e).atan()}function Ur(e){return new this(e).atanh()}function Lr(e,n){e=new this(e),n=new this(n);var t,r=this.precision,i=this.rounding,s=r+4;return!e.s||!n.s?t=new this(NaN):!e.d&&!n.d?(t=xe(this,s,1).times(n.s>0?.25:.75),t.s=e.s):!n.d||e.isZero()?(t=n.s<0?xe(this,r,i):new this(0),t.s=e.s):!e.d||n.isZero()?(t=xe(this,s,1).times(.5),t.s=e.s):n.s<0?(this.precision=s,this.rounding=1,t=this.atan(z(e,n,s,1)),n=xe(this,s,1),this.precision=r,this.rounding=i,t=e.s<0?t.minus(n):t.plus(n)):t=this.atan(z(e,n,s,1)),t}function Dr(e){return new this(e).cbrt()}function Mr(e){return $(e=new this(e),e.e+1,2)}function kr(e,n,t){return new this(e).clamp(n,t)}function Br(e){if(!e||typeof e!="object")throw Error(nt+"Object expected");var n,t,r,i=e.defaults===!0,s=["precision",1,Ie,"rounding",0,8,"toExpNeg",-Me,0,"toExpPos",0,Me,"maxE",0,Me,"minE",-Me,0,"modulo",0,9];for(n=0;n<s.length;n+=3)if(t=s[n],i&&(this[t]=wt[t]),(r=e[t])!==void 0)if(le(r)===r&&r>=s[n+1]&&r<=s[n+2])this[t]=r;else throw Error(Pe+t+": "+r);if(t="crypto",i&&(this[t]=wt[t]),(r=e[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(fn);else this[t]=!1;else throw Error(Pe+t+": "+r);return this}function Vr(e){return new this(e).cos()}function Fr(e){return new this(e).cosh()}function Nn(e){var n,t,r;function i(s){var o,l,c,u=this;if(!(u instanceof i))return new i(s);if(u.constructor=i,an(s)){u.s=s.s,D?!s.d||s.e>i.maxE?(u.e=NaN,u.d=null):s.e<i.minE?(u.e=0,u.d=[0]):(u.e=s.e,u.d=s.d.slice()):(u.e=s.e,u.d=s.d?s.d.slice():s.d);return}if(c=typeof s,c==="number"){if(s===0){u.s=1/s<0?-1:1,u.e=0,u.d=[0];return}if(s<0?(s=-s,u.s=-1):u.s=1,s===~~s&&s<1e7){for(o=0,l=s;l>=10;l/=10)o++;D?o>i.maxE?(u.e=NaN,u.d=null):o<i.minE?(u.e=0,u.d=[0]):(u.e=o,u.d=[s]):(u.e=o,u.d=[s]);return}if(s*0!==0){s||(u.s=NaN),u.e=NaN,u.d=null;return}return Ze(u,s.toString())}if(c==="string")return(l=s.charCodeAt(0))===45?(s=s.slice(1),u.s=-1):(l===43&&(s=s.slice(1)),u.s=1),dn.test(s)?Ze(u,s):Tr(u,s);if(c==="bigint")return s<0?(s=-s,u.s=-1):u.s=1,Ze(u,s.toString());throw Error(Pe+s)}if(i.prototype=w,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Br,i.clone=Nn,i.isDecimal=an,i.abs=Sr,i.acos=yr,i.acosh=Pr,i.add=Ir,i.asin=$r,i.asinh=Cr,i.atan=jr,i.atanh=Ur,i.atan2=Lr,i.cbrt=Dr,i.ceil=Mr,i.clamp=kr,i.cos=Vr,i.cosh=Fr,i.div=qr,i.exp=Yr,i.floor=Hr,i.hypot=Gr,i.ln=Jr,i.log=Xr,i.log10=Zr,i.log2=Wr,i.max=zr,i.min=Qr,i.mod=Kr,i.mul=es,i.pow=ts,i.random=ns,i.round=rs,i.sign=ss,i.sin=is,i.sinh=as,i.sqrt=os,i.sub=ls,i.sum=cs,i.tan=us,i.tanh=fs,i.trunc=ps,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<r.length;)e.hasOwnProperty(t=r[n++])||(e[t]=this[t]);return i.config(e),i}function qr(e,n){return new this(e).div(n)}function Yr(e){return new this(e).exp()}function Hr(e){return $(e=new this(e),e.e+1,3)}function Gr(){var e,n,t=new this(0);for(D=!1,e=0;e<arguments.length;)if(n=new this(arguments[e++]),n.d)t.d&&(t=t.plus(n.times(n)));else{if(n.s)return D=!0,new this(1/0);t=n}return D=!0,t.sqrt()}function an(e){return e instanceof B||e&&e.toStringTag===pn||!1}function Jr(e){return new this(e).ln()}function Xr(e,n){return new this(e).log(n)}function Wr(e){return new this(e).log(2)}function Zr(e){return new this(e).log(10)}function zr(){return gn(this,arguments,-1)}function Qr(){return gn(this,arguments,1)}function Kr(e,n){return new this(e).mod(n)}function es(e,n){return new this(e).mul(n)}function ts(e,n){return new this(e).pow(n)}function ns(e){var n,t,r,i,s=0,o=new this(1),l=[];if(e===void 0?e=this.precision:ue(e,1,Ie),r=Math.ceil(e/L),this.crypto)if(crypto.getRandomValues)for(n=crypto.getRandomValues(new Uint32Array(r));s<r;)i=n[s],i>=429e7?n[s]=crypto.getRandomValues(new Uint32Array(1))[0]:l[s++]=i%1e7;else if(crypto.randomBytes){for(n=crypto.randomBytes(r*=4);s<r;)i=n[s]+(n[s+1]<<8)+(n[s+2]<<16)+((n[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(n,s):(l.push(i%1e7),s+=4);s=r/4}else throw Error(fn);else for(;s<r;)l[s++]=Math.random()*1e7|0;for(r=l[--s],e%=L,r&&e&&(i=ne(10,L-e),l[s]=(r/i|0)*i);l[s]===0;s--)l.pop();if(s<0)t=0,l=[0];else{for(t=-1;l[0]===0;t-=L)l.shift();for(r=1,i=l[0];i>=10;i/=10)r++;r<L&&(t-=L-r)}return o.e=t,o.d=l,o}function rs(e){return $(e=new this(e),e.e+1,this.rounding)}function ss(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function is(e){return new this(e).sin()}function as(e){return new this(e).sinh()}function os(e){return new this(e).sqrt()}function ls(e,n){return new this(e).sub(n)}function cs(){var e=0,n=arguments,t=new this(n[e]);for(D=!1;t.s&&++e<n.length;)t=t.plus(n[e]);return D=!0,$(t,this.precision,this.rounding)}function us(e){return new this(e).tan()}function fs(e){return new this(e).tanh()}function ps(e){return $(e=new this(e),e.e+1,1)}w[Symbol.for("nodejs.util.inspect.custom")]=w.toString;w[Symbol.toStringTag]="Decimal";var B=w.constructor=Nn(wt);Qe=new B(Qe);Ke=new B(Ke);class on extends SyntaxError{constructor(n,t,r,i){super(n),this.expected=t,this.found=r,this.location=i,this.name="SyntaxError"}format(n){let t="Error: "+this.message;if(this.location){let r=null;const i=n.find(c=>c.source===this.location.source);i&&(r=i.text.split(/\r\n|\n|\r/g));const s=this.location.start,o=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(s):s,l=this.location.source+":"+o.line+":"+o.column;if(r){const c=this.location.end,u="".padEnd(o.line.toString().length," "),m=r[s.line-1],E=(s.line===c.line?c.column:m.length+1)-s.column||1;t+=`
 --> `+l+`
`+u+` |
`+o.line+" | "+m+`
`+u+" | "+"".padEnd(s.column-1," ")+"".padEnd(E,"^")}else t+=`
 at `+l}return t}static buildMessage(n,t){function r(E){return E.codePointAt(0).toString(16).toUpperCase()}const i=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function s(E){return i?E.replace(i,v=>"\\u{"+r(v)+"}"):E}function o(E){return s(E.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,v=>"\\x0"+r(v)).replace(/[\x10-\x1F\x7F-\x9F]/g,v=>"\\x"+r(v)))}function l(E){return s(E.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,v=>"\\x0"+r(v)).replace(/[\x10-\x1F\x7F-\x9F]/g,v=>"\\x"+r(v)))}const c={literal(E){return'"'+o(E.text)+'"'},class(E){const v=E.parts.map(U=>Array.isArray(U)?l(U[0])+"-"+l(U[1]):l(U));return"["+(E.inverted?"^":"")+v.join("")+"]"+(E.unicode?"u":"")},any(){return"any character"},end(){return"end of input"},other(E){return E.description}};function u(E){return c[E.type](E)}function m(E){const v=E.map(u);if(v.sort(),v.length>0){let U=1;for(let P=1;P<v.length;P++)v[P-1]!==v[P]&&(v[U]=v[P],U++);v.length=U}switch(v.length){case 1:return v[0];case 2:return v[0]+" or "+v[1];default:return v.slice(0,-1).join(", ")+", or "+v[v.length-1]}}function N(E){return E?'"'+o(E)+'"':"end of input"}return"Expected "+m(n)+" but "+N(t)+" found."}}function An(e,n){n=n!==void 0?n:{};const t={},r=n.grammarSource,i={Expression:Oe};let s=Oe;const o="?",l=":",c="||",u="??",m="&&",N="!=",E="==",v="=",U="<=",P=">=",J="**",F="(",re=")",k="[",X="]",fe=".",se='"',Ne="'",Ae=",",me="true",be="false",ae="null",_e=/^[<>]/,he=/^[+\-]/,Te=/^[%*\/]/,te=/^[!+\-]/,V=/^[0-9]/,Ue=/^[eE]/,g=/^[a-zA-Z0-9_$]/,O=/^[a-zA-Z_$]/,I=/^[ \t\n\r]/,j=ee("?",!1),M=ee(":",!1),Y=ee("||",!1),G=ee("??",!1),K=ee("&&",!1),q=ee("!=",!1),Z=ee("==",!1),Q=ee("=",!1),Ot=ee("<=",!1),St=ee(">=",!1),yt=we(["<",">"],!1,!1,!1),at=we(["+","-"],!1,!1,!1),Pt=we(["%","*","/"],!1,!1,!1),wn=ee("**",!1),Rn=we(["!","+","-"],!1,!1,!1),ot=ee("(",!1),lt=ee(")",!1),It=ee("[",!1),$t=ee("]",!1),ct=ee(".",!1),ut=ee('"',!1),ft=ee("'",!1),Ct=Xn(),jt=ee(",",!1),Le=we([["0","9"]],!1,!1,!1),vn=we(["e","E"],!1,!1,!1),bn=ee("true",!1),Be=we([["a","z"],["A","Z"],["0","9"],"_","$"],!1,!1,!1),Tn=ee("false",!1),On=ee("null",!1),Sn=we([["a","z"],["A","Z"],"_","$"],!1,!1,!1),Ut=we([" ","	",`
`,"\r"],!1,!1,!1);function ys(f){return f}function yn(f,d,A){return{type:"ConditionalExpression",test:f,consequent:d,alternate:A}}function Pn(f,d){return d.reduce((A,p)=>({type:"LogicalExpression",operator:p[1],left:A,right:p[3]}),f)}function In(f,d){return d.reduce((A,p)=>({type:"LogicalExpression",operator:p[1],left:A,right:p[3]}),f)}function $n(f,d){return Je(f,d)}function Cn(f,d){return Je(f,d)}function jn(f,d){return Je(f,d)}function Un(f,d){return Je(f,d)}function Ln(f,d){return d?{type:"BinaryExpression",operator:"**",left:f,right:d[3]}:f}function Dn(f,d){return{type:"UnaryExpression",operator:f,argument:d,prefix:!0}}function Lt(f,d){return{type:"call",args:d||[]}}function Dt(f,d){return{type:"member",property:d,computed:!0}}function Mt(f,d){return{type:"member",property:d,computed:!1}}function Mn(f,d){return d.reduce((A,p)=>p.type==="call"?{type:"CallExpression",callee:A,arguments:p.args}:{type:"MemberExpression",object:A,property:p.property,computed:p.computed},f)}function kn(f){return{type:"Literal",value:f.join(""),raw:'"'+f.join("")+'"'}}function Bn(f){return{type:"Literal",value:f.join(""),raw:"'"+f.join("")+"'"}}function Ps(f){return f}function Is(f){return f}function Vn(f,d){return[f].concat(d.map(A=>A[3]))}function $s(f){return f}function Fn(f){return{type:"Literal",value:parseFloat(f),raw:f}}function qn(){return{type:"Literal",value:!0,raw:"true"}}function Yn(){return{type:"Literal",value:!1,raw:"false"}}function Hn(){return{type:"Literal",value:null,raw:"null"}}function Gn(f){return{type:"Identifier",name:f}}let a=n.peg$currPos|0;const De=[{line:1,column:1}];let pe=a,He=n.peg$maxFailExpected||[],b=n.peg$silentFails|0,Ve;if(n.startRule){if(!(n.startRule in i))throw new Error(`Can't start parsing from rule "`+n.startRule+'".');s=i[n.startRule]}function Jn(f=a){const d=e.codePointAt(f);return d===void 0?"":String.fromCodePoint(d)}function ee(f,d){return{type:"literal",text:f,ignoreCase:d}}function we(f,d,A,p){return{type:"class",parts:f,inverted:d,ignoreCase:A,unicode:p}}function Xn(){return{type:"any"}}function Wn(){return{type:"end"}}function kt(f){let d=De[f],A;if(d)return d;if(f>=De.length)A=De.length-1;else for(A=f;!De[--A];);for(d=De[A],d={line:d.line,column:d.column};A<f;)e.charCodeAt(A)===10?(d.line++,d.column=1):d.column++,A++;return De[f]=d,d}function Bt(f,d,A){const p=kt(f),_=kt(d);return{source:r,start:{offset:f,line:p.line,column:p.column},end:{offset:d,line:_.line,column:_.column}}}function T(f){a<pe||(a>pe&&(pe=a,He=[]),He.push(f))}function Zn(f,d,A){return new on(on.buildMessage(f,d),f,d,A)}function Oe(){let f,d;return f=a,C(),d=Vt(),d!==t?(C(),f=d):(a=f,f=t),f}function Vt(){let f,d,A,p,_,x;return f=a,d=Ft(),d!==t?(C(),e.charCodeAt(a)===63?(A=o,a++):(A=t,b===0&&T(j)),A!==t?(C(),p=Oe(),p!==t?(C(),e.charCodeAt(a)===58?(_=l,a++):(_=t,b===0&&T(M)),_!==t?(C(),x=Vt(),x!==t?f=yn(d,p,x):(a=f,f=t)):(a=f,f=t)):(a=f,f=t)):(a=f,f=t)):(a=f,f=t),f===t&&(f=Ft()),f}function Ft(){let f,d,A,p,_,x,S,y;if(f=a,d=pt(),d!==t){for(A=[],p=a,_=C(),e.substr(a,2)===c?(x=c,a+=2):(x=t,b===0&&T(Y)),x===t&&(e.substr(a,2)===u?(x=u,a+=2):(x=t,b===0&&T(G))),x!==t?(S=C(),y=pt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);p!==t;)A.push(p),p=a,_=C(),e.substr(a,2)===c?(x=c,a+=2):(x=t,b===0&&T(Y)),x===t&&(e.substr(a,2)===u?(x=u,a+=2):(x=t,b===0&&T(G))),x!==t?(S=C(),y=pt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);f=Pn(d,A)}else a=f,f=t;return f}function pt(){let f,d,A,p,_,x,S,y;if(f=a,d=dt(),d!==t){for(A=[],p=a,_=C(),e.substr(a,2)===m?(x=m,a+=2):(x=t,b===0&&T(K)),x!==t?(S=C(),y=dt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);p!==t;)A.push(p),p=a,_=C(),e.substr(a,2)===m?(x=m,a+=2):(x=t,b===0&&T(K)),x!==t?(S=C(),y=dt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);f=In(d,A)}else a=f,f=t;return f}function dt(){let f,d,A,p,_,x,S,y;if(f=a,d=mt(),d!==t){for(A=[],p=a,_=C(),e.substr(a,2)===N?(x=N,a+=2):(x=t,b===0&&T(q)),x===t&&(e.substr(a,2)===E?(x=E,a+=2):(x=t,b===0&&T(Z)),x===t&&(e.charCodeAt(a)===61?(x=v,a++):(x=t,b===0&&T(Q)))),x!==t?(S=C(),y=mt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);p!==t;)A.push(p),p=a,_=C(),e.substr(a,2)===N?(x=N,a+=2):(x=t,b===0&&T(q)),x===t&&(e.substr(a,2)===E?(x=E,a+=2):(x=t,b===0&&T(Z)),x===t&&(e.charCodeAt(a)===61?(x=v,a++):(x=t,b===0&&T(Q)))),x!==t?(S=C(),y=mt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);f=$n(d,A)}else a=f,f=t;return f}function mt(){let f,d,A,p,_,x,S,y;if(f=a,d=ht(),d!==t){for(A=[],p=a,_=C(),e.substr(a,2)===U?(x=U,a+=2):(x=t,b===0&&T(Ot)),x===t&&(e.substr(a,2)===P?(x=P,a+=2):(x=t,b===0&&T(St)),x===t&&(x=e.charAt(a),_e.test(x)?a++:(x=t,b===0&&T(yt)))),x!==t?(S=C(),y=ht(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);p!==t;)A.push(p),p=a,_=C(),e.substr(a,2)===U?(x=U,a+=2):(x=t,b===0&&T(Ot)),x===t&&(e.substr(a,2)===P?(x=P,a+=2):(x=t,b===0&&T(St)),x===t&&(x=e.charAt(a),_e.test(x)?a++:(x=t,b===0&&T(yt)))),x!==t?(S=C(),y=ht(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);f=Cn(d,A)}else a=f,f=t;return f}function ht(){let f,d,A,p,_,x,S,y;if(f=a,d=gt(),d!==t){for(A=[],p=a,_=C(),x=e.charAt(a),he.test(x)?a++:(x=t,b===0&&T(at)),x!==t?(S=C(),y=gt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);p!==t;)A.push(p),p=a,_=C(),x=e.charAt(a),he.test(x)?a++:(x=t,b===0&&T(at)),x!==t?(S=C(),y=gt(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);f=jn(d,A)}else a=f,f=t;return f}function gt(){let f,d,A,p,_,x,S,y;if(f=a,d=Ge(),d!==t){for(A=[],p=a,_=C(),x=e.charAt(a),Te.test(x)?a++:(x=t,b===0&&T(Pt)),x!==t?(S=C(),y=Ge(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);p!==t;)A.push(p),p=a,_=C(),x=e.charAt(a),Te.test(x)?a++:(x=t,b===0&&T(Pt)),x!==t?(S=C(),y=Ge(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);f=Un(d,A)}else a=f,f=t;return f}function Ge(){let f,d,A,p,_,x,S;return f=a,d=qt(),d!==t?(A=a,p=C(),e.substr(a,2)===J?(_=J,a+=2):(_=t,b===0&&T(wn)),_!==t?(x=C(),S=Ge(),S!==t?(p=[p,_,x,S],A=p):(a=A,A=t)):(a=A,A=t),A===t&&(A=null),f=Ln(d,A)):(a=f,f=t),f}function qt(){let f,d,A;return f=a,d=e.charAt(a),te.test(d)?a++:(d=t,b===0&&T(Rn)),d!==t?(C(),A=qt(),A!==t?f=Dn(d,A):(a=f,f=t)):(a=f,f=t),f===t&&(f=zn()),f}function zn(){let f,d,A,p,_,x,S;if(f=a,d=Kn(),d!==t){for(A=[],p=a,C(),e.charCodeAt(a)===40?(_=F,a++):(_=t,b===0&&T(ot)),_!==t?(C(),x=Jt(),x===t&&(x=null),C(),e.charCodeAt(a)===41?(S=re,a++):(S=t,b===0&&T(lt)),S!==t?p=Lt(d,x):(a=p,p=t)):(a=p,p=t),p===t&&(p=a,C(),e.charCodeAt(a)===91?(_=k,a++):(_=t,b===0&&T(It)),_!==t?(C(),x=Yt(),x!==t?(C(),e.charCodeAt(a)===93?(S=X,a++):(S=t,b===0&&T($t)),S!==t?p=Dt(d,x):(a=p,p=t)):(a=p,p=t)):(a=p,p=t),p===t&&(p=a,C(),e.charCodeAt(a)===46?(_=fe,a++):(_=t,b===0&&T(ct)),_!==t?(C(),x=xt(),x!==t?p=Mt(d,x):(a=p,p=t)):(a=p,p=t)));p!==t;)A.push(p),p=a,C(),e.charCodeAt(a)===40?(_=F,a++):(_=t,b===0&&T(ot)),_!==t?(C(),x=Jt(),x===t&&(x=null),C(),e.charCodeAt(a)===41?(S=re,a++):(S=t,b===0&&T(lt)),S!==t?p=Lt(d,x):(a=p,p=t)):(a=p,p=t),p===t&&(p=a,C(),e.charCodeAt(a)===91?(_=k,a++):(_=t,b===0&&T(It)),_!==t?(C(),x=Yt(),x!==t?(C(),e.charCodeAt(a)===93?(S=X,a++):(S=t,b===0&&T($t)),S!==t?p=Dt(d,x):(a=p,p=t)):(a=p,p=t)):(a=p,p=t),p===t&&(p=a,C(),e.charCodeAt(a)===46?(_=fe,a++):(_=t,b===0&&T(ct)),_!==t?(C(),x=xt(),x!==t?p=Mt(d,x):(a=p,p=t)):(a=p,p=t)));f=Mn(d,A)}else a=f,f=t;return f}function Yt(){let f;return f=Qn(),f===t&&(f=Oe()),f}function Qn(){let f,d,A,p;if(f=a,e.charCodeAt(a)===34?(d=se,a++):(d=t,b===0&&T(ut)),d!==t){for(A=[],p=Ht();p!==t;)A.push(p),p=Ht();e.charCodeAt(a)===34?(p=se,a++):(p=t,b===0&&T(ut)),p!==t?f=kn(A):(a=f,f=t)}else a=f,f=t;if(f===t)if(f=a,e.charCodeAt(a)===39?(d=Ne,a++):(d=t,b===0&&T(ft)),d!==t){for(A=[],p=Gt();p!==t;)A.push(p),p=Gt();e.charCodeAt(a)===39?(p=Ne,a++):(p=t,b===0&&T(ft)),p!==t?f=Bn(A):(a=f,f=t)}else a=f,f=t;return f}function Ht(){let f,d,A;return f=a,d=a,b++,e.charCodeAt(a)===34?(A=se,a++):(A=t,b===0&&T(ut)),b--,A===t?d=void 0:(a=d,d=t),d!==t?(e.length>a?(A=e.charAt(a),a++):(A=t,b===0&&T(Ct)),A!==t?f=A:(a=f,f=t)):(a=f,f=t),f}function Gt(){let f,d,A;return f=a,d=a,b++,e.charCodeAt(a)===39?(A=Ne,a++):(A=t,b===0&&T(ft)),b--,A===t?d=void 0:(a=d,d=t),d!==t?(e.length>a?(A=e.charAt(a),a++):(A=t,b===0&&T(Ct)),A!==t?f=A:(a=f,f=t)):(a=f,f=t),f}function Jt(){let f,d,A,p,_,x,S,y;if(f=a,d=Oe(),d!==t){for(A=[],p=a,_=C(),e.charCodeAt(a)===44?(x=Ae,a++):(x=t,b===0&&T(jt)),x!==t?(S=C(),y=Oe(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);p!==t;)A.push(p),p=a,_=C(),e.charCodeAt(a)===44?(x=Ae,a++):(x=t,b===0&&T(jt)),x!==t?(S=C(),y=Oe(),y!==t?(_=[_,x,S,y],p=_):(a=p,p=t)):(a=p,p=t);f=Vn(d,A)}else a=f,f=t;return f}function Kn(){let f,d,A,p;return f=er(),f===t&&(f=xt(),f===t&&(f=a,e.charCodeAt(a)===40?(d=F,a++):(d=t,b===0&&T(ot)),d!==t?(C(),A=Oe(),A!==t?(C(),e.charCodeAt(a)===41?(p=re,a++):(p=t,b===0&&T(lt)),p!==t?f=A:(a=f,f=t)):(a=f,f=t)):(a=f,f=t))),f}function er(){let f;return f=tr(),f===t&&(f=nr(),f===t&&(f=rr())),f}function tr(){let f,d,A,p,_,x,S,y,Fe,Re;if(f=a,d=a,A=a,p=[],_=e.charAt(a),V.test(_)?a++:(_=t,b===0&&T(Le)),_!==t)for(;_!==t;)p.push(_),_=e.charAt(a),V.test(_)?a++:(_=t,b===0&&T(Le));else p=t;if(p!==t){if(_=a,e.charCodeAt(a)===46?(x=fe,a++):(x=t,b===0&&T(ct)),x!==t){if(S=[],y=e.charAt(a),V.test(y)?a++:(y=t,b===0&&T(Le)),y!==t)for(;y!==t;)S.push(y),y=e.charAt(a),V.test(y)?a++:(y=t,b===0&&T(Le));else S=t;S!==t?(x=[x,S],_=x):(a=_,_=t)}else a=_,_=t;if(_===t&&(_=null),x=a,S=e.charAt(a),Ue.test(S)?a++:(S=t,b===0&&T(vn)),S!==t){if(y=e.charAt(a),he.test(y)?a++:(y=t,b===0&&T(at)),y===t&&(y=null),Fe=[],Re=e.charAt(a),V.test(Re)?a++:(Re=t,b===0&&T(Le)),Re!==t)for(;Re!==t;)Fe.push(Re),Re=e.charAt(a),V.test(Re)?a++:(Re=t,b===0&&T(Le));else Fe=t;Fe!==t?(S=[S,y,Fe],x=S):(a=x,x=t)}else a=x,x=t;x===t&&(x=null),p=[p,_,x],A=p}else a=A,A=t;return A!==t?d=e.substring(d,a):d=A,d!==t&&(d=Fn(d)),f=d,f}function nr(){let f,d,A,p;return f=a,e.substr(a,4)===me?(d=me,a+=4):(d=t,b===0&&T(bn)),d!==t?(A=a,b++,p=e.charAt(a),g.test(p)?a++:(p=t,b===0&&T(Be)),b--,p===t?A=void 0:(a=A,A=t),A!==t?f=qn():(a=f,f=t)):(a=f,f=t),f===t&&(f=a,e.substr(a,5)===be?(d=be,a+=5):(d=t,b===0&&T(Tn)),d!==t?(A=a,b++,p=e.charAt(a),g.test(p)?a++:(p=t,b===0&&T(Be)),b--,p===t?A=void 0:(a=A,A=t),A!==t?f=Yn():(a=f,f=t)):(a=f,f=t)),f}function rr(){let f,d,A,p;return f=a,e.substr(a,4)===ae?(d=ae,a+=4):(d=t,b===0&&T(On)),d!==t?(A=a,b++,p=e.charAt(a),g.test(p)?a++:(p=t,b===0&&T(Be)),b--,p===t?A=void 0:(a=A,A=t),A!==t?f=Hn():(a=f,f=t)):(a=f,f=t),f}function xt(){let f,d,A,p,_,x;if(f=a,d=a,A=a,p=e.charAt(a),O.test(p)?a++:(p=t,b===0&&T(Sn)),p!==t){for(_=[],x=e.charAt(a),g.test(x)?a++:(x=t,b===0&&T(Be));x!==t;)_.push(x),x=e.charAt(a),g.test(x)?a++:(x=t,b===0&&T(Be));p=[p,_],A=p}else a=A,A=t;return A!==t?d=e.substring(d,a):d=A,d!==t&&(d=Gn(d)),f=d,f}function C(){let f,d;for(b++,f=[],d=e.charAt(a),I.test(d)?a++:(d=t,b===0&&T(Ut));d!==t;)f.push(d),d=e.charAt(a),I.test(d)?a++:(d=t,b===0&&T(Ut));return b--,f}function Je(f,d){return d.reduce((A,p)=>({type:"BinaryExpression",operator:p[1],left:A,right:p[3]}),f)}Ve=s();const Et=Ve!==t&&a===e.length;function Xt(){throw Ve!==t&&a<e.length&&T(Wn()),Zn(He,pe<e.length?Jn(pe):null,pe<e.length?Bt(pe,pe+1):Bt(pe,pe))}if(n.peg$library)return{peg$result:Ve,peg$currPos:a,peg$FAILED:t,peg$maxFailExpected:He,peg$maxFailPos:pe,peg$success:Et,peg$throw:Et?void 0:Xt};if(Et)return Ve;Xt()}const ds=e=>{const n=new Set,t=r=>{if(!(!r||typeof r!="object"))switch(r.type){case"Identifier":n.add(r.name);break;case"MemberExpression":t(r.object),r.computed&&t(r.property);break;case"BinaryExpression":case"LogicalExpression":t(r.left),t(r.right);break;case"UnaryExpression":t(r.argument);break;case"CallExpression":if(t(r.callee),r.arguments)for(const i of r.arguments)t(i);break;case"ConditionalExpression":t(r.test),t(r.consequent),t(r.alternate);break;case"ArrayExpression":if(r.elements)for(const i of r.elements)t(i);break;case"ObjectExpression":if(r.properties)for(const i of r.properties)i.type==="Property"?(i.computed&&t(i.key),t(i.value)):i.type==="SpreadElement"&&t(i.argument);break}};return t(e),Array.from(n).filter(r=>!r.startsWith("$"))};class je extends Error{constructor(n,t){super(n),this.name="EvallaError",this.cause=t,Object.setPrototypeOf(this,je.prototype)}}class it extends je{constructor(n,t,r){super(n,r),this.name="SecurityError",this.property=t,Object.setPrototypeOf(this,it.prototype)}}class Tt extends je{constructor(n,t,r){super(n,r),this.name="CircularDependencyError",this.cycle=t,Object.setPrototypeOf(this,Tt.prototype)}}class ge extends je{constructor(n,t,r){super(n,r),this.name="ValidationError",this.variableName=t,Object.setPrototypeOf(this,ge.prototype)}}class W extends je{constructor(n,t,r,i){super(n,i),this.name="EvaluationError",this.variableName=t,this.context=r,Object.setPrototypeOf(this,W.prototype)}}class $e extends W{constructor(n,t,r){super(n,t?.variableName,void 0,r),this.name="ParseError",this.expression=t?.expression,this.line=t?.line,this.column=t?.column,this.originalMessage=t?.originalMessage,Object.setPrototypeOf(this,$e.prototype)}}var R;(function(e){e.INPUT_MUST_BE_ARRAY="INPUT_MUST_BE_ARRAY",e.INPUT_MUST_BE_OBJECT="INPUT_MUST_BE_OBJECT",e.INPUT_NAME_REQUIRED="INPUT_NAME_REQUIRED",e.INPUT_EXPR_OR_VALUE_REQUIRED="INPUT_EXPR_OR_VALUE_REQUIRED",e.INPUT_EXPR_MUST_BE_STRING="INPUT_EXPR_MUST_BE_STRING",e.DUPLICATE_NAME="DUPLICATE_NAME",e.VARIABLE_NAME_MUST_BE_STRING="VARIABLE_NAME_MUST_BE_STRING",e.VARIABLE_NAME_EMPTY="VARIABLE_NAME_EMPTY",e.VARIABLE_NAME_WHITESPACE="VARIABLE_NAME_WHITESPACE",e.VARIABLE_NAME_DOLLAR_PREFIX="VARIABLE_NAME_DOLLAR_PREFIX",e.VARIABLE_NAME_DOUBLE_UNDERSCORE="VARIABLE_NAME_DOUBLE_UNDERSCORE",e.VARIABLE_NAME_RESERVED="VARIABLE_NAME_RESERVED",e.VARIABLE_NAME_STARTS_WITH_NUMBER="VARIABLE_NAME_STARTS_WITH_NUMBER",e.VARIABLE_NAME_CONTAINS_DOT="VARIABLE_NAME_CONTAINS_DOT",e.VARIABLE_NAME_INVALID_CHARS="VARIABLE_NAME_INVALID_CHARS",e.PARSE_ERROR="PARSE_ERROR",e.PARSE_ERROR_AT_LOCATION="PARSE_ERROR_AT_LOCATION",e.PARSE_ERROR_FOR_VARIABLE="PARSE_ERROR_FOR_VARIABLE",e.UNDEFINED_VARIABLE="UNDEFINED_VARIABLE",e.UNDEFINED_NAMESPACE_PROPERTY="UNDEFINED_NAMESPACE_PROPERTY",e.CANNOT_ACCESS_PROPERTY="CANNOT_ACCESS_PROPERTY",e.CALLEE_NOT_FUNCTION="CALLEE_NOT_FUNCTION",e.UNSUPPORTED_LOGICAL_OPERATOR="UNSUPPORTED_LOGICAL_OPERATOR",e.UNSUPPORTED_NODE_TYPE="UNSUPPORTED_NODE_TYPE",e.UNSUPPORTED_BINARY_OPERATOR="UNSUPPORTED_BINARY_OPERATOR",e.UNSUPPORTED_UNARY_OPERATOR="UNSUPPORTED_UNARY_OPERATOR",e.NO_AST_FOUND="NO_AST_FOUND",e.FAILED_TO_EVALUATE="FAILED_TO_EVALUATE",e.NAMESPACE_HEAD_AS_VALUE="NAMESPACE_HEAD_AS_VALUE",e.NAMESPACE_HEAD_IN_OPERATION="NAMESPACE_HEAD_IN_OPERATION",e.EXPRESSION_CANNOT_RETURN_ARRAY="EXPRESSION_CANNOT_RETURN_ARRAY",e.EXPRESSION_CANNOT_RETURN_OBJECT="EXPRESSION_CANNOT_RETURN_OBJECT",e.EXPRESSION_CANNOT_RETURN_STRING="EXPRESSION_CANNOT_RETURN_STRING",e.UNSUPPORTED_RESULT_TYPE="UNSUPPORTED_RESULT_TYPE",e.STRING_IN_OPERATION="STRING_IN_OPERATION",e.OBJECT_IN_OPERATION="OBJECT_IN_OPERATION",e.ARRAY_IN_OPERATION="ARRAY_IN_OPERATION",e.STRING_WITH_UNARY="STRING_WITH_UNARY",e.OBJECT_WITH_UNARY="OBJECT_WITH_UNARY",e.ARRAY_WITH_UNARY="ARRAY_WITH_UNARY",e.PROPERTY_ACCESS_DENIED="PROPERTY_ACCESS_DENIED",e.FUNCTION_ALIASING_DENIED="FUNCTION_ALIASING_DENIED",e.CIRCULAR_DEPENDENCY="CIRCULAR_DEPENDENCY",e.DECIMAL_PLACES_INVALID="DECIMAL_PLACES_INVALID",e.EXPRESSION_MUST_BE_STRING="EXPRESSION_MUST_BE_STRING",e.EXPRESSION_EMPTY="EXPRESSION_EMPTY",e.UNSUPPORTED_LANGUAGE="UNSUPPORTED_LANGUAGE"})(R||(R={}));const ms={[R.INPUT_MUST_BE_ARRAY]:"Input must be an array",[R.INPUT_MUST_BE_OBJECT]:"Each input must be an object",[R.INPUT_NAME_REQUIRED]:'Each input must have a non-empty string "name"',[R.INPUT_EXPR_OR_VALUE_REQUIRED]:'Each input must have either "expr" or "value": {variableName}',[R.INPUT_EXPR_MUST_BE_STRING]:'"expr" must be a string if provided: {variableName}',[R.DUPLICATE_NAME]:"Duplicate name: {variableName}",[R.VARIABLE_NAME_MUST_BE_STRING]:"Variable name must be a string",[R.VARIABLE_NAME_EMPTY]:"Variable name cannot be empty",[R.VARIABLE_NAME_WHITESPACE]:"Variable name cannot have leading or trailing whitespace",[R.VARIABLE_NAME_DOLLAR_PREFIX]:"Variable names cannot start with $ (reserved for system namespaces)",[R.VARIABLE_NAME_DOUBLE_UNDERSCORE]:"Variable names cannot start with __ (reserved for security reasons)",[R.VARIABLE_NAME_RESERVED]:"Variable name cannot be a reserved value: {variableName}",[R.VARIABLE_NAME_STARTS_WITH_NUMBER]:"Variable names cannot start with a number",[R.VARIABLE_NAME_CONTAINS_DOT]:"Variable names cannot contain dots (dots are only for property access in expressions)",[R.VARIABLE_NAME_INVALID_CHARS]:"Variable name contains invalid characters (only letters, digits, underscore, or $ allowed)",[R.PARSE_ERROR]:"Parse error: {message}",[R.PARSE_ERROR_AT_LOCATION]:"Parse error at line {line}, column {column}: {message}",[R.PARSE_ERROR_FOR_VARIABLE]:'Failed to parse expression for "{variableName}": {message}',[R.UNDEFINED_VARIABLE]:"Undefined variable: {variableName}",[R.UNDEFINED_NAMESPACE_PROPERTY]:'Undefined property "{property}" in namespace {namespace}',[R.CANNOT_ACCESS_PROPERTY]:"Cannot access property of {value}",[R.CALLEE_NOT_FUNCTION]:"Callee is not a function",[R.UNSUPPORTED_LOGICAL_OPERATOR]:"Unsupported logical operator: {operator}",[R.UNSUPPORTED_NODE_TYPE]:"Unsupported node type: {type}",[R.UNSUPPORTED_BINARY_OPERATOR]:"Unsupported binary operator: {operator}",[R.UNSUPPORTED_UNARY_OPERATOR]:"Unsupported unary operator: {operator}",[R.NO_AST_FOUND]:"No AST found for: {variableName}",[R.FAILED_TO_EVALUATE]:"Failed to evaluate expression: {originalMessage}",[R.NAMESPACE_HEAD_AS_VALUE]:"Cannot use namespace head as a value - namespace heads must be used with property access (e.g., $math.PI) or method calls (e.g., $math.abs(x))",[R.NAMESPACE_HEAD_IN_OPERATION]:"Cannot use namespace head in operations - namespace heads must be used with property access (e.g., $math.PI) or method calls (e.g., $math.abs(x))",[R.EXPRESSION_CANNOT_RETURN_ARRAY]:"Expressions cannot return arrays - arrays must be provided via the value property",[R.EXPRESSION_CANNOT_RETURN_OBJECT]:"Expressions cannot return objects - objects must be provided via the value property",[R.EXPRESSION_CANNOT_RETURN_STRING]:"Expressions cannot return strings - strings must be provided via the value property",[R.UNSUPPORTED_RESULT_TYPE]:"Unsupported expression result type: {type}",[R.STRING_IN_OPERATION]:"Cannot use string in {operator} operation - strings are not supported in mathematical expressions",[R.OBJECT_IN_OPERATION]:"Cannot use object in {operator} operation - only numeric values are allowed",[R.ARRAY_IN_OPERATION]:"Cannot use array in {operator} operation - only numeric values are allowed",[R.STRING_WITH_UNARY]:"Cannot use string with unary {operator} - strings are not supported in mathematical expressions",[R.OBJECT_WITH_UNARY]:"Cannot use object with unary {operator} - only numeric values are allowed",[R.ARRAY_WITH_UNARY]:"Cannot use array with unary {operator} - only numeric values are allowed",[R.PROPERTY_ACCESS_DENIED]:'Access to property "{property}" is not allowed for security reasons',[R.FUNCTION_ALIASING_DENIED]:"Cannot alias functions - functions must be called with parentheses",[R.CIRCULAR_DEPENDENCY]:"Circular dependency detected: {cycle}",[R.DECIMAL_PLACES_INVALID]:"decimalPlaces must be a non-negative integer",[R.EXPRESSION_MUST_BE_STRING]:"Expression must be a string",[R.EXPRESSION_EMPTY]:"Expression cannot be empty",[R.UNSUPPORTED_LANGUAGE]:"Unsupported language: {lang}"};function At(e,n="en",t){let r;switch(n){case"en":r=ms;break;default:throw new ge(R.UNSUPPORTED_LANGUAGE,n)}let i=r[e];if(t){const s={};for(const o of Object.keys(t)){const l=t[o];o==="context"&&typeof l=="object"&&l!==null?Object.assign(s,l):Array.isArray(l)?s[o]=l.join(" -> "):l!=null&&(s[o]=l)}for(const[o,l]of Object.entries(s))i=i.replace(new RegExp(`\\{${o}\\}`,"g"),String(l))}return i}const hs=e=>{try{return An(e.trim())}catch(n){if(n.location){const{line:t,column:r}=n.location.start;throw new $e(R.PARSE_ERROR_AT_LOCATION,{line:t,column:r,expression:e})}throw new $e(R.PARSE_ERROR,{expression:e})}},gs=e=>ds(e),xs=e=>{const n=new Map,t=new Set,r=new Map;for(const c of e)if(t.add(c.name),c.expr&&c.expr.trim())try{const u=hs(c.expr);r.set(c.name,u)}catch(u){throw u instanceof $e?new $e(R.PARSE_ERROR_FOR_VARIABLE,{variableName:c.name,expression:c.expr,line:u.line,column:u.column,originalMessage:u.message}):new $e(R.PARSE_ERROR_FOR_VARIABLE,{variableName:c.name,expression:c.expr,originalMessage:u instanceof Error?u.message:String(u)})}for(const c of e){if(!c.expr||!c.expr.trim()){n.set(c.name,[]);continue}const u=r.get(c.name);if(!u)throw new W(R.NO_AST_FOUND,c.name);const N=gs(u).filter(E=>t.has(E));n.set(c.name,N)}const i=new Set,s=new Set,o=[],l=(c,u=[])=>{if(i.has(c))return;if(s.has(c)){const N=[...u,c];throw new Tt(R.CIRCULAR_DEPENDENCY,N)}s.add(c);const m=n.get(c)||[];for(const N of m)t.has(N)&&l(N,[...u,c]);s.delete(c),i.add(c),o.push(c)};for(const c of t)l(c);return{order:o,asts:r}},H=e=>e instanceof B?e:new B(e),ze=Symbol("NAMESPACE_HEAD"),tt=e=>e!=null&&typeof e=="object"&&e[ze]===!0,Es=()=>{const e=Object.create(null);return e.$math=Object.create(null),e.$math[ze]=!0,e.$math.PI=new B(-1).acos(),e.$math.E=new B(1).exp(),e.$math.SQRT2=new B(2).sqrt(),e.$math.SQRT1_2=new B(.5).sqrt(),e.$math.LN2=new B(2).ln(),e.$math.LN10=new B(10).ln(),e.$math.LOG2E=e.$math.E.log(2),e.$math.LOG10E=e.$math.E.log(10),e.$math.abs=n=>H(n).abs(),e.$math.sqrt=n=>H(n).sqrt(),e.$math.cbrt=n=>H(n).cbrt(),e.$math.floor=n=>H(n).floor(),e.$math.ceil=n=>H(n).ceil(),e.$math.round=n=>H(n).round(),e.$math.trunc=n=>H(n).trunc(),e.$math.sin=n=>new B(Math.sin(H(n).toNumber())),e.$math.cos=n=>new B(Math.cos(H(n).toNumber())),e.$math.tan=n=>new B(Math.tan(H(n).toNumber())),e.$math.asin=n=>new B(Math.asin(H(n).toNumber())),e.$math.acos=n=>new B(Math.acos(H(n).toNumber())),e.$math.atan=n=>new B(Math.atan(H(n).toNumber())),e.$math.atan2=(n,t)=>new B(Math.atan2(H(n).toNumber(),H(t).toNumber())),e.$math.exp=n=>H(n).exp(),e.$math.ln=n=>H(n).ln(),e.$math.log=n=>H(n).log(),e.$math.log10=n=>H(n).log(10),e.$math.log2=n=>H(n).log(2),e.$math.pow=(n,t)=>H(n).pow(H(t)),e.$math.min=(...n)=>B.min(...n.map(H)),e.$math.max=(...n)=>B.max(...n.map(H)),e.$unit=Object.create(null),e.$unit[ze]=!0,e.$unit.mmToInch=n=>H(n).div(25.4),e.$unit.inchToMm=n=>H(n).mul(25.4),e.$unit.cmToInch=n=>H(n).div(2.54),e.$unit.inchToCm=n=>H(n).mul(2.54),e.$unit.mToFt=n=>H(n).mul(3.28084),e.$unit.ftToM=n=>H(n).div(3.28084),e.$angle=Object.create(null),e.$angle[ze]=!0,e.$angle.toRad=n=>H(n).mul(e.$math.PI).div(180),e.$angle.toDeg=n=>H(n).mul(180).div(e.$math.PI),e},Ns=new Set(["prototype","__proto__","constructor"]),As=e=>!(Ns.has(e)||e.startsWith("__")),oe=async(e,n)=>{switch(e.type){case"Literal":return typeof e.value=="number"?new B(e.raw||e.value):e.value;case"Identifier":if(!(e.name in n))throw new W(R.UNDEFINED_VARIABLE,e.name);return n[e.name];case"MemberExpression":const t=await oe(e.object,n);if(t==null)throw new W(R.CANNOT_ACCESS_PROPERTY);let r;if(e.computed){const E=await oe(e.property,n);r=String(E)}else r=e.property.name;if(!As(r))throw new it(R.PROPERTY_ACCESS_DENIED,r);if(tt(t)&&!(r in t)){let E="$unknown";throw e.object.type==="Identifier"&&e.object.name&&(E=e.object.name),new W(R.UNDEFINED_NAMESPACE_PROPERTY,void 0,{property:r,namespace:E})}return t[r];case"BinaryExpression":const i=await oe(e.left,n),s=await oe(e.right,n);return _s(e.operator,i,s);case"UnaryExpression":const o=await oe(e.argument,n);return ws(e.operator,o);case"CallExpression":const l=await oe(e.callee,n),c=[];for(const E of e.arguments)c.push(await oe(E,n));if(typeof l!="function")throw new W(R.CALLEE_NOT_FUNCTION);let u=null;return e.callee.type==="MemberExpression"&&(u=await oe(e.callee.object,n)),l.apply(u,c);case"ConditionalExpression":return await oe(e.test,n)?await oe(e.consequent,n):await oe(e.alternate,n);case"LogicalExpression":const N=await oe(e.left,n);if(e.operator==="&&")return N&&await oe(e.right,n);if(e.operator==="||")return N||await oe(e.right,n);if(e.operator==="??")return N??await oe(e.right,n);throw new W(R.UNSUPPORTED_LOGICAL_OPERATOR);default:throw new W(R.UNSUPPORTED_NODE_TYPE)}},_s=(e,n,t)=>{if(tt(n)||tt(t))throw new W(R.NAMESPACE_HEAD_IN_OPERATION);const r=["+","-","*","/","%","**"],i=["<",">","<=",">="];if(r.includes(e)||i.includes(e)){if(typeof n=="string")throw new W(R.STRING_IN_OPERATION,void 0,{operator:e});if(typeof n=="object"&&n!==null&&!(n instanceof B)&&!Array.isArray(n))throw new W(R.OBJECT_IN_OPERATION,void 0,{operator:e});if(Array.isArray(n))throw new W(R.ARRAY_IN_OPERATION,void 0,{operator:e});if(typeof t=="string")throw new W(R.STRING_IN_OPERATION,void 0,{operator:e});if(typeof t=="object"&&t!==null&&!(t instanceof B)&&!Array.isArray(t))throw new W(R.OBJECT_IN_OPERATION,void 0,{operator:e});if(Array.isArray(t))throw new W(R.ARRAY_IN_OPERATION,void 0,{operator:e})}if(e==="=="||e==="="||e==="!="){if(n instanceof B&&t instanceof B){const l=n.eq(t);return e==="!="?!l:l}if(typeof n=="boolean"||n===null||typeof t=="boolean"||t===null){const l=n===t;return e==="!="?!l:l}const o=n==t;return e==="!="?!o:o}const s=o=>o instanceof B?o:new B(o);switch(e){case"+":return s(n).plus(s(t));case"-":return s(n).minus(s(t));case"*":return s(n).times(s(t));case"/":return s(n).div(s(t));case"%":return s(n).mod(s(t));case"**":return s(n).pow(s(t));case"<":return s(n).lt(s(t));case">":return s(n).gt(s(t));case"<=":return s(n).lte(s(t));case">=":return s(n).gte(s(t));default:throw new W(R.UNSUPPORTED_BINARY_OPERATOR)}},ws=(e,n)=>{switch(e){case"-":case"+":if(typeof n=="string")throw new W(R.STRING_WITH_UNARY,void 0,{operator:e});if(typeof n=="object"&&n!==null&&!(n instanceof B)&&!Array.isArray(n))throw new W(R.OBJECT_WITH_UNARY,void 0,{operator:e});if(Array.isArray(n))throw new W(R.ARRAY_WITH_UNARY,void 0,{operator:e});return e==="-"?n instanceof B?n.neg():-n:n instanceof B?n:+n;case"!":return!n;default:throw new W(R.UNSUPPORTED_UNARY_OPERATOR)}},Rs=async(e,n)=>{try{const t=Es(),r=Object.create(null);for(const[s,o]of Object.entries(n))r[s]=o;for(const[s,o]of Object.entries(t))r[s]=o;const i=await oe(e,r);if(tt(i))throw new W(R.NAMESPACE_HEAD_AS_VALUE);if(typeof i=="function")throw new it(R.FUNCTION_ALIASING_DENIED);if(typeof i=="object"&&i!==null&&!(i instanceof B))throw Array.isArray(i)?new W(R.EXPRESSION_CANNOT_RETURN_ARRAY):new W(R.EXPRESSION_CANNOT_RETURN_OBJECT);if(typeof i=="string"){if(!isNaN(Number(i)))return new B(i);throw new W(R.EXPRESSION_CANNOT_RETURN_STRING)}if(i instanceof B)return i;if(typeof i=="number")return new B(i);if(typeof i=="boolean"||i===null)return i;if(i===void 0)return null;throw new W(R.UNSUPPORTED_RESULT_TYPE,void 0,{resultType:typeof i})}catch(t){if(t instanceof je)throw t;const r=t instanceof Error?t.message:String(t);throw new W(R.FAILED_TO_EVALUATE,void 0,{originalMessage:r},t instanceof Error?t:void 0)}},vs=/^(?![_$]{2})[a-zA-Z_][a-zA-Z0-9_$]*$/,bs=Object.freeze(["true","false","null","Infinity"]),_n=e=>typeof e!="string"?{valid:!1,error:R.VARIABLE_NAME_MUST_BE_STRING,variableName:String(e)}:e.trim()===""?{valid:!1,error:R.VARIABLE_NAME_EMPTY,variableName:e}:e!==e.trim()?{valid:!1,error:R.VARIABLE_NAME_WHITESPACE,variableName:e}:e.startsWith("$")?{valid:!1,error:R.VARIABLE_NAME_DOLLAR_PREFIX,variableName:e}:e.startsWith("__")?{valid:!1,error:R.VARIABLE_NAME_DOUBLE_UNDERSCORE,variableName:e}:bs.includes(e)?{valid:!1,error:R.VARIABLE_NAME_RESERVED,variableName:e}:/^\d/.test(e)?{valid:!1,error:R.VARIABLE_NAME_STARTS_WITH_NUMBER,variableName:e}:e.includes(".")?{valid:!1,error:R.VARIABLE_NAME_CONTAINS_DOT,variableName:e}:vs.test(e)?{valid:!0}:{valid:!1,error:R.VARIABLE_NAME_INVALID_CHARS,variableName:e},Ts=e=>{if(typeof e!="string")return{valid:!1,error:R.EXPRESSION_MUST_BE_STRING};const n=e.trim();if(n==="")return{valid:!1,error:R.EXPRESSION_EMPTY};try{return An(n),{valid:!0}}catch(t){if(t.location){const{line:r,column:i}=t.location.start;return{valid:!1,error:R.PARSE_ERROR_AT_LOCATION,line:r,column:i}}return{valid:!1,error:R.PARSE_ERROR}}};function Os(e,n){const{decimalPlaces:t}=n;if(typeof t!="number"||t<0||!Number.isInteger(t))throw new Error(R.DECIMAL_PLACES_INVALID);const r={};for(const[i,s]of Object.entries(e.values))s instanceof B&&s.isFinite()?r[i]=s.toDecimalPlaces(t):r[i]=s;return{values:r,order:e.order}}const Ss=async e=>{if(!Array.isArray(e))throw new ge(R.INPUT_MUST_BE_ARRAY);for(const l of e){if(!l||typeof l!="object")throw new ge(R.INPUT_MUST_BE_OBJECT);if(typeof l.name!="string"||!l.name)throw new ge(R.INPUT_NAME_REQUIRED);const c=_n(l.name);if(!c.valid)throw new ge(c.error,l.name);if(l.expr===void 0&&l.value===void 0)throw new ge(R.INPUT_EXPR_OR_VALUE_REQUIRED,l.name);if(l.expr!==void 0&&typeof l.expr!="string")throw new ge(R.INPUT_EXPR_MUST_BE_STRING,l.name)}const n=new Set;for(const l of e){if(n.has(l.name))throw new ge(R.DUPLICATE_NAME,l.name);n.add(l.name)}const{order:t,asts:r}=xs(e),i=new Map;for(const l of e)l.value!==void 0&&i.set(l.name,l.value);const s=Object.create(null),o=Object.create(null);for(const l of t){let c;if(i.has(l))c=i.get(l);else{const u=r.get(l);u?c=await Rs(u,o):c=null}c instanceof B||typeof c=="boolean"||c===null?(s[l]=c,o[l]=c):(o[l]=c,typeof c=="number"&&(s[l]=new B(c)))}return{values:s,order:t}};function js(){const[e,n]=ce.useState([{name:"a",expr:"10",mode:"expr"},{name:"b",expr:"a * 2",mode:"expr"},{name:"c",expr:"a + b",mode:"expr"}]),[t,r]=ce.useState(null),[i,s]=ce.useState(null),[o,l]=ce.useState(null),[c,u]=ce.useState(new Map),[m,N]=ce.useState(new Map),[E,v]=ce.useState(4),[U,P]=ce.useState("all"),J=ce.useRef(new Map),F=ce.useRef(new Map),re=g=>g.valueRaw!==void 0?g.valueRaw:g.value?JSON.stringify(g.value,null,2):"",k=(g,O,I,j,M)=>{const Y="w-full px-3 py-2 text-sm border rounded font-mono focus:outline-none focus:ring-2";return g?`${Y} border-orange-400 bg-orange-50 focus:ring-orange-500`:o===O?`${Y} border-red-300 bg-white focus:ring-blue-500`:I==="value"&&(j||M)?`${Y} border-purple-400 bg-white focus:ring-purple-500`:I==="expr"||!I&&!j?`${Y} border-teal-400 bg-white focus:ring-teal-500`:`${Y} border-gray-300 bg-white focus:ring-blue-500`},X=(g,O,I)=>{const j=[...e];if(O==="value"){j[g].valueRaw=I;try{j[g].value=I?JSON.parse(I):void 0}catch{j[g].value=void 0}}else j[g][O]=I;if(n(j),O==="name"){const M=F.current.get(g);M&&clearTimeout(M);const Y=setTimeout(()=>{const G=_n(I);N(K=>{const q=new Map(K);if(G.valid)q.delete(g);else{const Z=G.error||"Invalid variable name",Q=Object.values(R).includes(Z)?At(Z,"en",G):Z;q.set(g,Q)}return q})},300);F.current.set(g,Y)}if(O==="expr"&&j[g].mode==="expr"){const M=J.current.get(g);if(M&&clearTimeout(M),!I.trim()){const G=new Map(c);G.delete(g),u(G);return}const Y=setTimeout(()=>{const G=Ts(I);u(K=>{const q=new Map(K);if(G.valid)q.delete(g);else{const Z=G.error||"Syntax error",Q=Object.values(R).includes(Z)?At(Z,"en"):Z;q.set(g,Q)}return q})},300);J.current.set(g,Y)}if(O==="value"&&j[g].mode==="value"){const M=J.current.get(g);if(M&&clearTimeout(M),!I.trim()){const G=new Map(c);G.delete(g),u(G);return}const Y=setTimeout(()=>{try{JSON.parse(I),u(G=>{const K=new Map(G);return K.delete(g),K})}catch(G){u(K=>{const q=new Map(K);return q.set(g,G instanceof Error?G.message:"Invalid JSON"),q})}},300);J.current.set(g,Y)}},fe=(g="expr")=>{n([...e,{name:`var${E}`,expr:g==="expr"?"":void 0,value:void 0,mode:g}]),v(E+1)},se=g=>{const O=J.current.get(g);O&&(clearTimeout(O),J.current.delete(g));const I=F.current.get(g);I&&(clearTimeout(I),F.current.delete(g)),n(e.filter((Z,Q)=>Q!==g));const j=new Map(c),M=new Map(m);j.delete(g),M.delete(g);const Y=new Map,G=new Map,K=new Map,q=new Map;j.forEach((Z,Q)=>{Q>g?Y.set(Q-1,Z):Y.set(Q,Z)}),M.forEach((Z,Q)=>{Q>g?G.set(Q-1,Z):G.set(Q,Z)}),J.current.forEach((Z,Q)=>{Q>g?K.set(Q-1,Z):Q!==g&&K.set(Q,Z)}),F.current.forEach((Z,Q)=>{Q>g?q.set(Q-1,Z):Q!==g&&q.set(Q,Z)}),u(Y),N(G),J.current=K,F.current=q},Ne=()=>{n(g=>g.filter(O=>O.mode!=="value")),u(new Map),N(new Map),J.current.clear(),F.current.clear()},Ae=()=>{n(g=>g.filter(O=>O.mode==="value")),u(new Map),N(new Map),J.current.clear(),F.current.clear()},me=()=>{const g=document.createElement("input");g.type="file",g.accept=".json",g.onchange=O=>{const I=O.target.files?.[0];if(I){const j=new FileReader;j.onload=M=>{try{const Y=JSON.parse(M.target?.result),G=[];Object.entries(Y).forEach(([K,q])=>{G.push({name:K,value:q,mode:"value"})}),n(K=>[...K.filter(q=>q.mode!=="value"),...G])}catch(Y){s("Failed to parse JSON file: "+(Y instanceof Error?Y.message:"Unknown error"))}},j.readAsText(I)}},g.click()},be=async()=>{try{const g=await navigator.clipboard.readText(),O=JSON.parse(g);Object.entries(O).forEach(([I,j])=>{n(M=>[...M,{name:I,value:j,mode:"value"}])})}catch(g){s("Failed to parse JSON from clipboard: "+(g instanceof Error?g.message:"Unknown error"))}},ae=()=>{const g=document.createElement("input");g.type="file",g.accept=".json,.txt",g.onchange=O=>{const I=O.target.files?.[0];if(I){const j=new FileReader;j.onload=M=>{try{const Y=M.target?.result,G=JSON.parse(Y),K=[];Array.isArray(G)?G.forEach(q=>{q.name&&(q.expr!==void 0||q.value!==void 0)&&K.push({name:q.name,expr:q.expr,value:q.value,mode:q.mode||(q.value!==void 0?"value":"expr")})}):Object.entries(G).forEach(([q,Z])=>{K.push({name:q,expr:String(Z),mode:"expr"})}),n(q=>[...q.filter(Z=>Z.mode==="value"),...K])}catch(Y){s("Failed to parse expressions file: "+(Y instanceof Error?Y.message:"Unknown error"))}},j.readAsText(I)}},g.click()},_e=async()=>{try{const g=await navigator.clipboard.readText(),O=JSON.parse(g);Array.isArray(O)?O.forEach(I=>{I.name&&(I.expr!==void 0||I.value!==void 0)&&n(j=>[...j,{name:I.name,expr:I.expr,value:I.value,mode:I.mode||(I.value!==void 0?"value":"expr")}])}):Object.entries(O).forEach(([I,j])=>{n(M=>[...M,{name:I,expr:String(j),mode:"expr"}])})}catch(g){s("Failed to parse expressions from clipboard: "+(g instanceof Error?g.message:"Unknown error"))}},he=()=>{const O=e.filter(Y=>Y.mode==="expr").map(Y=>({name:Y.name,expr:Y.expr||""})),I=new Blob([JSON.stringify(O,null,2)],{type:"application/json"}),j=URL.createObjectURL(I),M=document.createElement("a");M.href=j,M.download="expressions.json",M.click(),URL.revokeObjectURL(j)},Te=g=>{const O=nn[g];O&&(n(O.expressions),r(null),s(null),l(null),u(new Map),N(new Map))},te=async()=>{if(s(null),l(null),c.size>0){const g=Array.from(c.keys())[0],O=c.get(g);s(`Cannot evaluate: ${O}`),l(g);return}if(m.size>0){const g=Array.from(m.keys())[0],O=m.get(g);s(`Cannot evaluate: ${O}`),l(g);return}try{const g=e.filter(j=>j.name.trim()?j.mode==="value"?j.value!==void 0&&j.value!=="":j.expr!==void 0:!1).map(j=>j.mode==="value"?{name:j.name,value:j.value}:{name:j.name,expr:j.expr||""});if(g.length===0){s("Please add at least one expression");return}const O=await Ss(g),I=U==="all"?O:Os(O,{decimalPlaces:parseInt(U)});r(I)}catch(g){const O=Object.values(R).includes(g.message)?At(g.message,"en",g):g.message;if(s(O),r(null),g.variableName){const I=e.findIndex(j=>j.name===g.variableName);I!==-1&&l(I)}}},V=e.filter(g=>g.mode==="value").map(g=>({...g,originalIndex:e.indexOf(g)})),Ue=e.filter(g=>g.mode!=="value").map(g=>({...g,originalIndex:e.indexOf(g)}));return h.jsxs("div",{className:"content",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h2",{style:{marginTop:"2rem"},children:"Playground"}),h.jsx("p",{className:"text-gray-600 text-sm sm:text-base mb-4",children:"Define variables with math expressions. They can reference each other and will be evaluated in the correct order automatically."}),h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Examples"}),h.jsxs("select",{onChange:g=>g.target.value&&Te(g.target.value),defaultValue:"",className:"px-3 py-2 text-sm border border-gray-300 rounded bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[h.jsx("option",{value:"",disabled:!0,children:"Choose an example"}),Object.entries(nn).map(([g,{name:O}])=>h.jsx("option",{value:g,children:O},g))]})]}),h.jsxs("div",{className:"bg-purple-50 border-2 border-purple-200 rounded-lg p-3 sm:p-4 mb-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h3",{className:"text-lg font-semibold text-purple-900",children:"Values (JSON)"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:be,className:"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded transition-colors flex items-center gap-1",title:"Paste JSON from clipboard",children:[h.jsx(Qt,{size:14}),h.jsx("span",{children:"Paste"})]}),h.jsxs("button",{onClick:me,className:"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded transition-colors flex items-center gap-1",title:"Upload JSON file",children:[h.jsx(en,{size:14}),h.jsx("span",{children:"Upload"})]}),V.length>0&&h.jsxs("button",{onClick:Ne,className:"px-3 py-1.5 bg-gray-500 hover:bg-gray-600 text-white text-xs rounded transition-colors flex items-center gap-1",title:"Clear all values",children:[h.jsx(tn,{size:14}),h.jsx("span",{children:"Clear All"})]})]})]}),h.jsx("p",{className:"text-purple-800 text-xs sm:text-sm mb-3 italic",children:"Values are JSON objects/arrays that can be referenced in expressions but do not appear in the evaluation results."}),V.length>0?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[150px_1fr_auto] gap-2 mb-2 text-sm font-medium text-purple-900",children:[h.jsx("div",{children:"Name"}),h.jsx("div",{children:"JSON Value"}),h.jsx("div",{className:"w-[90px]"})]}),h.jsx("div",{className:"space-y-4 sm:space-y-2",children:V.map(({originalIndex:g,...O})=>{const I=c.has(g),j=m.has(g);return h.jsxs("div",{className:`${o===g?"bg-red-50 -mx-2 px-2 py-1 rounded":""}`,children:[h.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[150px_1fr_auto] gap-2 items-start",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",placeholder:"e.g. point",value:O.name,onChange:M=>X(g,"name",M.target.value),className:k(j,g,O.mode,!1,!0)}),j&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:m.get(g)})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("textarea",{rows:3,value:re(O),onChange:M=>X(g,"value",M.target.value),className:k(I,g,O.mode,!0),placeholder:'{"x": 10, "y": 20}'}),I&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:c.get(g)})]}),h.jsxs("button",{onClick:()=>se(g),className:"w-24 px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white text-sm rounded transition-colors flex items-center gap-1.5 justify-center",children:[h.jsx(Xe,{size:16}),h.jsx("span",{children:"Remove"})]})]}),h.jsxs("div",{className:"sm:hidden flex gap-2",children:[h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"flex gap-2 items-center",children:[h.jsx("label",{className:"text-xs font-medium text-purple-900 w-12",children:"Name"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",placeholder:"e.g. point",value:O.name,onChange:M=>X(g,"name",M.target.value),className:k(j,g,O.mode,!1,!0)}),j&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:m.get(g)})]})]}),h.jsxs("div",{className:"flex gap-2 items-start",children:[h.jsx("label",{className:"text-xs font-medium text-purple-900 w-12 mt-2",children:"Value"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("textarea",{rows:3,value:re(O),onChange:M=>X(g,"value",M.target.value),className:k(I,g,O.mode,!0),placeholder:'{"x": 10, "y": 20}'}),I&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:c.get(g)})]})]})]}),h.jsx("button",{onClick:()=>se(g),className:"p-2 bg-gray-500 hover:bg-gray-600 text-white rounded transition-colors self-center",children:h.jsx(Xe,{size:16})})]})]},g)})})]}):h.jsx("p",{className:"text-purple-700 text-sm italic text-center py-4",children:"No values defined. Add values to use in your expressions."}),h.jsx("div",{className:"flex justify-end gap-2 mt-3",children:h.jsxs("button",{onClick:()=>fe("value"),className:"px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white text-sm rounded transition-colors flex items-center gap-1.5",children:[h.jsx(Kt,{size:16}),h.jsx("span",{children:"Add Value"})]})})]}),h.jsxs("div",{className:"bg-teal-50 border-2 border-teal-200 rounded-lg p-3 sm:p-4 mb-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h3",{className:"text-lg font-semibold text-teal-900",children:"Expressions"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:_e,className:"px-3 py-1.5 bg-teal-600 hover:bg-teal-700 text-white text-xs rounded transition-colors flex items-center gap-1",title:"Paste expressions from clipboard",children:[h.jsx(Qt,{size:14}),h.jsx("span",{children:"Paste"})]}),h.jsxs("button",{onClick:ae,className:"px-3 py-1.5 bg-teal-600 hover:bg-teal-700 text-white text-xs rounded transition-colors flex items-center gap-1",title:"Upload expressions file",children:[h.jsx(en,{size:14}),h.jsx("span",{children:"Upload"})]}),h.jsxs("button",{onClick:he,className:"px-3 py-1.5 bg-teal-600 hover:bg-teal-700 text-white text-xs rounded transition-colors flex items-center gap-1",title:"Download expressions",disabled:Ue.length===0,children:[h.jsx(pr,{size:14}),h.jsx("span",{children:"Download"})]}),Ue.length>0&&h.jsxs("button",{onClick:Ae,className:"px-3 py-1.5 bg-gray-500 hover:bg-gray-600 text-white text-xs rounded transition-colors flex items-center gap-1",title:"Clear all expressions",children:[h.jsx(tn,{size:14}),h.jsx("span",{children:"Clear All"})]})]})]}),h.jsx("p",{className:"text-teal-800 text-xs sm:text-sm mb-3 italic",children:"Expressions are mathematical formulas that will be evaluated and appear in the results."}),Ue.length>0?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[150px_1fr_auto] gap-2 mb-2 text-sm font-medium text-teal-900",children:[h.jsx("div",{children:"Name"}),h.jsx("div",{children:"Expression"}),h.jsx("div",{className:"w-[90px]"})]}),h.jsx("div",{className:"space-y-4 sm:space-y-2",children:Ue.map(({originalIndex:g,...O})=>{const I=c.has(g),j=m.has(g);return h.jsxs("div",{className:`${o===g?"bg-red-50 -mx-2 px-2 py-1 rounded":""}`,children:[h.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[150px_1fr_auto] gap-2 items-start",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",placeholder:"e.g. radius",value:O.name,onChange:M=>X(g,"name",M.target.value),className:k(j,g,O.mode,!1,!0)}),j&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:m.get(g)})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",placeholder:"e.g. a + b",value:O.expr||"",onChange:M=>X(g,"expr",M.target.value),className:k(I,g,O.mode,!1,!1)}),I&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:c.get(g)})]}),h.jsxs("button",{onClick:()=>se(g),className:"w-24 px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white text-sm rounded transition-colors flex items-center gap-1.5 justify-center",children:[h.jsx(Xe,{size:16}),h.jsx("span",{children:"Remove"})]})]}),h.jsxs("div",{className:"sm:hidden flex gap-2",children:[h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"flex gap-2 items-center",children:[h.jsx("label",{className:"text-xs font-medium text-teal-900 w-12",children:"Name"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",placeholder:"e.g. radius",value:O.name,onChange:M=>X(g,"name",M.target.value),className:k(j,g,O.mode,!1,!0)}),j&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:m.get(g)})]})]}),h.jsxs("div",{className:"flex gap-2 items-start",children:[h.jsx("label",{className:"text-xs font-medium text-teal-900 w-12 mt-2",children:"Expr"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",placeholder:"e.g. a + b",value:O.expr||"",onChange:M=>X(g,"expr",M.target.value),className:k(I,g,O.mode,!1,!1)}),I&&h.jsx("div",{className:"text-orange-600 text-xs mt-1 font-mono",children:c.get(g)})]})]})]}),h.jsx("button",{onClick:()=>se(g),className:"p-2 bg-gray-500 hover:bg-gray-600 text-white rounded transition-colors self-center",children:h.jsx(Xe,{size:16})})]})]},g)})})]}):h.jsx("p",{className:"text-teal-700 text-sm italic text-center py-4",children:"No expressions defined. Add expressions to calculate results."}),h.jsx("div",{className:"flex justify-end gap-2 mt-3",children:h.jsxs("button",{onClick:()=>fe("expr"),className:"px-4 py-2 bg-teal-500 hover:bg-teal-600 text-white text-sm rounded transition-colors flex items-center gap-1.5",children:[h.jsx(Kt,{size:16}),h.jsx("span",{children:"Add Expression"})]})})]})]}),i&&h.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded",children:h.jsx("p",{className:"text-red-700 font-mono text-sm",children:i})}),h.jsx("div",{className:"mb-6",children:h.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[h.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-3",children:"Results"}),h.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[h.jsx("label",{htmlFor:"decimal-places",className:"text-sm text-gray-600 whitespace-nowrap",children:"Decimal places:"}),h.jsxs("select",{id:"decimal-places",value:U,onChange:g=>P(g.target.value),className:"px-2 py-1.5 text-sm border border-gray-300 rounded bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[h.jsx("option",{value:"all",children:"All"}),h.jsx("option",{value:"0",children:"0"}),h.jsx("option",{value:"2",children:"2"}),h.jsx("option",{value:"4",children:"4"}),h.jsx("option",{value:"6",children:"6"}),h.jsx("option",{value:"7",children:"7"}),h.jsx("option",{value:"10",children:"10"})]})]}),h.jsxs("div",{className:"flex gap-2 mb-4",children:[h.jsxs("button",{onClick:te,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded font-semibold transition-colors flex items-center gap-1.5",children:[h.jsx(hr,{size:18}),h.jsx("span",{children:"Evaluate"})]}),t&&h.jsx("button",{onClick:()=>r(null),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm rounded font-semibold transition-colors",children:"Reset"})]}),t?h.jsxs(h.Fragment,{children:[h.jsxs("table",{className:"w-full text-sm",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-green-200",children:[h.jsx("th",{className:"text-left py-2 font-medium text-gray-600",children:"Name"}),h.jsx("th",{className:"text-left py-2 font-medium text-gray-600",children:"Value"})]})}),h.jsx("tbody",{children:Object.entries(t.values).map(([g,O])=>{const I=O===null?"null":typeof O=="boolean"?String(O):O.toString();return h.jsxs("tr",{children:[h.jsx("td",{className:"py-2 px-2 font-mono text-gray-700",children:g}),h.jsx("td",{className:"py-2 px-2 font-mono text-green-700 font-semibold break-all",children:I})]},g)})})]}),h.jsxs("div",{className:"mt-4 text-gray-600 text-xs sm:text-sm italic",children:["Evaluation order: ",t.order.join("  ")]})]}):h.jsx("p",{className:"text-gray-500 text-sm italic",children:"Click Evaluate to see results"})]})}),h.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-600 rounded-lg p-4 sm:p-6",children:[h.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-blue-900 mb-3",children:"Quick Tips"}),h.jsxs("ul",{className:"space-y-1.5 text-gray-700 text-sm sm:text-base",children:[h.jsxs("li",{children:[" Variables can reference other variables (e.g., ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"b = a * 2"}),")"]}),h.jsxs("li",{children:[" Use decimal precision math (e.g., ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"0.1 + 0.2"})," = 0.3 exactly!)"]}),h.jsxs("li",{children:[" Access nested properties with dots (e.g., ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"point.x"}),")"]}),h.jsxs("li",{children:[" Use ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"$math"})," functions: ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"$math.sqrt(16)"}),", ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"$math.PI"}),", etc."]}),h.jsxs("li",{children:[" Convert units: ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"$unit.mmToInch(25.4)"})]}),h.jsxs("li",{children:[" Convert angles: ",h.jsx("code",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-xs sm:text-sm",children:"$angle.toRad(180)"})]})]})]})]})}export{js as default};
